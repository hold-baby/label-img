/**!
 * label-img - v0.0.61
 * image annotation tool with javascript
 *
 * 2021-03-08 16:10:50
 * MIT (c) hold-baby
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).LabelImg=t()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};var t=function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};var n=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function r(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function i(e){return this instanceof i?(this.v=e,this):new i(e)}var a=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};var u=Object.freeze({__proto__:null,__extends:function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},get __assign(){return t},__rest:function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(n[r[o]]=e[r[o]])}return n},__decorate:function(e,t,n,r){var o,i=arguments.length,a=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(a=(i<3?o(a):i>3?o(t,n,a):o(t,n))||a);return i>3&&a&&Object.defineProperty(t,n,a),a},__param:function(e,t){return function(n,r){t(n,r,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function u(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},__generator:function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},__createBinding:n,__exportStar:function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},__values:r,__read:o,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),o=0;for(t=0;t<n;t++)for(var i=arguments[t],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},__await:i,__asyncGenerator:function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(e,t||[]),a=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(e){o[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=o[e](t)).value instanceof i?Promise.resolve(n.value.v).then(c,f):l(a[0][2],n)}catch(e){l(a[0][3],e)}var n}function c(e){s("next",e)}function f(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}},__asyncDelegator:function(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,o){t[r]=e[r]?function(t){return(n=!n)?{value:i(e[r](t)),done:"return"===r}:o?o(t):t}:o}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=r(e),t={},o("next"),o("throw"),o("return"),t[Symbol.asyncIterator]=function(){return this},t);function o(n){t[n]=e[n]&&function(t){return new Promise((function(r,o){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,o,(t=e[n](t)).done,t.value)}))}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}}),s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}function f(e){var t={exports:{}};return e(t,t.exports),t.exports}var l=Math.floor;var p=function(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=l(t/2))&&(e+=e)}while(t);return n},d="object"==typeof s&&s&&s.Object===Object&&s,v="object"==typeof self&&self&&self.Object===Object&&self,h=d||v||Function("return this")(),g=h.Symbol;var y=function(e,t){for(var n=-1,r=null==e?0:e.length,o=Array(r);++n<r;)o[n]=t(e[n],n,e);return o},_=Array.isArray,m=Object.prototype,b=m.hasOwnProperty,w=m.toString,S=g?g.toStringTag:void 0;var O=function(e){var t=b.call(e,S),n=e[S];try{e[S]=void 0;var r=!0}catch(e){}var o=w.call(e);return r&&(t?e[S]=n:delete e[S]),o},j=Object.prototype.toString;var P=function(e){return j.call(e)},I=g?g.toStringTag:void 0;var x=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":I&&I in Object(e)?O(e):P(e)};var T=function(e){return null!=e&&"object"==typeof e};var C=function(e){return"symbol"==typeof e||T(e)&&"[object Symbol]"==x(e)},E=g?g.prototype:void 0,R=E?E.toString:void 0;var D=function e(t){if("string"==typeof t)return t;if(_(t))return y(t,e)+"";if(C(t))return R?R.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n};var M=function(e,t,n){var r=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(n=n>o?o:n)<0&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var i=Array(o);++r<o;)i[r]=e[r+t];return i};var A=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:M(e,t,n)},L=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var k=function(e){return L.test(e)};var z=function(e){return function(t){return null==t?void 0:t[e]}}("length"),F="[\\ud800-\\udfff]",B="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",W="\\ud83c[\\udffb-\\udfff]",G="[^\\ud800-\\udfff]",U="(?:\\ud83c[\\udde6-\\uddff]){2}",N="[\\ud800-\\udbff][\\udc00-\\udfff]",K="(?:"+B+"|"+W+")"+"?",$="[\\ufe0e\\ufe0f]?",H=$+K+("(?:\\u200d(?:"+[G,U,N].join("|")+")"+$+K+")*"),q="(?:"+[G+B+"?",B,U,N,F].join("|")+")",Y=RegExp(W+"(?="+W+")|"+q+H,"g");var V=function(e){for(var t=Y.lastIndex=0;Y.test(e);)++t;return t};var X=function(e){return k(e)?V(e):z(e)};var Q=function(e){return e.split("")},J="[\\ud800-\\udfff]",Z="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ee="\\ud83c[\\udffb-\\udfff]",te="[^\\ud800-\\udfff]",ne="(?:\\ud83c[\\udde6-\\uddff]){2}",re="[\\ud800-\\udbff][\\udc00-\\udfff]",oe="(?:"+Z+"|"+ee+")"+"?",ie="[\\ufe0e\\ufe0f]?",ae=ie+oe+("(?:\\u200d(?:"+[te,ne,re].join("|")+")"+ie+oe+")*"),ue="(?:"+[te+Z+"?",Z,ne,re,J].join("|")+")",se=RegExp(ee+"(?="+ee+")|"+ue+ae,"g");var ce=function(e){return e.match(se)||[]};var fe=function(e){return k(e)?ce(e):Q(e)},le=Math.ceil;var pe=function(e,t){var n=(t=void 0===t?" ":D(t)).length;if(n<2)return n?p(t,e):t;var r=p(t,le(e/X(t)));return k(t)?A(fe(r),0,e).join(""):r.slice(0,e)};var de=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},ve=/^\s+|\s+$/g,he=/^[-+]0x[0-9a-f]+$/i,ge=/^0b[01]+$/i,ye=/^0o[0-7]+$/i,_e=parseInt;var me=function(e){if("number"==typeof e)return e;if(C(e))return NaN;if(de(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=de(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(ve,"");var n=ge.test(e);return n||ye.test(e)?_e(e.slice(2),n?2:8):he.test(e)?NaN:+e},be=1/0;var we=function(e){return e?(e=me(e))===be||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var Se=function(e){var t=we(e),n=t%1;return t==t?n?t-n:t:0};var Oe=function(e){return null==e?"":D(e)};var je=function(e,t,n){e=Oe(e);var r=(t=Se(t))?X(e):0;return t&&r<t?pe(t-r,n)+e:e};var Pe=function(){this.__data__=[],this.size=0};var Ie=function(e,t){return e===t||e!=e&&t!=t};var xe=function(e,t){for(var n=e.length;n--;)if(Ie(e[n][0],t))return n;return-1},Te=Array.prototype.splice;var Ce=function(e){var t=this.__data__,n=xe(t,e);return!(n<0)&&(n==t.length-1?t.pop():Te.call(t,n,1),--this.size,!0)};var Ee=function(e){var t=this.__data__,n=xe(t,e);return n<0?void 0:t[n][1]};var Re=function(e){return xe(this.__data__,e)>-1};var De=function(e,t){var n=this.__data__,r=xe(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function Me(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Me.prototype.clear=Pe,Me.prototype.delete=Ce,Me.prototype.get=Ee,Me.prototype.has=Re,Me.prototype.set=De;var Ae=Me;var Le=function(){this.__data__=new Ae,this.size=0};var ke=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var ze=function(e){return this.__data__.get(e)};var Fe=function(e){return this.__data__.has(e)};var Be,We=function(e){if(!de(e))return!1;var t=x(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Ge=h["__core-js_shared__"],Ue=(Be=/[^.]+$/.exec(Ge&&Ge.keys&&Ge.keys.IE_PROTO||""))?"Symbol(src)_1."+Be:"";var Ne=function(e){return!!Ue&&Ue in e},Ke=Function.prototype.toString;var $e=function(e){if(null!=e){try{return Ke.call(e)}catch(e){}try{return e+""}catch(e){}}return""},He=/^\[object .+?Constructor\]$/,qe=Function.prototype,Ye=Object.prototype,Ve=qe.toString,Xe=Ye.hasOwnProperty,Qe=RegExp("^"+Ve.call(Xe).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Je=function(e){return!(!de(e)||Ne(e))&&(We(e)?Qe:He).test($e(e))};var Ze=function(e,t){return null==e?void 0:e[t]};var et=function(e,t){var n=Ze(e,t);return Je(n)?n:void 0},tt=et(h,"Map"),nt=et(Object,"create");var rt=function(){this.__data__=nt?nt(null):{},this.size=0};var ot=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},it=Object.prototype.hasOwnProperty;var at=function(e){var t=this.__data__;if(nt){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return it.call(t,e)?t[e]:void 0},ut=Object.prototype.hasOwnProperty;var st=function(e){var t=this.__data__;return nt?void 0!==t[e]:ut.call(t,e)};var ct=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=nt&&void 0===t?"__lodash_hash_undefined__":t,this};function ft(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ft.prototype.clear=rt,ft.prototype.delete=ot,ft.prototype.get=at,ft.prototype.has=st,ft.prototype.set=ct;var lt=ft;var pt=function(){this.size=0,this.__data__={hash:new lt,map:new(tt||Ae),string:new lt}};var dt=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var vt=function(e,t){var n=e.__data__;return dt(t)?n["string"==typeof t?"string":"hash"]:n.map};var ht=function(e){var t=vt(this,e).delete(e);return this.size-=t?1:0,t};var gt=function(e){return vt(this,e).get(e)};var yt=function(e){return vt(this,e).has(e)};var _t=function(e,t){var n=vt(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function mt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}mt.prototype.clear=pt,mt.prototype.delete=ht,mt.prototype.get=gt,mt.prototype.has=yt,mt.prototype.set=_t;var bt=mt;var wt=function(e,t){var n=this.__data__;if(n instanceof Ae){var r=n.__data__;if(!tt||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new bt(r)}return n.set(e,t),this.size=n.size,this};function St(e){var t=this.__data__=new Ae(e);this.size=t.size}St.prototype.clear=Le,St.prototype.delete=ke,St.prototype.get=ze,St.prototype.has=Fe,St.prototype.set=wt;var Ot=St,jt=function(){try{var e=et(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Pt=function(e,t,n){"__proto__"==t&&jt?jt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var It=function(e,t,n){(void 0!==n&&!Ie(e[t],n)||void 0===n&&!(t in e))&&Pt(e,t,n)};var xt=function(e){return function(t,n,r){for(var o=-1,i=Object(t),a=r(t),u=a.length;u--;){var s=a[e?u:++o];if(!1===n(i[s],s,i))break}return t}}(),Tt=f((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,o=r&&r.exports===n?h.Buffer:void 0,i=o?o.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=i?i(n):new e.constructor(n);return e.copy(r),r}})),Ct=h.Uint8Array;var Et=function(e){var t=new e.constructor(e.byteLength);return new Ct(t).set(new Ct(e)),t};var Rt=function(e,t){var n=t?Et(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Dt=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},Mt=Object.create,At=function(){function e(){}return function(t){if(!de(t))return{};if(Mt)return Mt(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var Lt=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),kt=Object.prototype;var zt=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||kt)};var Ft=function(e){return"function"!=typeof e.constructor||zt(e)?{}:At(Lt(e))};var Bt=function(e){return T(e)&&"[object Arguments]"==x(e)},Wt=Object.prototype,Gt=Wt.hasOwnProperty,Ut=Wt.propertyIsEnumerable,Nt=Bt(function(){return arguments}())?Bt:function(e){return T(e)&&Gt.call(e,"callee")&&!Ut.call(e,"callee")};var Kt=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var $t=function(e){return null!=e&&Kt(e.length)&&!We(e)};var Ht=function(e){return T(e)&&$t(e)};var qt=function(){return!1},Yt=f((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,o=r&&r.exports===n?h.Buffer:void 0,i=(o?o.isBuffer:void 0)||qt;e.exports=i})),Vt=Function.prototype,Xt=Object.prototype,Qt=Vt.toString,Jt=Xt.hasOwnProperty,Zt=Qt.call(Object);var en=function(e){if(!T(e)||"[object Object]"!=x(e))return!1;var t=Lt(e);if(null===t)return!0;var n=Jt.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Qt.call(n)==Zt},tn={};tn["[object Float32Array]"]=tn["[object Float64Array]"]=tn["[object Int8Array]"]=tn["[object Int16Array]"]=tn["[object Int32Array]"]=tn["[object Uint8Array]"]=tn["[object Uint8ClampedArray]"]=tn["[object Uint16Array]"]=tn["[object Uint32Array]"]=!0,tn["[object Arguments]"]=tn["[object Array]"]=tn["[object ArrayBuffer]"]=tn["[object Boolean]"]=tn["[object DataView]"]=tn["[object Date]"]=tn["[object Error]"]=tn["[object Function]"]=tn["[object Map]"]=tn["[object Number]"]=tn["[object Object]"]=tn["[object RegExp]"]=tn["[object Set]"]=tn["[object String]"]=tn["[object WeakMap]"]=!1;var nn=function(e){return T(e)&&Kt(e.length)&&!!tn[x(e)]};var rn=function(e){return function(t){return e(t)}},on=f((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,o=r&&r.exports===n&&d.process,i=function(){try{var e=r&&r.require&&r.require("util").types;return e||o&&o.binding&&o.binding("util")}catch(e){}}();e.exports=i})),an=on&&on.isTypedArray,un=an?rn(an):nn;var sn=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},cn=Object.prototype.hasOwnProperty;var fn=function(e,t,n){var r=e[t];cn.call(e,t)&&Ie(r,n)&&(void 0!==n||t in e)||Pt(e,t,n)};var ln=function(e,t,n,r){var o=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var u=t[i],s=r?r(n[u],e[u],u,n,e):void 0;void 0===s&&(s=e[u]),o?Pt(n,u,s):fn(n,u,s)}return n};var pn=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},dn=/^(?:0|[1-9]\d*)$/;var vn=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&dn.test(e))&&e>-1&&e%1==0&&e<t},hn=Object.prototype.hasOwnProperty;var gn=function(e,t){var n=_(e),r=!n&&Nt(e),o=!n&&!r&&Yt(e),i=!n&&!r&&!o&&un(e),a=n||r||o||i,u=a?pn(e.length,String):[],s=u.length;for(var c in e)!t&&!hn.call(e,c)||a&&("length"==c||o&&("offset"==c||"parent"==c)||i&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||vn(c,s))||u.push(c);return u};var yn=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},_n=Object.prototype.hasOwnProperty;var mn=function(e){if(!de(e))return yn(e);var t=zt(e),n=[];for(var r in e)("constructor"!=r||!t&&_n.call(e,r))&&n.push(r);return n};var bn=function(e){return $t(e)?gn(e,!0):mn(e)};var wn=function(e){return ln(e,bn(e))};var Sn=function(e,t,n,r,o,i,a){var u=sn(e,n),s=sn(t,n),c=a.get(s);if(c)It(e,n,c);else{var f=i?i(u,s,n+"",e,t,a):void 0,l=void 0===f;if(l){var p=_(s),d=!p&&Yt(s),v=!p&&!d&&un(s);f=s,p||d||v?_(u)?f=u:Ht(u)?f=Dt(u):d?(l=!1,f=Tt(s,!0)):v?(l=!1,f=Rt(s,!0)):f=[]:en(s)||Nt(s)?(f=u,Nt(u)?f=wn(u):de(u)&&!We(u)||(f=Ft(s))):l=!1}l&&(a.set(s,f),o(f,s,r,i,a),a.delete(s)),It(e,n,f)}};var On=function e(t,n,r,o,i){t!==n&&xt(n,(function(a,u){if(i||(i=new Ot),de(a))Sn(t,n,u,r,e,o,i);else{var s=o?o(sn(t,u),a,u+"",t,n,i):void 0;void 0===s&&(s=a),It(t,u,s)}}),bn)};var jn=function(e){return e};var Pn=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},In=Math.max;var xn=function(e,t,n){return t=In(void 0===t?e.length-1:t,0),function(){for(var r=arguments,o=-1,i=In(r.length-t,0),a=Array(i);++o<i;)a[o]=r[t+o];o=-1;for(var u=Array(t+1);++o<t;)u[o]=r[o];return u[t]=n(a),Pn(e,this,u)}};var Tn=function(e){return function(){return e}},Cn=jt?function(e,t){return jt(e,"toString",{configurable:!0,enumerable:!1,value:Tn(t),writable:!0})}:jn,En=Date.now;var Rn=function(e){var t=0,n=0;return function(){var r=En(),o=16-(r-n);if(n=r,o>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Cn);var Dn=function(e,t){return Rn(xn(e,t,jn),e+"")};var Mn=function(e,t,n){if(!de(n))return!1;var r=typeof t;return!!("number"==r?$t(n)&&vn(t,n.length):"string"==r&&t in n)&&Ie(n[t],e)};var An=function(e){return Dn((function(t,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=e.length>3&&"function"==typeof i?(o--,i):void 0,a&&Mn(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),t=Object(t);++r<o;){var u=n[r];u&&e(t,u,r,i)}return t}))}((function(e,t,n){On(e,t,n)}));var Ln=function(e){return void 0===e};var kn=function(e){return"string"==typeof e||!_(e)&&T(e)&&"[object String]"==x(e)},zn=function(){return h.Date.now()},Fn=Math.max,Bn=Math.min;var Wn=function(e,t,n){var r,o,i,a,u,s,c=0,f=!1,l=!1,p=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function d(t){var n=r,i=o;return r=o=void 0,c=t,a=e.apply(i,n)}function v(e){return c=e,u=setTimeout(g,t),f?d(e):a}function h(e){var n=e-s;return void 0===s||n>=t||n<0||l&&e-c>=i}function g(){var e=zn();if(h(e))return y(e);u=setTimeout(g,function(e){var n=t-(e-s);return l?Bn(n,i-(e-c)):n}(e))}function y(e){return u=void 0,p&&r?d(e):(r=o=void 0,a)}function _(){var e=zn(),n=h(e);if(r=arguments,o=this,s=e,n){if(void 0===u)return v(s);if(l)return clearTimeout(u),u=setTimeout(g,t),d(s)}return void 0===u&&(u=setTimeout(g,t)),a}return t=me(t)||0,de(n)&&(f=!!n.leading,i=(l="maxWait"in n)?Fn(me(n.maxWait)||0,t):i,p="trailing"in n?!!n.trailing:p),_.cancel=function(){void 0!==u&&clearTimeout(u),c=0,r=s=o=u=void 0},_.flush=function(){return void 0===u?a:y(zn())},_};var Gn=function(e,t,n){var r=!0,o=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return de(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),Wn(e,t,{leading:r,maxWait:t,trailing:o})},Un=c(u),Nn=Un.__importDefault(je),Kn=Un.__importDefault(An),$n=Un.__importDefault(Ln),Hn=Un.__importDefault(kn),qn=Un.__importDefault(de),Yn=Un.__importDefault(_),Vn=Un.__importDefault(We),Xn=Un.__importDefault(Gn),Qn=Un.__importDefault(Wn),Jn={isUndefined:$n.default,padStart:Nn.default,merge:Kn.default,isString:Hn.default,isObject:qn.default,isArray:Yn.default,isFunction:Vn.default,debounce:Qn.default,throttle:Xn.default},Zn=Object.defineProperty({default:Jn},"__esModule",{value:!0}),er=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventReceiver=t.antLvs=t.AntLv=t.antMouseEvents=t.EAntMouseEvents=void 0;var n,r,o=Un.__importDefault(Zn);!function(e){e.mousedown="mousedown",e.mouseenter="mouseenter",e.mouseleave="mouseleave",e.mousemove="mousemove",e.mouseout="mouseout",e.mouseover="mouseover",e.mouseup="mouseup",e.dblclick="dblclick",e.click="click",e.auxclick="auxclick",e.contextmenu="contextmenu",e.wheel="wheel"}(n=t.EAntMouseEvents||(t.EAntMouseEvents={})),t.antMouseEvents=Object.keys(n),function(e){e.top="top",e.mid="mid",e.bot=" bot"}(r=t.AntLv||(t.AntLv={})),t.antLvs=Object.keys(r);var i=function(){function e(){var e=this;this.getEventsByType=function(t,n){var r=n||"mid";return e.getEventList(t+"."+r)};var t={};this.getEventList=function(e){return t[e]||[]},this.addEvent=function(e,n){t[e]?t[e].push(n):t[e]=[n]}}return e.prototype.on=function(e,t,n){var r=o.default.isFunction(t)?t:n,i=o.default.isFunction(t)?"mid":t,a=e+"."+i,u={lv:i,type:e,callback:r,target:this};this.addEvent(a,u)},e}();t.EventReceiver=i})),tr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Image=void 0;var n=[0,0],r=function(e){function t(t){var r=e.call(this)||this;return r.origin=t||n,r.complate=!1,r.el=null,r}return Un.__extends(t,e),t.prototype.load=function(e){var t=this;return this.origin=n,new Promise((function(n,r){t.complate=!1;var o=document.createElement("img");new Promise((function(t,n){var r=e;if(e instanceof File){var o=new FileReader;o.readAsDataURL(e),o.onload=function(e){var n;r=null===(n=e.target)||void 0===n?void 0:n.result,t(r)},o.onerror=function(){throw n(),"图片加载错误"}}else"string"==typeof e&&t(r)})).then((function(e){o.src=e,o.onload=function(){t.complate=!0,t.el=o,n(o)},o.onerror=function(){throw r(),"图片加载错误"}}))}))},t.prototype.getEl=function(){return this.el},t.prototype.getSize=function(e){if(this.el){var t=this.el;return[t.width*(e||1),t.height*(e||1)]}return n},t.prototype.getOrigin=function(){return this.origin.slice()},t.prototype.getCenter=function(e){if(void 0===e&&(e=1),this.el){var t=this.origin.slice(),r=t[0],o=t[1],i=this.el,a=[i.width*e/2,i.height*e/2];return[r+a[0],o+a[1]]}return n},t.prototype.getPosition=function(e){void 0===e&&(e=1);var t=this.getSize(),n=t[0]*e,r=t[1]*e,o=this.origin,i=o[0],a=o[1];return[this.origin,[i+n,a],[i+n,a+r],[i,a+r]]},t.prototype.toImagePoint=function(e,t){var n=e[0],r=e[1],o=this.origin;return[(n-o[0])/t,(r-o[1])/t]},t.prototype.getShape2CanvasPoints=function(e,t){var n=this;return e.map((function(e){return n.getShape2CanvasPoint(e,t)}))},t.prototype.getShape2CanvasPoint=function(e,t){var n=this.getOrigin(),r=n[0],o=n[1];return[r+e[0]*t,o+e[1]*t]},t.prototype.moveTo=function(e){this.origin=e},t}(er.EventReceiver);t.Image=r})),nr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.hexToRgba=t.getAdaptImgScale=t.isInCircle=t.getDistance=t.getRectPoints=t.isInSide=void 0;t.isInSide=function(e,t){for(var n=e[0],r=e[1],o=!1,i=0,a=t.length-1;i<t.length;a=i++){var u=t[i][0],s=t[i][1],c=t[a][0],f=t[a][1];s>r!=f>r&&n<(c-u)*(r-s)/(f-s)+u&&(o=!o)}return o};t.getRectPoints=function(e,t){return[e,[t[0],e[1]],t,[e[0],t[1]]]};t.getDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],o=Math.pow(n,2),i=Math.pow(r,2);return Math.abs(Math.sqrt(o+i))};t.isInCircle=function(e,n,r){return t.getDistance(e,r)<n};t.getAdaptImgScale=function(e,t){var n=e.width,r=e.height,o=1;return(t.width<n||t.height<r)&&(o=n>r?t.width/n:t.height/r),o};t.hexToRgba=function(e,t){void 0===t&&(t=1);var n=e.slice(1).split("");return 3===n.length&&(n=n.map((function(e){return e+e}))),"rgba("+n.map((function(e){return Number.parseInt(e,16)})).join(",")+", "+t+")"}})),rr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IDG=t.IDGenerator=void 0;var n=Un.__importDefault(Zn),r=function(){function e(e){var t=e||{},n=t.len,r=void 0===n?8:n,o=t.start,i=void 0===o?1:o;this.count=i,this.len=r}return e.prototype.getID=function(){var e=n.default.padStart(String(this.count),this.len,"0");return this.count++,e},e}();t.IDGenerator=r,t.IDG=new r})),or=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.css=t.create=void 0;var n=Un.__importDefault(Zn);t.create=function(e){return document.createElement(e)};t.css=function(e,t,r){if(n.default.isString(t)){if(!r)return e.style[t];!function(e,t,n){e.style[t]=n}(e,t,r)}else n.default.isObject(t)&&function(e,t){n.default.merge(e.style,t)}(e,t)}})),ir=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Popover=void 0;var n=Un.__importDefault(Zn),r={width:200,offset:5,padding:"0 4px",color:"#000",bgColor:"#fff",scale:1},o=function(){function e(e){var t=e.center,n=e.content,o=e.style;this.center=t||[0,0],this.content=n||"",this.style=Object.assign({},r,o);var i=or.create("div"),a=or.create("div");i.appendChild(a),this.container=i,this.body=a,this.parent=null}return e.prototype.move=function(e,t){this.center=e,this.style.scale=t,this.render()},e.prototype.css=function(e){Object.assign(this.style,e),this.render()},e.prototype.render=function(){var e=this.center,t=e[0],r=e[1],o=this.style,i=o.width,a=o.bgColor,u=o.offset,s=o.color,c=o.padding,f=o.scale;or.css(this.container,{position:"absolute",display:"inline-block",width:i+"px",transformOrigin:"left",left:t+"px",top:r+"px",transform:"scale("+f+")"}),or.css(this.body,{background:""+a,position:"absolute",bottom:u+"px",display:"inline-block",color:s,padding:c}),n.default.isString(this.content)?this.body.innerHTML=this.content:this.body.contains(this.content)||this.body.appendChild(this.content)},e.prototype.addTo=function(e){var t=e||this.parent;t&&!t.contains(this.container)&&(this.parent=t,t.appendChild(this.container))},e.prototype.remove=function(){this.parent&&this.parent.contains(this.container)&&this.parent.removeChild(this.container)},e}();t.Popover=o})),ar=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.disabled=t.active=t.normal=t.ShapeType=void 0;var n,r,o=Un.__importDefault(Zn);!function(e){e.Polygon="Polygon",e.Rect="Rect"}(n=t.ShapeType||(t.ShapeType={})),function(e){e.normal="normal",e.active="active",e.disabled="disabled"}(r||(r={})),t.normal={dotColor:"red",dotRadius:2,lineColor:"#c30",lineWidth:2,fillColor:"pink"},t.active={dotColor:"red",dotRadius:2,lineColor:"transparent",lineWidth:0,fillColor:"#c30"},t.disabled={dotColor:"#666",dotRadius:0,lineColor:"transparent",lineWidth:0,fillColor:"#666"};var i={normal:t.normal,active:t.active,disabled:t.disabled},a=function(e){function t(t){var r=e.call(this)||this;r.hidden=function(){return r.visible=!1,r},r.addPoint=o.default.throttle((function(e){r.positions[r.positions.length-1].toString()!==e.toString()&&r.positions.push(e)}),100),r.rmDot=function(e){"Rect"!==r.type&&(r.positions.length<=3||r.positions.splice(e,1))};var a=t.id,u=void 0===a?rr.IDG.getID():a,s=t.type,c=t.registerID,f=t.name,l=t.positions,p=t.data,d=t.active,v=void 0!==d&&d,h=t.closed,g=void 0===h||h,y=t.disabled,_=void 0!==y&&y,m=t.insert,b=void 0!==m&&m,w=t.visible,S=void 0===w||w,O=t.showTag,j=void 0===O||O,P=t.max,I=t.tag,x=void 0===I?f:I,T=t.style,C=void 0===T?{}:T;return r.id=u,r.type=s,r.name=f,r.registerID=c,r.status=_?"disabled":v?"active":"normal",r.positions=l,r.data=p||null,r.style=o.default.merge({},i,C),r.closed=g,r.visible=S,r.insert=b,r.showTag=j,r.tagger=new ir.Popover({content:x,style:{color:"#fff",bgColor:r.getStyle().dotColor}}),r.max=P,r.type===n.Rect&&(r.insert=!1,2===l.length&&g&&(r.positions=nr.getRectPoints(l[0],l[1]))),r}return Un.__extends(t,e),t.prototype.getPositions=function(){return this.positions||[]},t.prototype.isOnArc=function(e,t){void 0===t&&(t=1);var n=this.getPositions(),r=this.getStyle().dotRadius;return n.findIndex((function(n){return nr.isInCircle(e,r*t,n)}))},t.prototype.isOnShape=function(e){return nr.isInSide(e,this.getPositions())},t.prototype.isOnLine=function(e){var t=e[0],n=e[1],r=this.getPositions(),o=r[0];r.push(o);var i=null,a=[];r.forEach((function(e,t){var n={idx:t,position:e};i?(a.push([i,n]),i=n):i=n}));var u=a.filter((function(e){var r,o=e[0],i=e[1],a=o.position,u=a[0],s=a[1],c=i.position,f=c[0],l=c[1];return r=s===l?s-5<n&&n<s+5:s<l?s<n&&n<l:l<n&&n<s,(u===f?u-5<t&&t<u+5:u<f?u<t&&t<f:f<t&&t<u)&&r})).map((function(e){var r,o,i=e[0],a=e[1],u=i.position,s=u[0],c=u[1],f=a.position,l=f[0],p=f[1];if(p-c==0)r=t,o=c;else if(l-s==0)r=s,o=n;else{var d=(p-c)/(l-s),v=-d,h=n-v*t;o=v*(r=(h-(c-d*s))/(d-v))+h}return{idx:i.idx,position:[r,o]}})).map((function(t){var n=t.position;return{idx:t.idx,position:n,distance:nr.getDistance(n,e)}})).sort((function(e,t){return e.distance-t.distance}))[0];return!!u&&(u.distance<5&&u)},t.prototype.getStyle=function(){return this.style[this.status]},t.prototype.setActive=function(e){return this.isDisabled()||(this.status=e?"active":"normal"),this},t.prototype.isActive=function(){return"active"===this.status},t.prototype.close=function(){return this.closed=!0,this},t.prototype.isClose=function(){return this.closed},t.prototype.disabled=function(){return this.status="disabled",this.tagger.css({bgColor:this.getStyle().dotColor}),this},t.prototype.isDisabled=function(){return"disabled"===this.status},t.prototype.normal=function(){return this.status="normal",this.tagger.css({bgColor:this.getStyle().dotColor}),this},t.prototype.show=function(){return this.visible=!0,this},t.prototype.isHidden=function(){return!this.visible},t.prototype.isInsert=function(){return this.insert},t.prototype.isEnable=function(){return!this.isDisabled()&&!this.isHidden()},t.prototype.isShowTag=function(){return this.showTag&&!!this.tagger.content&&this.isClose()},t.prototype.tagShow=function(e){this.showTag=o.default.isUndefined(e)?!this.showTag:!!e,this.tagger.css({bgColor:this.getStyle().dotColor})},t.prototype.setTag=function(e){this.tagger.content=e},t.prototype.updatePositions=function(e){return this.positions=e,this},t}(er.EventReceiver);t.Shape=a})),ur=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeRegister=void 0;var n=function(){var e={};this.add=function(t,n){e[t]||(n.registerID=t,e[t]=n)},this.get=function(t){if(e[t])return Object.assign({},e[t]);throw"图形未注册"},this.is=function(t){return!!e[t]},this.getMap=function(){return Object.assign({},e)}};t.ShapeRegister=n})),sr=f((function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0,function(e){e.on="on",e.once="once"}(n||(n={}));var r=function(){function e(){var e={};this.getEvents=function(t){return e[t]||[]},this.createEvent=function(t,n){e[t]||(e[t]=[]),e[t].push(n)}}return e.prototype.emit=function(e,t){var n=this.getEvents(e);n.length&&n.forEach((function(e,r){var o=e.fn,i=e.type;o(t),"once"===i&&n.splice(r,1)}))},e.prototype.on=function(e,t){var n=this;return this.createEvent(e,{fn:t,type:"on"}),function(){var r=n.getEvents(e),o=r.findIndex((function(e){return e.fn===t}));o&&r&&r.splice(o,1)}},e.prototype.once=function(e,t){this.createEvent(e,{fn:t,type:"once"})},e}();t.EventEmitter=r})),cr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Canvas=void 0;var n=function(){var e=this;this.setPoints=function(t){var n=e.ctx();t.forEach((function(e,t){var r=e[0],o=e[1];t?n.lineTo(r,o):n.moveTo(r,o)}))},this.line=function(t,n){if(t.length>1){var r=e.ctx(),o=null,i=n.lineColor,a=void 0===i?"":i,u=n.lineWidth,s=void 0===u?1:u,c=n.lineDash,f=void 0===c?[0]:c,l=r.getLineDash();r.beginPath(),r.strokeStyle=a,r.lineWidth=s,r.setLineDash(f),t.forEach((function(e){var t=e[0],n=e[1];o&&(r.moveTo(o[0],o[1]),r.lineTo(t,n)),o=[t,n]})),r.stroke(),r.setLineDash(l),r.closePath()}return e},this.fill=function(t,n){if(t.length>2){var r=e.ctx(),o=n.fillColor,i=void 0===o?"":o,a=n.opacity;r.beginPath();var u=e.el().style.opacity||1;e.setPoints(t),r.fillStyle=i,a&&e.opacity(a),r.fill(),r.closePath(),e.opacity(Number(u))}},this.fillReact=function(t,n,r){var o=e.ctx(),i=r.fillColor,a=void 0===i?"":i,u=r.opacity,s=void 0===u?1:u;o.beginPath();var c=e.el().style.opacity||1;return o.fillStyle=nr.hexToRgba(a.toString(),s),s&&e.opacity(s),o.fillRect.apply(o,Un.__spreadArrays(t,n)),o.closePath(),e.opacity(Number(c)),e},this.polygon=function(t,n){return e.fill(t,n),e.line(t,n),e.dots(t,n),e},this.dot=function(t,n){var r=e.ctx(),o=n.dotColor,i=void 0===o?"":o,a=n.dotRadius,u=void 0===a?1:a;if(u<=0)return e;var s=t[0],c=t[1];return r.beginPath(),r.fillStyle=i,r.arc(s,c,u,0,2*Math.PI),r.fill(),r.closePath(),e},this.dots=function(t,n){var r=n.dotRadius;return(void 0===r?1:r)<=0||t.forEach((function(t){e.dot(t,n)})),e},this.opacity=function(t){e.ctx().globalAlpha=t},this.size=function(t,n){var r=e.el();r.width=t,r.height=n},this.getSize=function(){var t=e.el(),n=t.width,r=void 0===n?0:n,o=t.height;return[r,void 0===o?0:o]},this.cursor=function(t){return e.el().style.cursor=t,e},this.clear=function(){var t=e.el(),n=t.width,r=t.height;return e.ctx().clearRect(0,0,n,r),e};var t=or.create("canvas"),n=t.getContext("2d");t.tabIndex=-1,t.focus(),this.el=function(){return t},this.ctx=function(){return n}};t.Canvas=n})),fr=f((function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.displayCursor=void 0,function(e){e.draggable="grab",e.default="",e.label="copy",e.drag="grabbing",e.pointer="pointer",e.disabled="disabled"}(n||(n={}));t.displayCursor=function(e){return n[e]}})),lr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FuncKeyCode=t.MoveKeyCode=void 0,t.MoveKeyCode={W:87,S:83,A:65,D:68},t.FuncKeyCode={Q:81,E:69,F:70,DELETE:8}})),pr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Platform=void 0;var n=Un.__importDefault(Zn),r={width:800,height:600,bgColor:"#000",tagShow:!0,guideLine:!1,shouldShapeStyleScale:!0,shouldTagScale:!1},o=function(e){function t(t,o){var i=e.call(this)||this;i.options=function(){return Object.assign({},i._options)},i.setOptions=function(e){i._options=n.default.merge(i._options,e),i.render()},i.reset=function(){i._scale=1,i.cache=null,i.activeShape=null,i.drawing=null,i.shapeList=[],i.tagContainer.innerHTML=""},i.resize=function(){i.Image&&i.Image.el&&(i._scale=nr.getAdaptImgScale(i.Image.el,i.options()),i.Image.moveTo([0,0]),i.render())},i._init=function(){if(!i._isInit){i._isInit=!0;var e,t,n,r,o=i.canvas.el(),a=i.Image,u=null,s=null,c=function(){var e=i._isShapeMoving;i._isMouseDown=!1,i._isShapeMoving=!1,s=null,e&&i.render()};er.antMouseEvents.forEach((function(e){o.addEventListener(e,(function(t){t.preventDefault();var n=[t.offsetX,t.offsetY],r=i._scale,u=nr.isInSide(n,a.getPosition(r)),f=i.getTargetShape(n),l=f[0],p=f[1],d=i._isShapeMoving||!!l,v=i._isMouseDown||-1!==p;s=n;var h={offset:n,isOnImage:u,isOnShape:d,isOnArc:v,isPropagation:!0,stopPropagation:function(){h.isPropagation=!1},currentTarget:d?l:u?a:null,currentDotIndex:p};switch(e){case"mousedown":i._isMouseDown=!0;break;case"mouseup":case"mouseout":case"mouseleave":c();break;case"mouseenter":o.focus()}var g=function(e,t,n){for(var r=e.length,o=t.isPropagation,i=t.currentTarget;r;){if(!o){r=0;break}var a=e[r-1],u=a.callback,s=Un.__rest(a,["callback"]);n?i===l&&u(y,s):u(y,s),r--}},y=t;y.ante=h,er.antLvs.forEach((function(t){d&&i.shapeList.forEach((function(n){g(n.getEventsByType(e,t),h,!0)})),u&&(y.ante.isPropagation=!0,g(a.getEventsByType(e,t),h)),a.complate&&(y.ante.isPropagation=!0,g(i.getEventsByType(e,t),h))}))}))})),i.on("mousemove",(function(e){var t=e.ante;if(s=t.offset,i.Image&&!i._isMouseDown){t.isOnShape;var n=t.isOnArc;i.drawing?i.cursor("label"):n?i.cursor("pointer"):i.cursor("default")}})),i.on("mousemove","top",(function(e){i.options().guideLine&&(i._guideLineOrigin=e.ante.offset,i.render())})),function(){var e="top",t=[0,0],n=i.Image;i.on("mousedown",e,(function(e){var r=e.ante,o=r.offset,a=r.isOnImage;if(i.drawing&&n.el&&a){var u=n.toImagePoint(o,i._scale);t=u;var s=i.cache;if(s){if(i.drawing.type===ar.ShapeType.Polygon){var c=!1;if(s.positions.length>2){var f=s.positions[0],l=s.getStyle();c=nr.isInCircle(u,l.dotRadius,f)}if(s.max&&s.positions.length+1>=s.max&&(s.positions.push(u),c=!0),c)(d=i.createShape(i.drawing.registerID,{positions:s.positions,closed:!1})).updatePositions(s.positions).close(),i.shapeList.push(d),i.cache=null,i.emitter.emit("create",d),i.continuity||i.labelOff();else s.addPoint(u)}}else{var p=[];i.drawing.type===ar.ShapeType.Polygon?p=[u]:i.drawing.type===ar.ShapeType.Rect&&(p=[u,u,u,u]);var d=i.createShape(i.drawing.registerID,{positions:p,closed:!1,id:"cache"});i.cache=d}i.render()}})),i.on("mousemove",e,(function(e){var r=i.cache;if(i.drawing&&n.complate&&r){var o=e.ante.offset;if(i._isShapeMoving=!0,i.drawing.type===ar.ShapeType.Rect){var a=e.ante.offset,s=n.toImagePoint(a,i._scale),c=nr.getRectPoints(t,s);r.updatePositions(c),i.render()}else if(u===lr.FuncKeyCode.E){var f=n.toImagePoint(o,i._scale),l=r.positions.length;r.addPoint(f),r.positions.length>l&&i.render()}}})),i.on("mouseup",e,(function(){var e,n=i.cache,r=null===(e=i.drawing)||void 0===e?void 0:e.type;if(t=[0,0],r===ar.ShapeType.Rect&&n&&i.drawing){var o=n.getPositions(),a=i.createShape(i.drawing.registerID,{positions:o});a.close(),i.shapeList.push(a),i.emitter.emit("create",a),i.cache=null,i.continuity||i.labelOff(),i.render()}})),i.on("mouseout",e,(function(){}))}(),e="top",t=[0,0],n=[],r=-1,i.on("mousedown",e,(function(e){var o=e.ante,a=o.offset,u=o.currentTarget,s=o.currentDotIndex,c=o.isOnShape;t=a,i.drawing||c&&u&&(u.isDisabled()?i.activeShape=null:(e.ante.stopPropagation(),r=s,n=u.getPositions(),i.activeShape!==u&&function(e){i.loseActive(),e.setActive(!0),i.activeShape=e,i.emitter.emit("select",e),i.render()}(u),i._isShapeMoving=!0))})),i.on("mousemove",e,(function(e){var o=e.offsetX,a=e.offsetY;if(e.ante.isOnShape&&i.activeShape&&!i.drawing&&i._isMouseDown){i._isShapeMoving=!0;var u=[o-t[0],a-t[1]],s=[];if(-1===r)s=n.map((function(e){var t=e[0],n=e[1];return[t+u[0]/i._scale,n+u[1]/i._scale]})),i.cursor("drag");else{var c=(s=n.slice())[r],f=i._scale;if("Rect"===i.activeShape.type){switch(r){case 1:s[0]=[s[0][0],s[0][1]+u[1]/f],s[2]=[s[2][0]+u[0]/f,s[2][1]];break;case 3:s[0]=[s[0][0]+u[0]/f,s[0][1]],s[2]=[s[2][0],s[2][1]+u[1]/f];break;default:s[r]=[c[0]+u[0]/f,c[1]+u[1]/f]}s=nr.getRectPoints(s[0],s[2])}else s[r]=[c[0]+u[0]/f,c[1]+u[1]/f]}i.activeShape.updatePositions(s),i._isMouseDown&&i.render()}})),i.on("mouseup",e,(function(e){t=[0,0],r=-1})),function(){var e="bot",t=[0,0],n=i.Image;i.on("mousedown",e,(function(e){var r=e.ante,o=r.offset;if(!r.isOnShape&&n.complate){var i=o[0],a=o[1],u=n.getOrigin(),s=u[0],c=u[1];t=[i-s,a-c]}})),i.on("mousemove",e,(function(e){var r=e.ante,o=r.offset,a=r.isOnShape;if(i._isMouseDown&&!i._isShapeMoving&&!a&&!i.drawing){var u=o[0],s=o[1],c=[u-t[0],s-t[1]];n.moveTo(c),i._isMouseDown&&i.render()}}));var r=function(){c(),t=[0,0]};i.on("mouseup",e,r),i.on("mouseout",e,r)}(),i.Image.on("wheel",(function(e){if(i.Image.el){var t=e.ante.offset,n=e.deltaY<0?1:-1;i.scale(n,t)}})),o.addEventListener("keydown",(function(e){var t=e.keyCode;if(Object.values(lr.MoveKeyCode).some((function(e){return t===e}))){var n=a.getOrigin(),r=n[0],o=n[1];switch(t){case lr.MoveKeyCode.W:a.moveTo([r,o+10]);break;case lr.MoveKeyCode.S:a.moveTo([r,o-10]);break;case lr.MoveKeyCode.A:a.moveTo([r+10,o]);break;case lr.MoveKeyCode.D:a.moveTo([r-10,o])}i.render()}if(Object.values(lr.FuncKeyCode).some((function(e){return t===e})))switch(t){case lr.FuncKeyCode.F:if(!s)break;var c=i.getTargetShape(s),f=c[0],l=c[1];f&&-1!==l&&f.rmDot(l),i.render()}u=t})),o.addEventListener("keyup",(function(){u=null}))}},i.load=function(e){return i.reset(),new Promise((function(t,n){i.Image.load(e).then((function(e){i._scale=nr.getAdaptImgScale(e,i.options()),i.render(),i.emitter.emit("imageReady"),t(e)}),(function(e){n(e)}))}))},i.register=function(e,t){i.isRegister(e)||(i.shapeRegister.add(e,t),i.emitter.emit("shapeRegister"))},i.getRegisterMap=function(){return i.shapeRegister.getMap()},i.createShape=function(e,t){var n=i.shapeRegister.get(e);return new ar.Shape(Object.assign(n,t))},i.isRegister=function(e){return i.shapeRegister.is(e)},i.label=function(e,t){var r=i.shapeRegister.get(e);(i.drawing&&r&&e!==i.drawing.id||!i.drawing&&r)&&(i.drawing=r,i.emitter.emit("labelType")),n.default.isUndefined(t)||(i.continuity=!!t)},i.getDrawing=function(){return i.drawing},i.addShape=function(e,t){"number"==typeof t?i.shapeList.splice(t,0,e):(i.shapeList.push(e),i.emitter.emit("create"),i.emitter.emit("update")),i.render()},i.remove=function(e){var t=i.findShapeIndex(e),n=t[0],r=t[1];null!==n&&(null==r||r.tagger.remove(),i.shapeList.splice(n,1),i.render(),i.emitter.emit("delete"),i.emitter.emit("update"))},i.getTargetShape=function(e){var t=i.Image,n=i._scale,r=i.getShapeStyleScale()/n,o=null,a=-1,u=t.toImagePoint(e,n);i.activeShape&&i.activeShape.isEnable()&&(-1!==(a=(f=i.activeShape).isOnArc(u,r))&&(o=f),f.isOnShape(u)&&(o=f));if(!o)for(var s=i.shapeList.filter((function(e){return e.isEnable()})),c=s.length;c>0;){var f;if(-1!==(a=(f=s[c-1]).isOnArc(u,r))){o=f;break}if(f.isOnShape(u)){o=f;break}c--}return[o,a]},i.setActive=function(e){i.loseActive(),e.setActive(!0),i.render()},i.labelOff=function(){i.drawing=null,i.continuity=!1,i.emitter.emit("labelType"),i.cache&&(i.cache=null,i.render())},i.orderShape=function(e,t){var n=i.findShapeIndex(e),r=n[0],o=n[1];null!==r&&(i.shapeList.splice(r,1),t?i.shapeList.unshift(o):i.shapeList.push(o))},i.findShapeIndex=function(e){var t=null;if(e instanceof ar.Shape){var n=e;t=i.shapeList.findIndex((function(e){return e===n}))}else if("string"==typeof e){var r=e;t=i.shapeList.findIndex((function(e){return e.id===r}))}return[t,null===t?null:i.shapeList[t]]},i.getShapeList=function(){return i.shapeList},i.getShapeByName=function(e){return i.shapeList.filter((function(t){return t.name===e}))},i.loseActive=function(){i.shapeList.forEach((function(e){e.setActive(!1)}))},i.setGuideLine=function(e){i.setOptions({guideLine:n.default.isUndefined(e)?!i.options().guideLine:!!e}),i.render()},i.isTagShow=function(){return i.options().tagShow},i.setTagShow=function(e){i.setOptions({tagShow:n.default.isUndefined(e)?!i.isTagShow:!!e}),i.render()},i.setContinuity=function(e){i.continuity=!!e},i.cursor=n.default.throttle((function(e){i.canvas.cursor(fr.displayCursor(e))}),100),i.scale=function(e,t){if(n.default.isUndefined(e))return i._scale;var r=i.canvas.getSize(),o=r[0],a=r[1],u=i.Image.getSize(i._scale),s=u[0],c=u[1],f=0;if(-1!==e||(.25*o>=s&&f++,.25*a>=c&&f++,2!==f)){var l=Number((.05*e+i._scale).toFixed(2));i.scaleTo(l,t)}},i.scaleTo=function(e,t){var n=Number(e.toFixed(2)),r=i.Image,o=t||r.getCenter(i._scale),a=o[0],u=o[1],s=r.getSize(),c=s[0],f=s[1],l=r.getOrigin(),p=l[0],d=l[1],v=c*i._scale,h=c*n,g=Math.abs(a-p),y=(a-p>0?-1:1)*(g*h/v-g)+p,_=f*i._scale,m=f*n,b=Math.abs(u-d),w=(u-d>0?-1:1)*(b*m/_-b)+d;r.moveTo([y,w]),i._scale=n,i.render()},i.getShapeStyleScale=function(){return i._options.shouldShapeStyleScale?i._scale:Number((1+i._scale).toFixed(2))},i.moveTo=function(e){i.Image.moveTo(e)},i._clearCanvas=function(){i.emitter.emit("beforeClear"),i.canvas.clear(),i.emitter.emit("afterClear")},i._renderBackground=function(){var e=i.options(),t=e.bgColor,n=e.width,r=e.height;i.emitter.emit("beforeRenderBackground"),i.canvas.fillReact([0,0],[n,r],{fillColor:t}),i.emitter.emit("afterRenderBackground")},i._renderImage=function(){var e=i.canvas.ctx(),t=i.Image;if(t&&t.complate){var n=t.getEl(),r=t.getSize(),o=r[0],a=r[1],u=o*i._scale,s=a*i._scale,c=t.getOrigin(),f=c[0],l=c[1];i.emitter.emit("beforeRenderImage"),e.drawImage(n,f,l,u,s),i.emitter.emit("afterRenderImage")}},i._renderGuideLine=function(){var e=i._guideLineOrigin,t=e[0],n=e[1],r=i.options(),o=[5],a=[[0,n],[r.width,n]];i.canvas.line(a,{lineColor:"red",lineWidth:1,lineDash:o});var u=[[t,0],[t,r.height]];i.canvas.line(u,{lineColor:"red",lineWidth:1,lineDash:o})},i._renderShape=function(e){var t=i.Image;if(e.isHidden())e.tagger.remove();else{var n=i._scale,r=e.positions,o=e.getStyle(),a=o.dotColor,u=o.dotRadius,s=o.lineColor,c=o.lineWidth,f=o.fillColor,l=t.getShape2CanvasPoints(r,n);(e.isClose()||e.type===ar.ShapeType.Rect)&&l.push(l[0]);var p={lineColor:s,lineWidth:c*n,dotRadius:u*i.getShapeStyleScale(),dotColor:a,fillColor:f,opacity:.7};e.isClose()?i.canvas.polygon(l,p):(i.canvas.fill(l,p),i.canvas.line(l,p),i.canvas.dot(l[0],p));var d=i.isTagShow()&&e.isShowTag()&&!i._isShapeMoving&&!i.drawing,v=e.tagger;if(d){var h=i._scale;v.addTo(i.tagContainer),v.move(l[0],i._options.shouldTagScale?h:1)}else v.remove()}},i._renderCache=function(){i.cache&&(i.emitter.emit("beforeRenderDrawing"),i._renderShape(i.cache),i.emitter.emit("afterRenderDrawing"))},i._renderShapeList=function(){var e=i.Image;if(e&&e.complate){var t=i.shapeList;if(t.length){i.emitter.emit("beforeRenderShape");var n=null;t.forEach((function(e){e.isActive()?n=e:i._renderShape(e)})),n&&i._renderShape(n),i.emitter.emit("afterRenderShape")}}},i.forceRender=function(){i.emitter.emit("beforeRender"),i._clearCanvas(),i._renderBackground(),i._renderImage(),i._renderShapeList(),i._renderCache(),i.options().guideLine&&i._renderGuideLine(),i.emitter.emit("afterRender")},i.render=n.default.throttle((function(){i.forceRender()}),17),i.container=t,or.css(i.container,{position:"relative",overflow:"hidden"}),i._options=Object.assign({},r,o),i.emitter=new sr.EventEmitter,i.canvas=new cr.Canvas;var a=i.options();i.canvas.size(a.width,a.height),i.container.append(i.canvas.el());var u=or.create("div");return i.tagContainer=u,i.container.appendChild(i.tagContainer),i._scale=1,i.continuity=!1,i._guideLineOrigin=[0,0],i.cache=null,i.activeShape=null,i.Image=new tr.Image,i.shapeRegister=new ur.ShapeRegister,i.drawing=null,i.shapeList=[],i._isInit=!1,i._isMouseDown=!1,i._isShapeMoving=!1,i.render(),i._init(),i}return Un.__extends(t,e),t}(er.EventReceiver);t.Platform=o})),dr=Un.__importStar(nr);return function(e){function t(t,n){return e.call(this,t,n)||this}return Un.__extends(t,e),t.Shape=ar.Shape,t.IDGenerator=rr.IDGenerator,t.utils=dr,t}(pr.Platform)}));
