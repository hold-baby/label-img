/**!
 * label-img - v0.0.54
 * image annotation tool with javascript
 *
 * 2021-02-04 14:35:10
 * MIT (c) hold-baby
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).LabelImg=e()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};var e=function(){return(e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};var n=Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function r(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function o(t){return this instanceof o?(this.v=t,this):new o(t)}var a=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};var u=Object.freeze({__proto__:null,__extends:function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},get __assign(){return e},__rest:function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(t,r[i])&&(n[r[i]]=t[r[i]])}return n},__decorate:function(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(i=t[u])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a},__param:function(t,e){return function(n,r){e(n,r,t)}},__metadata:function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function(t,e,n,r){return new(n||(n=Promise))((function(i,o){function a(t){try{c(r.next(t))}catch(t){o(t)}}function u(t){try{c(r.throw(t))}catch(t){o(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},__generator:function(t,e){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=e.call(t,a)}catch(t){o=[6,t],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},__createBinding:n,__exportStar:function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)},__values:r,__read:i,__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(i(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),i=0;for(e=0;e<n;e++)for(var o=arguments[e],a=0,u=o.length;a<u;a++,i++)r[i]=o[a];return r},__await:o,__asyncGenerator:function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),a=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){a.push([t,e,n,r])>1||c(t,e)}))})}function c(t,e){try{(n=i[t](e)).value instanceof o?Promise.resolve(n.value.v).then(s,f):l(a[0][2],n)}catch(t){l(a[0][3],t)}var n}function s(t){c("next",t)}function f(t){c("throw",t)}function l(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}},__asyncDelegator:function(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:o(t[r](e)),done:"return"===r}:i?i(e):e}:i}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=r(t),e={},i("next"),i("throw"),i("return"),e[Symbol.asyncIterator]=function(){return this},e);function i(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,i,(e=t[n](e)).done,e.value)}))}}},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return a(e,t),e},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}}),c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function s(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})})),e}function f(t){var e={exports:{}};return t(e,e.exports),e.exports}var l=Math.floor;var p=function(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=l(e/2))&&(t+=t)}while(e);return n},d="object"==typeof c&&c&&c.Object===Object&&c,v="object"==typeof self&&self&&self.Object===Object&&self,h=d||v||Function("return this")(),g=h.Symbol;var y=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i},_=Array.isArray,b=Object.prototype,m=b.hasOwnProperty,w=b.toString,S=g?g.toStringTag:void 0;var O=function(t){var e=m.call(t,S),n=t[S];try{t[S]=void 0;var r=!0}catch(t){}var i=w.call(t);return r&&(e?t[S]=n:delete t[S]),i},j=Object.prototype.toString;var P=function(t){return j.call(t)},I=g?g.toStringTag:void 0;var x=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":I&&I in Object(t)?O(t):P(t)};var E=function(t){return null!=t&&"object"==typeof t};var C=function(t){return"symbol"==typeof t||E(t)&&"[object Symbol]"==x(t)},T=g?g.prototype:void 0,D=T?T.toString:void 0;var A=function t(e){if("string"==typeof e)return e;if(_(e))return y(e,t)+"";if(C(e))return D?D.call(e):"";var n=e+"";return"0"==n&&1/e==-Infinity?"-0":n};var M=function(t,e,n){var r=-1,i=t.length;e<0&&(e=-e>i?0:i+e),(n=n>i?i:n)<0&&(n+=i),i=e>n?0:n-e>>>0,e>>>=0;for(var o=Array(i);++r<i;)o[r]=t[r+e];return o};var R=function(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:M(t,e,n)},L=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var k=function(t){return L.test(t)};var z=function(t){return function(e){return null==e?void 0:e[t]}}("length"),B="[\\ud800-\\udfff]",F="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",N="\\ud83c[\\udffb-\\udfff]",G="[^\\ud800-\\udfff]",U="(?:\\ud83c[\\udde6-\\uddff]){2}",W="[\\ud800-\\udbff][\\udc00-\\udfff]",$="(?:"+F+"|"+N+")"+"?",H="[\\ufe0e\\ufe0f]?",q=H+$+("(?:\\u200d(?:"+[G,U,W].join("|")+")"+H+$+")*"),Y="(?:"+[G+F+"?",F,U,W,B].join("|")+")",V=RegExp(N+"(?="+N+")|"+Y+q,"g");var X=function(t){for(var e=V.lastIndex=0;V.test(t);)++e;return e};var J=function(t){return k(t)?X(t):z(t)};var K=function(t){return t.split("")},Q="[\\ud800-\\udfff]",Z="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",tt="\\ud83c[\\udffb-\\udfff]",et="[^\\ud800-\\udfff]",nt="(?:\\ud83c[\\udde6-\\uddff]){2}",rt="[\\ud800-\\udbff][\\udc00-\\udfff]",it="(?:"+Z+"|"+tt+")"+"?",ot="[\\ufe0e\\ufe0f]?",at=ot+it+("(?:\\u200d(?:"+[et,nt,rt].join("|")+")"+ot+it+")*"),ut="(?:"+[et+Z+"?",Z,nt,rt,Q].join("|")+")",ct=RegExp(tt+"(?="+tt+")|"+ut+at,"g");var st=function(t){return t.match(ct)||[]};var ft=function(t){return k(t)?st(t):K(t)},lt=Math.ceil;var pt=function(t,e){var n=(e=void 0===e?" ":A(e)).length;if(n<2)return n?p(e,t):e;var r=p(e,lt(t/J(e)));return k(e)?R(ft(r),0,t).join(""):r.slice(0,t)};var dt=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},vt=/^\s+|\s+$/g,ht=/^[-+]0x[0-9a-f]+$/i,gt=/^0b[01]+$/i,yt=/^0o[0-7]+$/i,_t=parseInt;var bt=function(t){if("number"==typeof t)return t;if(C(t))return NaN;if(dt(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=dt(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(vt,"");var n=gt.test(t);return n||yt.test(t)?_t(t.slice(2),n?2:8):ht.test(t)?NaN:+t},mt=1/0;var wt=function(t){return t?(t=bt(t))===mt||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var St=function(t){var e=wt(t),n=e%1;return e==e?n?e-n:e:0};var Ot=function(t){return null==t?"":A(t)};var jt=function(t,e,n){t=Ot(t);var r=(e=St(e))?J(t):0;return e&&r<e?pt(e-r,n)+t:t};var Pt=function(){this.__data__=[],this.size=0};var It=function(t,e){return t===e||t!=t&&e!=e};var xt=function(t,e){for(var n=t.length;n--;)if(It(t[n][0],e))return n;return-1},Et=Array.prototype.splice;var Ct=function(t){var e=this.__data__,n=xt(e,t);return!(n<0)&&(n==e.length-1?e.pop():Et.call(e,n,1),--this.size,!0)};var Tt=function(t){var e=this.__data__,n=xt(e,t);return n<0?void 0:e[n][1]};var Dt=function(t){return xt(this.__data__,t)>-1};var At=function(t,e){var n=this.__data__,r=xt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function Mt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}Mt.prototype.clear=Pt,Mt.prototype.delete=Ct,Mt.prototype.get=Tt,Mt.prototype.has=Dt,Mt.prototype.set=At;var Rt=Mt;var Lt=function(){this.__data__=new Rt,this.size=0};var kt=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n};var zt=function(t){return this.__data__.get(t)};var Bt=function(t){return this.__data__.has(t)};var Ft,Nt=function(t){if(!dt(t))return!1;var e=x(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Gt=h["__core-js_shared__"],Ut=(Ft=/[^.]+$/.exec(Gt&&Gt.keys&&Gt.keys.IE_PROTO||""))?"Symbol(src)_1."+Ft:"";var Wt=function(t){return!!Ut&&Ut in t},$t=Function.prototype.toString;var Ht=function(t){if(null!=t){try{return $t.call(t)}catch(t){}try{return t+""}catch(t){}}return""},qt=/^\[object .+?Constructor\]$/,Yt=Function.prototype,Vt=Object.prototype,Xt=Yt.toString,Jt=Vt.hasOwnProperty,Kt=RegExp("^"+Xt.call(Jt).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var Qt=function(t){return!(!dt(t)||Wt(t))&&(Nt(t)?Kt:qt).test(Ht(t))};var Zt=function(t,e){return null==t?void 0:t[e]};var te=function(t,e){var n=Zt(t,e);return Qt(n)?n:void 0},ee=te(h,"Map"),ne=te(Object,"create");var re=function(){this.__data__=ne?ne(null):{},this.size=0};var ie=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},oe=Object.prototype.hasOwnProperty;var ae=function(t){var e=this.__data__;if(ne){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return oe.call(e,t)?e[t]:void 0},ue=Object.prototype.hasOwnProperty;var ce=function(t){var e=this.__data__;return ne?void 0!==e[t]:ue.call(e,t)};var se=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ne&&void 0===e?"__lodash_hash_undefined__":e,this};function fe(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}fe.prototype.clear=re,fe.prototype.delete=ie,fe.prototype.get=ae,fe.prototype.has=ce,fe.prototype.set=se;var le=fe;var pe=function(){this.size=0,this.__data__={hash:new le,map:new(ee||Rt),string:new le}};var de=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var ve=function(t,e){var n=t.__data__;return de(e)?n["string"==typeof e?"string":"hash"]:n.map};var he=function(t){var e=ve(this,t).delete(t);return this.size-=e?1:0,e};var ge=function(t){return ve(this,t).get(t)};var ye=function(t){return ve(this,t).has(t)};var _e=function(t,e){var n=ve(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function be(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}be.prototype.clear=pe,be.prototype.delete=he,be.prototype.get=ge,be.prototype.has=ye,be.prototype.set=_e;var me=be;var we=function(t,e){var n=this.__data__;if(n instanceof Rt){var r=n.__data__;if(!ee||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new me(r)}return n.set(t,e),this.size=n.size,this};function Se(t){var e=this.__data__=new Rt(t);this.size=e.size}Se.prototype.clear=Lt,Se.prototype.delete=kt,Se.prototype.get=zt,Se.prototype.has=Bt,Se.prototype.set=we;var Oe=Se,je=function(){try{var t=te(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Pe=function(t,e,n){"__proto__"==e&&je?je(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n};var Ie=function(t,e,n){(void 0!==n&&!It(t[e],n)||void 0===n&&!(e in t))&&Pe(t,e,n)};var xe=function(t){return function(e,n,r){for(var i=-1,o=Object(e),a=r(e),u=a.length;u--;){var c=a[t?u:++i];if(!1===n(o[c],c,o))break}return e}}(),Ee=f((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,i=r&&r.exports===n?h.Buffer:void 0,o=i?i.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=o?o(n):new t.constructor(n);return t.copy(r),r}})),Ce=h.Uint8Array;var Te=function(t){var e=new t.constructor(t.byteLength);return new Ce(e).set(new Ce(t)),e};var De=function(t,e){var n=e?Te(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)};var Ae=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e},Me=Object.create,Re=function(){function t(){}return function(e){if(!dt(e))return{};if(Me)return Me(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var Le=function(t,e){return function(n){return t(e(n))}}(Object.getPrototypeOf,Object),ke=Object.prototype;var ze=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||ke)};var Be=function(t){return"function"!=typeof t.constructor||ze(t)?{}:Re(Le(t))};var Fe=function(t){return E(t)&&"[object Arguments]"==x(t)},Ne=Object.prototype,Ge=Ne.hasOwnProperty,Ue=Ne.propertyIsEnumerable,We=Fe(function(){return arguments}())?Fe:function(t){return E(t)&&Ge.call(t,"callee")&&!Ue.call(t,"callee")};var $e=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var He=function(t){return null!=t&&$e(t.length)&&!Nt(t)};var qe=function(t){return E(t)&&He(t)};var Ye=function(){return!1},Ve=f((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,i=r&&r.exports===n?h.Buffer:void 0,o=(i?i.isBuffer:void 0)||Ye;t.exports=o})),Xe=Function.prototype,Je=Object.prototype,Ke=Xe.toString,Qe=Je.hasOwnProperty,Ze=Ke.call(Object);var tn=function(t){if(!E(t)||"[object Object]"!=x(t))return!1;var e=Le(t);if(null===e)return!0;var n=Qe.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&Ke.call(n)==Ze},en={};en["[object Float32Array]"]=en["[object Float64Array]"]=en["[object Int8Array]"]=en["[object Int16Array]"]=en["[object Int32Array]"]=en["[object Uint8Array]"]=en["[object Uint8ClampedArray]"]=en["[object Uint16Array]"]=en["[object Uint32Array]"]=!0,en["[object Arguments]"]=en["[object Array]"]=en["[object ArrayBuffer]"]=en["[object Boolean]"]=en["[object DataView]"]=en["[object Date]"]=en["[object Error]"]=en["[object Function]"]=en["[object Map]"]=en["[object Number]"]=en["[object Object]"]=en["[object RegExp]"]=en["[object Set]"]=en["[object String]"]=en["[object WeakMap]"]=!1;var nn=function(t){return E(t)&&$e(t.length)&&!!en[x(t)]};var rn=function(t){return function(e){return t(e)}},on=f((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,i=r&&r.exports===n&&d.process,o=function(){try{var t=r&&r.require&&r.require("util").types;return t||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=o})),an=on&&on.isTypedArray,un=an?rn(an):nn;var cn=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]},sn=Object.prototype.hasOwnProperty;var fn=function(t,e,n){var r=t[e];sn.call(t,e)&&It(r,n)&&(void 0!==n||e in t)||Pe(t,e,n)};var ln=function(t,e,n,r){var i=!n;n||(n={});for(var o=-1,a=e.length;++o<a;){var u=e[o],c=r?r(n[u],t[u],u,n,t):void 0;void 0===c&&(c=t[u]),i?Pe(n,u,c):fn(n,u,c)}return n};var pn=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r},dn=/^(?:0|[1-9]\d*)$/;var vn=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&dn.test(t))&&t>-1&&t%1==0&&t<e},hn=Object.prototype.hasOwnProperty;var gn=function(t,e){var n=_(t),r=!n&&We(t),i=!n&&!r&&Ve(t),o=!n&&!r&&!i&&un(t),a=n||r||i||o,u=a?pn(t.length,String):[],c=u.length;for(var s in t)!e&&!hn.call(t,s)||a&&("length"==s||i&&("offset"==s||"parent"==s)||o&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||vn(s,c))||u.push(s);return u};var yn=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e},_n=Object.prototype.hasOwnProperty;var bn=function(t){if(!dt(t))return yn(t);var e=ze(t),n=[];for(var r in t)("constructor"!=r||!e&&_n.call(t,r))&&n.push(r);return n};var mn=function(t){return He(t)?gn(t,!0):bn(t)};var wn=function(t){return ln(t,mn(t))};var Sn=function(t,e,n,r,i,o,a){var u=cn(t,n),c=cn(e,n),s=a.get(c);if(s)Ie(t,n,s);else{var f=o?o(u,c,n+"",t,e,a):void 0,l=void 0===f;if(l){var p=_(c),d=!p&&Ve(c),v=!p&&!d&&un(c);f=c,p||d||v?_(u)?f=u:qe(u)?f=Ae(u):d?(l=!1,f=Ee(c,!0)):v?(l=!1,f=De(c,!0)):f=[]:tn(c)||We(c)?(f=u,We(u)?f=wn(u):dt(u)&&!Nt(u)||(f=Be(c))):l=!1}l&&(a.set(c,f),i(f,c,r,o,a),a.delete(c)),Ie(t,n,f)}};var On=function t(e,n,r,i,o){e!==n&&xe(n,(function(a,u){if(o||(o=new Oe),dt(a))Sn(e,n,u,r,t,i,o);else{var c=i?i(cn(e,u),a,u+"",e,n,o):void 0;void 0===c&&(c=a),Ie(e,u,c)}}),mn)};var jn=function(t){return t};var Pn=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},In=Math.max;var xn=function(t,e,n){return e=In(void 0===e?t.length-1:e,0),function(){for(var r=arguments,i=-1,o=In(r.length-e,0),a=Array(o);++i<o;)a[i]=r[e+i];i=-1;for(var u=Array(e+1);++i<e;)u[i]=r[i];return u[e]=n(a),Pn(t,this,u)}};var En=function(t){return function(){return t}},Cn=je?function(t,e){return je(t,"toString",{configurable:!0,enumerable:!1,value:En(e),writable:!0})}:jn,Tn=Date.now;var Dn=function(t){var e=0,n=0;return function(){var r=Tn(),i=16-(r-n);if(n=r,i>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Cn);var An=function(t,e){return Dn(xn(t,e,jn),t+"")};var Mn=function(t,e,n){if(!dt(n))return!1;var r=typeof e;return!!("number"==r?He(n)&&vn(e,n.length):"string"==r&&e in n)&&It(n[e],t)};var Rn=function(t){return An((function(e,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=t.length>3&&"function"==typeof o?(i--,o):void 0,a&&Mn(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),e=Object(e);++r<i;){var u=n[r];u&&t(e,u,r,o)}return e}))}((function(t,e,n){On(t,e,n)}));var Ln=function(t){return void 0===t};var kn=function(t){return"string"==typeof t||!_(t)&&E(t)&&"[object String]"==x(t)},zn=function(){return h.Date.now()},Bn=Math.max,Fn=Math.min;var Nn=function(t,e,n){var r,i,o,a,u,c,s=0,f=!1,l=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function d(e){var n=r,o=i;return r=i=void 0,s=e,a=t.apply(o,n)}function v(t){return s=t,u=setTimeout(g,e),f?d(t):a}function h(t){var n=t-c;return void 0===c||n>=e||n<0||l&&t-s>=o}function g(){var t=zn();if(h(t))return y(t);u=setTimeout(g,function(t){var n=e-(t-c);return l?Fn(n,o-(t-s)):n}(t))}function y(t){return u=void 0,p&&r?d(t):(r=i=void 0,a)}function _(){var t=zn(),n=h(t);if(r=arguments,i=this,c=t,n){if(void 0===u)return v(c);if(l)return clearTimeout(u),u=setTimeout(g,e),d(c)}return void 0===u&&(u=setTimeout(g,e)),a}return e=bt(e)||0,dt(n)&&(f=!!n.leading,o=(l="maxWait"in n)?Bn(bt(n.maxWait)||0,e):o,p="trailing"in n?!!n.trailing:p),_.cancel=function(){void 0!==u&&clearTimeout(u),s=0,r=c=i=u=void 0},_.flush=function(){return void 0===u?a:y(zn())},_};var Gn=function(t,e,n){var r=!0,i=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return dt(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Nn(t,e,{leading:r,maxWait:e,trailing:i})},Un=s(u),Wn=Un.__importDefault(jt),$n=Un.__importDefault(Rn),Hn=Un.__importDefault(Ln),qn=Un.__importDefault(kn),Yn=Un.__importDefault(dt),Vn=Un.__importDefault(_),Xn=Un.__importDefault(Nt),Jn=Un.__importDefault(Gn),Kn={isUndefined:Hn.default,padStart:Wn.default,merge:$n.default,isString:qn.default,isObject:Yn.default,isArray:Vn.default,isFunction:Xn.default,throttle:Jn.default},Qn=Object.defineProperty({default:Kn},"__esModule",{value:!0}),Zn=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.EventReceiver=e.antLvs=e.AntLv=e.antMouseEvents=e.EAntMouseEvents=void 0;var n,r,i=Un.__importDefault(Qn);!function(t){t.mousedown="mousedown",t.mouseenter="mouseenter",t.mouseleave="mouseleave",t.mousemove="mousemove",t.mouseout="mouseout",t.mouseover="mouseover",t.mouseup="mouseup",t.dblclick="dblclick",t.click="click",t.auxclick="auxclick",t.contextmenu="contextmenu",t.wheel="wheel"}(n=e.EAntMouseEvents||(e.EAntMouseEvents={})),e.antMouseEvents=Object.keys(n),function(t){t.top="top",t.mid="mid",t.bot=" bot"}(r=e.AntLv||(e.AntLv={})),e.antLvs=Object.keys(r);var o=function(){function t(){var t=this;this.getEventsByType=function(e,n){var r=n||"mid";return t.getEventList(e+"."+r)};var e={};this.getEventList=function(t){return e[t]||[]},this.addEvent=function(t,n){e[t]?e[t].push(n):e[t]=[n]}}return t.prototype.on=function(t,e,n){var r=i.default.isFunction(e)?e:n,o=i.default.isFunction(e)?"mid":e,a=t+"."+o,u={lv:o,type:t,callback:r,target:this};this.addEvent(a,u)},t}();e.EventReceiver=o})),tr=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Image=void 0;var n=[0,0],r=function(t){function e(e){var r=t.call(this)||this;return r.origin=e||n,r.complate=!1,r.el=null,r}return Un.__extends(e,t),e.prototype.load=function(t){var e=this;return this.origin=n,new Promise((function(n,r){e.complate=!1;var i=document.createElement("img");new Promise((function(e,n){var r=t;if(t instanceof File){var i=new FileReader;i.readAsDataURL(t),i.onload=function(t){var n;r=null===(n=t.target)||void 0===n?void 0:n.result,e(r)},i.onerror=function(){throw n(),"图片加载错误"}}else"string"==typeof t&&e(r)})).then((function(t){i.src=t,i.onload=function(){e.complate=!0,e.el=i,n(i)},i.onerror=function(){throw r(),"图片加载错误"}}))}))},e.prototype.getEl=function(){return this.el},e.prototype.getSize=function(t){if(this.el){var e=this.el;return[e.width*(t||1),e.height*(t||1)]}return n},e.prototype.getOrigin=function(){return this.origin.slice()},e.prototype.getPosition=function(t){void 0===t&&(t=1);var e=this.getSize(),n=e[0]*t,r=e[1]*t,i=this.origin,o=i[0],a=i[1];return[this.origin,[o+n,a],[o+n,a+r],[o,a+r]]},e.prototype.toImagePoint=function(t,e){var n=t[0],r=t[1],i=this.origin;return[(n-i[0])/e,(r-i[1])/e]},e.prototype.getShape2CanvasPoints=function(t,e){var n=this.getOrigin(),r=n[0],i=n[1];return t.map((function(t){var n=t[0],o=t[1];return[r+n*e,i+o*e]}))},e.prototype.setOrigin=function(t){this.origin=t},e}(Zn.EventReceiver);e.Image=r})),er=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getAdaptImgScale=e.isInCircle=e.getDistance=e.getRectPoints=e.isInSide=void 0;e.isInSide=function(t,e){for(var n=t[0],r=t[1],i=!1,o=0,a=e.length-1;o<e.length;a=o++){var u=e[o][0],c=e[o][1],s=e[a][0],f=e[a][1];c>r!=f>r&&n<(s-u)*(r-c)/(f-c)+u&&(i=!i)}return i};e.getRectPoints=function(t,e){return[t,[e[0],t[1]],e,[t[0],e[1]]]};e.getDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=Math.pow(n,2),o=Math.pow(r,2);return Math.abs(Math.sqrt(i+o))};e.isInCircle=function(t,n,r){return e.getDistance(t,r)<n};e.getAdaptImgScale=function(t,e){var n=t.width,r=t.height,i=1;return(e.width<n||e.height<r)&&(i=n>r?e.width/n:e.height/r),i}})),nr=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.css=e.create=void 0;var n=Un.__importDefault(Qn);e.create=function(t){return document.createElement(t)};e.css=function(t,e,r){if(n.default.isString(e)){if(!r)return t.style[e];!function(t,e,n){t.style[e]=n}(t,e,r)}else n.default.isObject(e)&&function(t,e){n.default.merge(t.style,e)}(t,e)}})),rr=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.IDG=e.IDGenerator=void 0;var n=Un.__importDefault(Qn),r=function(){function t(t){var e=t||{},n=e.len,r=void 0===n?8:n,i=e.start,o=void 0===i?1:i;this.count=o,this.len=r}return t.prototype.getID=function(){var t=n.default.padStart(String(this.count),this.len,"0");return this.count++,t},t}();e.IDGenerator=r,e.IDG=new r})),ir=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.disabled=e.active=e.normal=e.ShapeType=void 0;var n,r,i=Un.__importDefault(Qn);!function(t){t.Polygon="Polygon",t.Rect="Rect"}(n=e.ShapeType||(e.ShapeType={})),function(t){t.normal="normal",t.active="active",t.disabled="disabled"}(r||(r={})),e.normal={dotColor:"red",dotRadius:3,lineColor:"#c30",lineWidth:2,fillColor:"pink"},e.active={dotColor:"red",dotRadius:3,lineColor:"transparent",lineWidth:0,fillColor:"#c30"},e.disabled={dotColor:"#666",dotRadius:0,lineColor:"transparent",lineWidth:0,fillColor:"#666"};var o={normal:e.normal,active:e.active,disabled:e.disabled},a=function(t){function e(e){var r=t.call(this)||this,a=e.id,c=void 0===a?rr.IDG.getID():a,s=e.type,f=e.registerID,l=e.name,p=e.positions,d=e.data,v=e.active,h=void 0!==v&&v,g=e.closed,y=void 0===g||g,_=e.disabled,b=void 0!==_&&_,m=e.insert,w=void 0!==m&&m,S=e.visible,O=void 0===S||S,j=e.showTag,P=void 0===j||j,I=e.max,x=e.tag,E=void 0===x?l:x,C=e.style,T=void 0===C?{}:C;r.id=c,r.type=s,r.name=l,r.registerID=f,r.status=b?"disabled":h?"active":"normal",r.positions=p,r.data=d||null,r.style=i.default.merge({},o,T),r.closed=y,r.visible=O,r.insert=w,r.showTag=P,r.tag=E;var D=nr.create("div"),A=nr.create("div");return r.tagNode=function(){return D},r.tagBody=function(){return A},A.innerHTML=r.tag,nr.css(D,{position:"absolute",display:"inline-block",width:"200px",transformOrigin:"left"}),u(r.tagBody(),r.getStyle().dotColor),D.appendChild(A),r.max=I,r.type===n.Rect&&(r.insert=!1,2===p.length&&y&&(r.positions=er.getRectPoints(p[0],p[1]))),r}return Un.__extends(e,t),e.prototype.getPositions=function(){return this.positions||[]},e.prototype.isOnArc=function(t){var e=this.getPositions(),n=this.getStyle().dotRadius;return e.findIndex((function(e){return er.isInCircle(t,n,e)}))},e.prototype.isOnShape=function(t){return er.isInSide(t,this.getPositions())},e.prototype.isOnLine=function(t){var e=t[0],n=t[1],r=this.getPositions(),i=r[0];r.push(i);var o=null,a=[];r.forEach((function(t,e){var n={idx:e,position:t};o?(a.push([o,n]),o=n):o=n}));var u=a.filter((function(t){var r,i=t[0],o=t[1],a=i.position,u=a[0],c=a[1],s=o.position,f=s[0],l=s[1];return r=c===l?c-5<n&&n<c+5:c<l?c<n&&n<l:l<n&&n<c,(u===f?u-5<e&&e<u+5:u<f?u<e&&e<f:f<e&&e<u)&&r})).map((function(t){var r,i,o=t[0],a=t[1],u=o.position,c=u[0],s=u[1],f=a.position,l=f[0],p=f[1];if(p-s==0)r=e,i=s;else if(l-c==0)r=c,i=n;else{var d=(p-s)/(l-c),v=-d,h=n-v*e;i=v*(r=(h-(s-d*c))/(d-v))+h}return{idx:o.idx,position:[r,i]}})).map((function(e){var n=e.position;return{idx:e.idx,position:n,distance:er.getDistance(n,t)}})).sort((function(t,e){return t.distance-e.distance}))[0];return!!u&&(u.distance<5&&u)},e.prototype.getStyle=function(){return this.style[this.status]},e.prototype.setActive=function(t){return this.isDisabled()||(this.status=t?"active":"normal"),this},e.prototype.isActive=function(){return"active"===this.status},e.prototype.close=function(){return this.closed=!0,this},e.prototype.isClose=function(){return this.closed},e.prototype.disabled=function(){return this.status="disabled",u(this.tagBody(),this.getStyle().dotColor),this},e.prototype.isDisabled=function(){return"disabled"===this.status},e.prototype.normal=function(){return this.status="normal",u(this.tagBody(),this.getStyle().dotColor),this},e.prototype.hidden=function(){return this.visible=!1,this},e.prototype.show=function(){return this.visible=!0,this},e.prototype.isHidden=function(){return!this.visible},e.prototype.isInsert=function(){return this.insert},e.prototype.isShowTag=function(){return this.showTag&&!!this.tag&&this.isClose()},e.prototype.tagShow=function(t){this.showTag=i.default.isUndefined(t)?!this.showTag:!!t,u(this.tagBody(),this.getStyle().dotColor)},e.prototype.setTag=function(t){this.tag=t},e.prototype.updatePositions=function(t){return this.positions=t,this},e}(Zn.EventReceiver);function u(t,e){nr.css(t,{background:e,position:"absolute",bottom:"5px",display:"inline-block",color:"#fff",padding:"0 4px"})}e.Shape=a})),or=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeRegister=void 0;var n=function(){var t={};this.add=function(e,n){t[e]||(n.registerID=e,t[e]=n)},this.get=function(e){if(t[e])return Object.assign({},t[e]);throw"图形未注册"},this.is=function(e){return!!t[e]},this.getMap=function(){return Object.assign({},t)}};e.ShapeRegister=n})),ar=f((function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.EventEmitter=void 0,function(t){t.on="on",t.once="once"}(n||(n={}));var r=function(){function t(){var t={};this.getEvents=function(e){return t[e]||[]},this.createEvent=function(e,n){t[e]||(t[e]=[]),t[e].push(n)}}return t.prototype.emit=function(t,e){var n=this.getEvents(t);n.length&&n.forEach((function(t,r){var i=t.fn,o=t.type;i(e),"once"===o&&n.splice(r,1)}))},t.prototype.on=function(t,e){var n=this;return this.createEvent(t,{fn:e,type:"on"}),function(){var r=n.getEvents(t),i=r.findIndex((function(t){return t.fn===e}));i&&r&&r.splice(i,1)}},t.prototype.once=function(t,e){this.createEvent(t,{fn:e,type:"once"})},t}();e.EventEmitter=r})),ur=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Canvas=void 0;var n=function(){var t=this;this.line=function(e,n){if(e.length>1){var r=t.ctx(),i=null,o=n.lineColor,a=void 0===o?"":o,u=n.lineWidth,c=void 0===u?1:u,s=n.lineDash,f=void 0===s?[0]:s,l=r.getLineDash();r.beginPath(),r.strokeStyle=a,r.lineWidth=c,r.setLineDash(f),e.forEach((function(t){var e=t[0],n=t[1];i&&(r.moveTo(i[0],i[1]),r.lineTo(e,n)),i=[e,n]})),r.stroke(),r.setLineDash(l),r.closePath()}return t},this.fill=function(e,n){if(e.length>2){var r=t.ctx(),i=n.fillColor,o=void 0===i?"":i,a=n.opacity;r.beginPath();var u=t.el().style.opacity||1;e.forEach((function(t,e){var n=t[0],i=t[1];0===e?r.moveTo(n,i):r.lineTo(n,i)})),r.fillStyle=o,a&&t.opacity(a),r.fill(),r.closePath(),t.opacity(Number(u))}},this.fillReact=function(e,n,r){var i=t.ctx(),o=r.fillColor,a=void 0===o?"":o,u=r.opacity;i.beginPath();var c=t.el().style.opacity||1;return i.fillStyle=a,u&&t.opacity(u),i.fillRect.apply(i,Un.__spreadArrays(e,n)),i.closePath(),t.opacity(Number(c)),t},this.polygon=function(e,n){return t.fill(e,n),t.line(e,n),t.dots(e,n),t},this.dot=function(e,n){var r=t.ctx(),i=n.dotColor,o=void 0===i?"":i,a=n.dotRadius,u=void 0===a?1:a,c=e[0],s=e[1];return r.beginPath(),r.fillStyle=o,r.arc(c,s,u,0,2*Math.PI),r.fill(),r.closePath(),t},this.dots=function(e,n){e.forEach((function(e){t.dot(e,n)}))},this.opacity=function(e){t.ctx().globalAlpha=e},this.size=function(e,n){var r=t.el();r.width=e,r.height=n},this.getSize=function(){var e=t.el(),n=e.width,r=void 0===n?0:n,i=e.height;return[r,void 0===i?0:i]},this.cursor=function(e){t.el().style.cursor=e},this.clear=function(){var e=t.el(),n=e.width,r=e.height;t.ctx().clearRect(0,0,n,r)};var e=nr.create("canvas"),n=e.getContext("2d");this.el=function(){return e},this.ctx=function(){return n}};e.Canvas=n})),cr=f((function(t,e){var n;Object.defineProperty(e,"__esModule",{value:!0}),e.displayCursor=void 0,function(t){t.draggable="grab",t.default="",t.label="copy",t.drag="grabbing",t.pointer="pointer",t.disabled="disabled"}(n||(n={}));e.displayCursor=function(t){return n[t]}})),sr=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Platform=void 0;var n=Un.__importDefault(Qn),r={width:800,height:600,bgColor:"#000",tagShow:!0,guideLine:!1},i=function(t){function e(e,i){var o=t.call(this)||this;o.options=function(){return Object.assign({},o._options)},o.setOptions=function(t){o._options=n.default.merge(o._options,t),o.render()},o.reset=function(){o.scale=1,o.cache=null,o.activeShape=null,o.drawing=null,o.shapeList=[],o.tagContainer.innerHTML=""},o.resize=function(){o.Image&&o.Image.el&&(o.scale=er.getAdaptImgScale(o.Image.el,o.options()),o.Image.setOrigin([0,0]),o.render())},o._init=function(){if(!o._isInit){o._isInit=!0;var t,e,n,r,i=function(){var t=o._isShapeMoving;o._isMouseDown=!1,o._isShapeMoving=!1,t&&o.render()};t=o.canvas.el(),Zn.antMouseEvents.forEach((function(e){var n=o.Image;t.addEventListener(e,(function(t){t.preventDefault();var r=[t.offsetX,t.offsetY],a=er.isInSide(r,n.getPosition(o.scale)),u=function(){var t=null,e=-1,i=n.toImagePoint(r,o.scale);if(o.activeShape){var a=o.activeShape;-1!==(e=a.isOnArc(i))&&(t=a),a.isOnShape(i)&&(t=a)}if(!t)for(var u=o.shapeList.length;u>0;){var c=o.shapeList[u-1];if(-1!==(e=c.isOnArc(i))){t=c;break}if(c.isOnShape(i)){t=c;break}u--}return t&&t.isHidden()&&(t=null,e=-1),[t,e]},c=u()[0],s=o._isShapeMoving||!!c,f=s?c:a?n:null,l={offset:r,isOnImage:a,isOnShape:s,isPropagation:!0,stopPropagation:function(){l.isPropagation=!1},getTargetShape:u,currentTarget:f};switch(e){case"mousedown":o._isMouseDown=!0;break;case"mouseup":case"mouseout":case"mouseleave":i()}var p=t;p.ante=l,Zn.antLvs.forEach((function(t){if(s&&o.shapeList.forEach((function(n){for(var r=n.getEventsByType(e,t),i=r.length;i;){if(!p.ante.isPropagation){i=0;break}var o=r[i-1],a=o.callback,u=Un.__rest(o,["callback"]);f===n&&a(p,u),i--}})),a){p.ante.isPropagation=!0;for(var r=n.getEventsByType(e,t),i=r.length;i;){if(!p.ante.isPropagation){i=0;break}var u=r[i-1],c=u.callback,l=Un.__rest(u,["callback"]);c(p,l),i--}}p.ante.isPropagation=!0;for(var d=o.getEventsByType(e,t),v=d.length;v;){if(!p.ante.isPropagation){v=0;break}var h=d[v-1];c=h.callback,l=Un.__rest(h,["callback"]),c(p,l),v--}}))}))})),o.on("mousemove",(function(t){var e=t.ante;if(o.Image&&!o._isMouseDown){var n=e.currentTarget,r=e.offset;if(e.isOnShape&&n){var i=o.Image.toImagePoint(r,o.scale);-1!==n.isOnArc(i)?o.cursor("point"):n.isOnShape(i)&&o.cursor("pointer")}else o.drawing?o.cursor("point"):o.cursor("default")}})),o.on("mousemove","top",(function(t){o.options().guideLine&&(o._guideLineOrigin=t.ante.offset,o.render())})),e="top",n=[0,0],r=o.Image,o.on("mousedown",e,(function(t){var e=t.ante,i=e.offset,a=e.isOnImage;if(o.drawing&&r.el&&a){var u=r.toImagePoint(i,o.scale);n=u;var c=o.cache;if(c){if(o.drawing.type===ir.ShapeType.Polygon){var s=!1;if(c.positions.length>2){var f=c.positions[0],l=c.getStyle();s=er.isInCircle(u,l.dotRadius,f)}c.max&&c.positions.length+1>=c.max&&(c.positions.push(u),s=!0),s?((d=o.createShape(o.drawing.registerID,{positions:c.positions,closed:!1})).updatePositions(c.positions).close(),o.shapeList.push(d),o.cache=null,o.emitter.emit("create",d),o.continuity||o.labelOff()):c.positions.push(u)}}else{var p=[];o.drawing.type===ir.ShapeType.Polygon?p=[u]:o.drawing.type===ir.ShapeType.Rect&&(p=[u,u,u,u]);var d=o.createShape(o.drawing.registerID,{positions:p,closed:!1,id:"cache"});o.cache=d}console.log(o.cache),o.render()}})),o.on("mousemove",e,(function(t){var e=o.cache,r=o.Image;if(o.drawing&&r.complate&&e&&(o._isShapeMoving=!0,o.drawing.type===ir.ShapeType.Rect)){var i=t.ante.offset,a=r.toImagePoint(i,o.scale),u=er.getRectPoints(n,a);e.updatePositions(u),o.render()}})),o.on("mouseup",e,(function(){var t,e=o.cache,r=null===(t=o.drawing)||void 0===t?void 0:t.type;if(n=[0,0],r===ir.ShapeType.Rect&&e&&o.drawing){var i=e.getPositions(),a=o.createShape(o.drawing.registerID,{positions:i});a.close(),o.shapeList.push(a),o.emitter.emit("create",a),o.cache=null,o.continuity||o.labelOff(),o.render()}})),o.on("mouseout",e,(function(){})),function(){var t="top",e=[0,0],n=[],r=-1;o.on("mousedown",t,(function(t){var i=t.ante,a=i.getTargetShape,u=i.offset;e=u;var c=a(),s=c[0],f=c[1];o.drawing||s&&(s.isDisabled()?o.activeShape=null:(t.ante.stopPropagation(),r=f,n=s.getPositions(),o.activeShape!==s&&function(t){o.loseActive(),t.setActive(!0),o.activeShape=t,o.emitter.emit("select",t),o.render()}(s)))})),o.on("mousemove",t,(function(t){var i=t.offsetX,a=t.offsetY;if(t.ante.isOnShape&&o.activeShape&&!o.drawing&&o._isMouseDown){o._isShapeMoving=!0;var u=[i-e[0],a-e[1]],c=[];if(-1===r)c=n.map((function(t){var e=t[0],n=t[1];return[e+u[0]/o.scale,n+u[1]/o.scale]})),o.cursor("drag");else{var s=(c=n.slice())[r];if("Rect"===o.activeShape.type){switch(r){case 1:c[0]=[c[0][0],c[0][1]+u[1]/o.scale],c[2]=[c[2][0]+u[0]/o.scale,c[2][1]];break;case 3:c[0]=[c[0][0]+u[0]/o.scale,c[0][1]],c[2]=[c[2][0],c[2][1]+u[1]/o.scale];break;default:c[r]=[s[0]+u[0]/o.scale,s[1]+u[1]/o.scale]}c=er.getRectPoints(c[0],c[2])}else c[r]=[s[0]+u[0]/o.scale,s[1]+u[1]/o.scale]}o.activeShape.updatePositions(c),o._isMouseDown&&o.render()}})),o.on("mouseup",t,(function(t){e=[0,0],r=-1}))}(),function(){var t="bot",e=[0,0],n=o.Image;o.on("mousedown",t,(function(t){var r=t.ante,i=r.offset;if(!r.isOnShape&&n.complate){var o=i[0],a=i[1],u=n.getOrigin(),c=u[0],s=u[1];e=[o-c,a-s]}})),o.on("mousemove",t,(function(t){var r=t.ante,i=r.offset,a=r.isOnShape;if(o._isMouseDown&&!a&&!o.drawing){var u=i[0],c=i[1],s=[u-e[0],c-e[1]];n.setOrigin(s),o._isMouseDown&&o.render()}}));var r=function(){i(),e=[0,0]};o.on("mouseup",t,r),o.on("mouseout",t,r);n.on("wheel",(function(t){var e=o.Image;if(e.el){var n=t.deltaY<0?1:-1,r=o.canvas.getSize(),i=r[0],a=r[1],u=o.Image.getSize(o.scale),c=u[0],s=u[1],f=0;if(-1!==n||(.25*i>=c&&f++,.25*a>=s&&f++,2!==f)){var l=t.ante.offset,p=l[0],d=l[1],v=Number((.05*n+o.scale).toFixed(2));v<.01&&(v=.01);var h=e.getSize(),g=h[0],y=h[1],_=e.getOrigin(),b=_[0],m=_[1],w=g*o.scale,S=g*v,O=Math.abs(p-b),j=(p-b>0?-1:1)*(O*S/w-O)+b,P=y*o.scale,I=y*v,x=Math.abs(d-m),E=(d-m>0?-1:1)*(x*I/P-x)+m;e.setOrigin([j,E]),o.scale=v,o.render()}}}))}()}},o.load=function(t){return o.reset(),new Promise((function(e,n){o.Image.load(t).then((function(t){o.scale=er.getAdaptImgScale(t,o.options()),o.render(),e(t)}),(function(t){n(t)}))}))},o.register=function(t,e){o.shapeRegister.add(t,e)},o.createShape=function(t,e){var n=o.shapeRegister.get(t);return new ir.Shape(Object.assign(n,e))},o.isRegister=function(t){return o.shapeRegister.is(t)},o.label=function(t,e){var r=o.shapeRegister.get(t);(o.drawing&&r&&t!==o.drawing.id||!o.drawing&&r)&&(o.drawing=r,o.emitter.emit("labelType")),n.default.isUndefined(e)||(o.continuity=!!e)},o.getDrawing=function(){return o.drawing},o.addShape=function(t,e){"number"==typeof e?o.shapeList.splice(e,0,t):o.shapeList.push(t),o.render()},o.remove=function(t){var e=o.findShapeIndex(t),n=e[0],r=e[1];if(null!==n){var i=r.tagNode();o.tagContainer.contains(i)&&o.tagContainer.removeChild(i),o.shapeList.splice(n,1),o.render(),o.emitter.emit("update")}},o.setActive=function(t){o.loseActive(),t.setActive(!0),o.render()},o.labelOff=function(){o.drawing=null,o.continuity=!1,o.emitter.emit("labelType"),o.cache&&(o.cache=null,o.render())},o.orderShape=function(t,e){var n=o.findShapeIndex(t),r=n[0],i=n[1];null!==r&&(o.shapeList.splice(r,1),e?o.shapeList.unshift(i):o.shapeList.push(i))},o.findShapeIndex=function(t){var e=null;if(t instanceof ir.Shape){var n=t;e=o.shapeList.findIndex((function(t){return t===n}))}else if("string"==typeof t){var r=t;e=o.shapeList.findIndex((function(t){return t.id===r}))}return[e,null===e?null:o.shapeList[e]]},o.getShapeList=function(){return o.shapeList},o.getShapeByName=function(t){return o.shapeList.filter((function(e){return e.name===t}))},o.loseActive=function(){o.shapeList.forEach((function(t){t.setActive(!1)}))},o.setGuideLine=function(t){o.setOptions({guideLine:n.default.isUndefined(t)?!o.options().guideLine:!!t}),o.render()},o.isTagShow=function(){return o.options().tagShow},o.setTagShow=function(t){o.setOptions({tagShow:n.default.isUndefined(t)?!o.isTagShow:!!t}),o.render()},o.setContinuity=function(t){o.continuity=!!t},o.cursor=n.default.throttle((function(t){o.canvas.cursor(cr.displayCursor(t))}),100),o._clearCanvas=function(){o.canvas.clear()},o._renderBackground=function(){var t=o.options(),e=t.bgColor,n=t.width,r=t.height;o.canvas.fillReact([0,0],[n,r],{fillColor:e})},o._renderImage=function(){var t=o.canvas.ctx(),e=o.Image;if(e&&e.complate){var n=e.getEl(),r=e.getSize(),i=r[0],a=r[1],u=i*o.scale,c=a*o.scale,s=e.getOrigin(),f=s[0],l=s[1];t.drawImage(n,f,l,u,c)}},o._renderGuideLine=function(){var t=o._guideLineOrigin,e=t[0],n=t[1],r=o.options(),i=[5],a=[[0,n],[r.width,n]];o.canvas.line(a,{lineColor:"red",lineWidth:1,lineDash:i});var u=[[e,0],[e,r.height]];o.canvas.line(u,{lineColor:"red",lineWidth:1,lineDash:i})},o._renderShape=function(t){var e=o.Image;if(t.isHidden()){var n=t.tagNode();o.tagContainer.contains(n)&&o.tagContainer.removeChild(n)}else{var r=o.scale,i=t.positions,a=t.getStyle(),u=a.dotColor,c=a.dotRadius,s=a.lineColor,f=a.lineWidth,l=a.fillColor,p=e.getShape2CanvasPoints(i,r);if((t.isClose()||t.type===ir.ShapeType.Rect)&&p.push(p[0]),o.canvas.polygon(p,{lineColor:s,lineWidth:f*r,dotRadius:c*o.scale,dotColor:u,fillColor:l,opacity:.7}),o.isTagShow()&&t.isShowTag()&&!o._isShapeMoving&&!o.drawing){var d=p[0],v=d[0],h=d[1],g=o.scale;n=t.tagNode();o.tagContainer.contains(n)||o.tagContainer.appendChild(n),nr.css(n,{left:v+"px",top:h+"px",transform:"scale("+g+")"})}else{n=t.tagNode();o.tagContainer.contains(n)&&o.tagContainer.removeChild(n)}}},o._renderCache=function(){o.cache&&o._renderShape(o.cache)},o._renderShapeList=function(){var t=o.Image;if(t&&t.complate){var e=o.shapeList;if(e.length){var n=null;e.forEach((function(t){t.isActive()?n=t:o._renderShape(t)})),n&&o._renderShape(n)}}},o.forceRender=function(){o._clearCanvas(),o._renderBackground(),o._renderImage(),o._renderShapeList(),o._renderCache(),o.options().guideLine&&o._renderGuideLine()},o.render=n.default.throttle((function(){o.forceRender()}),17),o.container=e,nr.css(o.container,{position:"relative",overflow:"hidden"}),o._options=Object.assign({},i,r),o.emitter=new ar.EventEmitter,o.canvas=new ur.Canvas;var a=o.options();o.canvas.size(a.width,a.height),o.container.append(o.canvas.el());var u=nr.create("div");return o.tagContainer=u,o.container.appendChild(o.tagContainer),o.scale=1,o.continuity=!1,o._guideLineOrigin=[0,0],o.cache=null,o.activeShape=null,o.Image=new tr.Image,o.shapeRegister=new or.ShapeRegister,o.drawing=null,o.shapeList=[],o._isInit=!1,o._isMouseDown=!1,o._isShapeMoving=!1,o.render(),o._init(),o}return Un.__extends(e,t),e}(Zn.EventReceiver);e.Platform=i})),fr=Un.__importStar(er);return function(t){function e(e,n){return t.call(this,e,n)||this}return Un.__extends(e,t),e.Shape=ir.Shape,e.IDGenerator=rr.IDGenerator,e.utils=fr,e}(sr.Platform)}));
