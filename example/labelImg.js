/**!
 * label-img - v0.0.49
 * image annotation tool with javascript
 *
 * 2021-01-20 16:11:56
 * MIT (c) hold-baby
*/
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).LabelImg=e()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var t=function(e,n){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(e,n)};var e=function(){return(e=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t}).apply(this,arguments)};var n=Object.create?function(t,e,n,r){void 0===r&&(r=n),Object.defineProperty(t,r,{enumerable:!0,get:function(){return e[n]}})}:function(t,e,n,r){void 0===r&&(r=n),t[r]=e[n]};function r(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function o(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,o,i=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(t){o={error:t}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}function i(t){return this instanceof i?(this.v=t,this):new i(t)}var a=Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e};var u=Object.freeze({__proto__:null,__extends:function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},get __assign(){return e},__rest:function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)e.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(n[r[o]]=t[r[o]])}return n},__decorate:function(t,e,n,r){var o,i=arguments.length,a=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var u=t.length-1;u>=0;u--)(o=t[u])&&(a=(i<3?o(a):i>3?o(e,n,a):o(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},__param:function(t,e){return function(n,r){e(n,r,t)}},__metadata:function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},__awaiter:function(t,e,n,r){return new(n||(n=Promise))((function(o,i){function a(t){try{c(r.next(t))}catch(t){i(t)}}function u(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof n?e:new n((function(t){t(e)}))).then(a,u)}c((r=r.apply(t,e||[])).next())}))},__generator:function(t,e){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=e.call(t,a)}catch(t){i=[6,t],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}},__createBinding:n,__exportStar:function(t,e){for(var r in t)"default"===r||Object.prototype.hasOwnProperty.call(e,r)||n(e,t,r)},__values:r,__read:o,__spread:function(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(o(arguments[e]));return t},__spreadArrays:function(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;var r=Array(t),o=0;for(e=0;e<n;e++)for(var i=arguments[e],a=0,u=i.length;a<u;a++,o++)r[o]=i[a];return r},__await:i,__asyncGenerator:function(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,o=n.apply(t,e||[]),a=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(t){o[t]&&(r[t]=function(e){return new Promise((function(n,r){a.push([t,e,n,r])>1||c(t,e)}))})}function c(t,e){try{(n=o[t](e)).value instanceof i?Promise.resolve(n.value.v).then(s,f):l(a[0][2],n)}catch(t){l(a[0][3],t)}var n}function s(t){c("next",t)}function f(t){c("throw",t)}function l(t,e){t(e),a.shift(),a.length&&c(a[0][0],a[0][1])}},__asyncDelegator:function(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,o){e[r]=t[r]?function(e){return(n=!n)?{value:i(t[r](e)),done:"return"===r}:o?o(e):e}:o}},__asyncValues:function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=r(t),e={},o("next"),o("throw"),o("return"),e[Symbol.asyncIterator]=function(){return this},e);function o(n){e[n]=t[n]&&function(e){return new Promise((function(r,o){(function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)})(r,o,(e=t[n](e)).done,e.value)}))}}},__makeTemplateObject:function(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t},__importStar:function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&n(e,t,r);return a(e,t),e},__importDefault:function(t){return t&&t.__esModule?t:{default:t}},__classPrivateFieldGet:function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)},__classPrivateFieldSet:function(t,e,n){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,n),n}}),c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function s(t){if(t.__esModule)return t;var e=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(t).forEach((function(n){var r=Object.getOwnPropertyDescriptor(t,n);Object.defineProperty(e,n,r.get?r:{enumerable:!0,get:function(){return t[n]}})})),e}function f(t){var e={exports:{}};return t(e,e.exports),e.exports}var l=f((function(t,e){var n,r;Object.defineProperty(e,"__esModule",{value:!0}),e.EventReceiver=e.antLvs=e.AntLv=e.antMouseEvents=e.EAntMouseEvents=void 0,function(t){t.mousedown="mousedown",t.mouseenter="mouseenter",t.mouseleave="mouseleave",t.mousemove="mousemove",t.mouseout="mouseout",t.mouseover="mouseover",t.mouseup="mouseup",t.dblclick="dblclick",t.click="click",t.auxclick="auxclick",t.contextmenu="contextmenu",t.wheel="wheel"}(n=e.EAntMouseEvents||(e.EAntMouseEvents={})),e.antMouseEvents=Object.keys(n),function(t){t.top="top",t.mid="mid",t.bot=" bot"}(r=e.AntLv||(e.AntLv={})),e.antLvs=Object.keys(r);var o={},i=function(){function t(){this.getEventsByType=function(t,e){return o[t+"."+(e||"mid")]||[]}}return t.prototype.on=function(t,e){var n=t.split("."),r=n[0],i=n[1],a=void 0===i?"mid":i,u=r+"."+a,c={lv:a,type:r,callback:e,target:this};o[u]?o[u].push(c):o[u]=[c]},t}();e.EventReceiver=i})),p=s(u),d=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Image=void 0;var n=[0,0],r=function(t){function e(e){var r=t.call(this)||this;return r.origin=e||n,r.complate=!1,r.el=null,r}return p.__extends(e,t),e.prototype.load=function(t){var e=this;return this.origin=n,new Promise((function(n,r){e.complate=!1;var o=document.createElement("img");new Promise((function(e,n){var r=t;if(t instanceof File){var o=new FileReader;o.readAsDataURL(t),o.onload=function(t){var n;r=null===(n=t.target)||void 0===n?void 0:n.result,e(r)},o.onerror=function(){throw n(),"图片加载错误"}}else"string"==typeof t&&e(r)})).then((function(t){o.src=t,o.onload=function(){e.complate=!0,e.el=o,n(o)},o.onerror=function(){throw r(),"图片加载错误"}}))}))},e.prototype.getEl=function(){return this.el},e.prototype.getSize=function(){if(this.el){var t=this.el;return[t.width,t.height]}return n},e.prototype.getOrigin=function(){return this.origin.slice()},e.prototype.getPosition=function(t){void 0===t&&(t=1);var e=this.getSize(),n=e[0]*t,r=e[1]*t,o=this.origin,i=o[0],a=o[1];return[this.origin,[i+n,a],[i+n,a+r],[i,a+r]]},e.prototype.toImagePoint=function(t,e){var n=t[0],r=t[1],o=this.origin;return[(n-o[0])/e,(r-o[1])/e]},e.prototype.getShape2CanvasPoints=function(t,e){var n=this.getOrigin(),r=n[0],o=n[1];return t.map((function(t){var n=t[0],i=t[1];return[r+n*e,o+i*e]}))},e.prototype.setOrigin=function(t){this.origin=t},e}(l.EventReceiver);e.Image=r})),v=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.getAdaptImgScale=e.isInCircle=e.getDistance=e.getRectPoints=e.isInSide=void 0;e.isInSide=function(t,e){for(var n=t[0],r=t[1],o=!1,i=0,a=e.length-1;i<e.length;a=i++){var u=e[i][0],c=e[i][1],s=e[a][0],f=e[a][1];c>r!=f>r&&n<(s-u)*(r-c)/(f-c)+u&&(o=!o)}return o};e.getRectPoints=function(t,e){return[t,[e[0],t[1]],e,[t[0],e[1]]]};e.getDistance=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],o=Math.pow(n,2),i=Math.pow(r,2);return Math.abs(Math.sqrt(o+i))};e.isInCircle=function(t,n,r){return e.getDistance(t,r)<n};e.getAdaptImgScale=function(t,e){var n=t.width,r=t.height,o=1;return(e.width<n||e.height<r)&&(o=n>r?e.width/n:e.height/r),o}})),h=Math.floor;var g=function(t,e){var n="";if(!t||e<1||e>9007199254740991)return n;do{e%2&&(n+=t),(e=h(e/2))&&(t+=t)}while(e);return n},y="object"==typeof c&&c&&c.Object===Object&&c,b="object"==typeof self&&self&&self.Object===Object&&self,_=y||b||Function("return this")(),m=_.Symbol;var w=function(t,e){for(var n=-1,r=null==t?0:t.length,o=Array(r);++n<r;)o[n]=e(t[n],n,t);return o},S=Array.isArray,j=Object.prototype,O=j.hasOwnProperty,P=j.toString,I=m?m.toStringTag:void 0;var x=function(t){var e=O.call(t,I),n=t[I];try{t[I]=void 0;var r=!0}catch(t){}var o=P.call(t);return r&&(e?t[I]=n:delete t[I]),o},T=Object.prototype.toString;var A=function(t){return T.call(t)},E=m?m.toStringTag:void 0;var k=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":E&&E in Object(t)?x(t):A(t)};var C=function(t){return null!=t&&"object"==typeof t};var R=function(t){return"symbol"==typeof t||C(t)&&"[object Symbol]"==k(t)},D=m?m.prototype:void 0,L=D?D.toString:void 0;var M=function t(e){if("string"==typeof e)return e;if(S(e))return w(e,t)+"";if(R(e))return L?L.call(e):"";var n=e+"";return"0"==n&&1/e==-Infinity?"-0":n};var z=function(t,e,n){var r=-1,o=t.length;e<0&&(e=-e>o?0:o+e),(n=n>o?o:n)<0&&(n+=o),o=e>n?0:n-e>>>0,e>>>=0;for(var i=Array(o);++r<o;)i[r]=t[r+e];return i};var B=function(t,e,n){var r=t.length;return n=void 0===n?r:n,!e&&n>=r?t:z(t,e,n)},F=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var H=function(t){return F.test(t)};var G=function(t){return function(e){return null==e?void 0:e[t]}}("length"),N="[\\ud800-\\udfff]",U="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",$="\\ud83c[\\udffb-\\udfff]",W="[^\\ud800-\\udfff]",q="(?:\\ud83c[\\udde6-\\uddff]){2}",Y="[\\ud800-\\udbff][\\udc00-\\udfff]",V="(?:"+U+"|"+$+")"+"?",X="[\\ufe0e\\ufe0f]?",J=X+V+("(?:\\u200d(?:"+[W,q,Y].join("|")+")"+X+V+")*"),K="(?:"+[W+U+"?",U,q,Y,N].join("|")+")",Q=RegExp($+"(?="+$+")|"+K+J,"g");var Z=function(t){for(var e=Q.lastIndex=0;Q.test(t);)++e;return e};var tt=function(t){return H(t)?Z(t):G(t)};var et=function(t){return t.split("")},nt="[\\ud800-\\udfff]",rt="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ot="\\ud83c[\\udffb-\\udfff]",it="[^\\ud800-\\udfff]",at="(?:\\ud83c[\\udde6-\\uddff]){2}",ut="[\\ud800-\\udbff][\\udc00-\\udfff]",ct="(?:"+rt+"|"+ot+")"+"?",st="[\\ufe0e\\ufe0f]?",ft=st+ct+("(?:\\u200d(?:"+[it,at,ut].join("|")+")"+st+ct+")*"),lt="(?:"+[it+rt+"?",rt,at,ut,nt].join("|")+")",pt=RegExp(ot+"(?="+ot+")|"+lt+ft,"g");var dt=function(t){return t.match(pt)||[]};var vt=function(t){return H(t)?dt(t):et(t)},ht=Math.ceil;var gt=function(t,e){var n=(e=void 0===e?" ":M(e)).length;if(n<2)return n?g(e,t):e;var r=g(e,ht(t/tt(e)));return H(e)?B(vt(r),0,t).join(""):r.slice(0,t)};var yt=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)},bt=/^\s+|\s+$/g,_t=/^[-+]0x[0-9a-f]+$/i,mt=/^0b[01]+$/i,wt=/^0o[0-7]+$/i,St=parseInt;var jt=function(t){if("number"==typeof t)return t;if(R(t))return NaN;if(yt(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=yt(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(bt,"");var n=mt.test(t);return n||wt.test(t)?St(t.slice(2),n?2:8):_t.test(t)?NaN:+t},Ot=1/0;var Pt=function(t){return t?(t=jt(t))===Ot||t===-1/0?17976931348623157e292*(t<0?-1:1):t==t?t:0:0===t?t:0};var It=function(t){var e=Pt(t),n=e%1;return e==e?n?e-n:e:0};var xt=function(t){return null==t?"":M(t)};var Tt=function(t,e,n){t=xt(t);var r=(e=It(e))?tt(t):0;return e&&r<e?gt(e-r,n)+t:t};var At=function(){this.__data__=[],this.size=0};var Et=function(t,e){return t===e||t!=t&&e!=e};var kt=function(t,e){for(var n=t.length;n--;)if(Et(t[n][0],e))return n;return-1},Ct=Array.prototype.splice;var Rt=function(t){var e=this.__data__,n=kt(e,t);return!(n<0)&&(n==e.length-1?e.pop():Ct.call(e,n,1),--this.size,!0)};var Dt=function(t){var e=this.__data__,n=kt(e,t);return n<0?void 0:e[n][1]};var Lt=function(t){return kt(this.__data__,t)>-1};var Mt=function(t,e){var n=this.__data__,r=kt(n,t);return r<0?(++this.size,n.push([t,e])):n[r][1]=e,this};function zt(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}zt.prototype.clear=At,zt.prototype.delete=Rt,zt.prototype.get=Dt,zt.prototype.has=Lt,zt.prototype.set=Mt;var Bt=zt;var Ft=function(){this.__data__=new Bt,this.size=0};var Ht=function(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n};var Gt=function(t){return this.__data__.get(t)};var Nt=function(t){return this.__data__.has(t)};var Ut,$t=function(t){if(!yt(t))return!1;var e=k(t);return"[object Function]"==e||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e},Wt=_["__core-js_shared__"],qt=(Ut=/[^.]+$/.exec(Wt&&Wt.keys&&Wt.keys.IE_PROTO||""))?"Symbol(src)_1."+Ut:"";var Yt=function(t){return!!qt&&qt in t},Vt=Function.prototype.toString;var Xt=function(t){if(null!=t){try{return Vt.call(t)}catch(t){}try{return t+""}catch(t){}}return""},Jt=/^\[object .+?Constructor\]$/,Kt=Function.prototype,Qt=Object.prototype,Zt=Kt.toString,te=Qt.hasOwnProperty,ee=RegExp("^"+Zt.call(te).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var ne=function(t){return!(!yt(t)||Yt(t))&&($t(t)?ee:Jt).test(Xt(t))};var re=function(t,e){return null==t?void 0:t[e]};var oe=function(t,e){var n=re(t,e);return ne(n)?n:void 0},ie=oe(_,"Map"),ae=oe(Object,"create");var ue=function(){this.__data__=ae?ae(null):{},this.size=0};var ce=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},se=Object.prototype.hasOwnProperty;var fe=function(t){var e=this.__data__;if(ae){var n=e[t];return"__lodash_hash_undefined__"===n?void 0:n}return se.call(e,t)?e[t]:void 0},le=Object.prototype.hasOwnProperty;var pe=function(t){var e=this.__data__;return ae?void 0!==e[t]:le.call(e,t)};var de=function(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=ae&&void 0===e?"__lodash_hash_undefined__":e,this};function ve(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}ve.prototype.clear=ue,ve.prototype.delete=ce,ve.prototype.get=fe,ve.prototype.has=pe,ve.prototype.set=de;var he=ve;var ge=function(){this.size=0,this.__data__={hash:new he,map:new(ie||Bt),string:new he}};var ye=function(t){var e=typeof t;return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t};var be=function(t,e){var n=t.__data__;return ye(e)?n["string"==typeof e?"string":"hash"]:n.map};var _e=function(t){var e=be(this,t).delete(t);return this.size-=e?1:0,e};var me=function(t){return be(this,t).get(t)};var we=function(t){return be(this,t).has(t)};var Se=function(t,e){var n=be(this,t),r=n.size;return n.set(t,e),this.size+=n.size==r?0:1,this};function je(t){var e=-1,n=null==t?0:t.length;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}je.prototype.clear=ge,je.prototype.delete=_e,je.prototype.get=me,je.prototype.has=we,je.prototype.set=Se;var Oe=je;var Pe=function(t,e){var n=this.__data__;if(n instanceof Bt){var r=n.__data__;if(!ie||r.length<199)return r.push([t,e]),this.size=++n.size,this;n=this.__data__=new Oe(r)}return n.set(t,e),this.size=n.size,this};function Ie(t){var e=this.__data__=new Bt(t);this.size=e.size}Ie.prototype.clear=Ft,Ie.prototype.delete=Ht,Ie.prototype.get=Gt,Ie.prototype.has=Nt,Ie.prototype.set=Pe;var xe=Ie,Te=function(){try{var t=oe(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();var Ae=function(t,e,n){"__proto__"==e&&Te?Te(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n};var Ee=function(t,e,n){(void 0!==n&&!Et(t[e],n)||void 0===n&&!(e in t))&&Ae(t,e,n)};var ke=function(t){return function(e,n,r){for(var o=-1,i=Object(e),a=r(e),u=a.length;u--;){var c=a[t?u:++o];if(!1===n(i[c],c,i))break}return e}}(),Ce=f((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,o=r&&r.exports===n?_.Buffer:void 0,i=o?o.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();var n=t.length,r=i?i(n):new t.constructor(n);return t.copy(r),r}})),Re=_.Uint8Array;var De=function(t){var e=new t.constructor(t.byteLength);return new Re(e).set(new Re(t)),e};var Le=function(t,e){var n=e?De(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)};var Me=function(t,e){var n=-1,r=t.length;for(e||(e=Array(r));++n<r;)e[n]=t[n];return e},ze=Object.create,Be=function(){function t(){}return function(e){if(!yt(e))return{};if(ze)return ze(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();var Fe=function(t,e){return function(n){return t(e(n))}}(Object.getPrototypeOf,Object),He=Object.prototype;var Ge=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||He)};var Ne=function(t){return"function"!=typeof t.constructor||Ge(t)?{}:Be(Fe(t))};var Ue=function(t){return C(t)&&"[object Arguments]"==k(t)},$e=Object.prototype,We=$e.hasOwnProperty,qe=$e.propertyIsEnumerable,Ye=Ue(function(){return arguments}())?Ue:function(t){return C(t)&&We.call(t,"callee")&&!qe.call(t,"callee")};var Ve=function(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991};var Xe=function(t){return null!=t&&Ve(t.length)&&!$t(t)};var Je=function(t){return C(t)&&Xe(t)};var Ke=function(){return!1},Qe=f((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,o=r&&r.exports===n?_.Buffer:void 0,i=(o?o.isBuffer:void 0)||Ke;t.exports=i})),Ze=Function.prototype,tn=Object.prototype,en=Ze.toString,nn=tn.hasOwnProperty,rn=en.call(Object);var on=function(t){if(!C(t)||"[object Object]"!=k(t))return!1;var e=Fe(t);if(null===e)return!0;var n=nn.call(e,"constructor")&&e.constructor;return"function"==typeof n&&n instanceof n&&en.call(n)==rn},an={};an["[object Float32Array]"]=an["[object Float64Array]"]=an["[object Int8Array]"]=an["[object Int16Array]"]=an["[object Int32Array]"]=an["[object Uint8Array]"]=an["[object Uint8ClampedArray]"]=an["[object Uint16Array]"]=an["[object Uint32Array]"]=!0,an["[object Arguments]"]=an["[object Array]"]=an["[object ArrayBuffer]"]=an["[object Boolean]"]=an["[object DataView]"]=an["[object Date]"]=an["[object Error]"]=an["[object Function]"]=an["[object Map]"]=an["[object Number]"]=an["[object Object]"]=an["[object RegExp]"]=an["[object Set]"]=an["[object String]"]=an["[object WeakMap]"]=!1;var un=function(t){return C(t)&&Ve(t.length)&&!!an[k(t)]};var cn=function(t){return function(e){return t(e)}},sn=f((function(t,e){var n=e&&!e.nodeType&&e,r=n&&t&&!t.nodeType&&t,o=r&&r.exports===n&&y.process,i=function(){try{var t=r&&r.require&&r.require("util").types;return t||o&&o.binding&&o.binding("util")}catch(t){}}();t.exports=i})),fn=sn&&sn.isTypedArray,ln=fn?cn(fn):un;var pn=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]},dn=Object.prototype.hasOwnProperty;var vn=function(t,e,n){var r=t[e];dn.call(t,e)&&Et(r,n)&&(void 0!==n||e in t)||Ae(t,e,n)};var hn=function(t,e,n,r){var o=!n;n||(n={});for(var i=-1,a=e.length;++i<a;){var u=e[i],c=r?r(n[u],t[u],u,n,t):void 0;void 0===c&&(c=t[u]),o?Ae(n,u,c):vn(n,u,c)}return n};var gn=function(t,e){for(var n=-1,r=Array(t);++n<t;)r[n]=e(n);return r},yn=/^(?:0|[1-9]\d*)$/;var bn=function(t,e){var n=typeof t;return!!(e=null==e?9007199254740991:e)&&("number"==n||"symbol"!=n&&yn.test(t))&&t>-1&&t%1==0&&t<e},_n=Object.prototype.hasOwnProperty;var mn=function(t,e){var n=S(t),r=!n&&Ye(t),o=!n&&!r&&Qe(t),i=!n&&!r&&!o&&ln(t),a=n||r||o||i,u=a?gn(t.length,String):[],c=u.length;for(var s in t)!e&&!_n.call(t,s)||a&&("length"==s||o&&("offset"==s||"parent"==s)||i&&("buffer"==s||"byteLength"==s||"byteOffset"==s)||bn(s,c))||u.push(s);return u};var wn=function(t){var e=[];if(null!=t)for(var n in Object(t))e.push(n);return e},Sn=Object.prototype.hasOwnProperty;var jn=function(t){if(!yt(t))return wn(t);var e=Ge(t),n=[];for(var r in t)("constructor"!=r||!e&&Sn.call(t,r))&&n.push(r);return n};var On=function(t){return Xe(t)?mn(t,!0):jn(t)};var Pn=function(t){return hn(t,On(t))};var In=function(t,e,n,r,o,i,a){var u=pn(t,n),c=pn(e,n),s=a.get(c);if(s)Ee(t,n,s);else{var f=i?i(u,c,n+"",t,e,a):void 0,l=void 0===f;if(l){var p=S(c),d=!p&&Qe(c),v=!p&&!d&&ln(c);f=c,p||d||v?S(u)?f=u:Je(u)?f=Me(u):d?(l=!1,f=Ce(c,!0)):v?(l=!1,f=Le(c,!0)):f=[]:on(c)||Ye(c)?(f=u,Ye(u)?f=Pn(u):yt(u)&&!$t(u)||(f=Ne(c))):l=!1}l&&(a.set(c,f),o(f,c,r,i,a),a.delete(c)),Ee(t,n,f)}};var xn=function t(e,n,r,o,i){e!==n&&ke(n,(function(a,u){if(i||(i=new xe),yt(a))In(e,n,u,r,t,o,i);else{var c=o?o(pn(e,u),a,u+"",e,n,i):void 0;void 0===c&&(c=a),Ee(e,u,c)}}),On)};var Tn=function(t){return t};var An=function(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)},En=Math.max;var kn=function(t,e,n){return e=En(void 0===e?t.length-1:e,0),function(){for(var r=arguments,o=-1,i=En(r.length-e,0),a=Array(i);++o<i;)a[o]=r[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=r[o];return u[e]=n(a),An(t,this,u)}};var Cn=function(t){return function(){return t}},Rn=Te?function(t,e){return Te(t,"toString",{configurable:!0,enumerable:!1,value:Cn(e),writable:!0})}:Tn,Dn=Date.now;var Ln=function(t){var e=0,n=0;return function(){var r=Dn(),o=16-(r-n);if(n=r,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(Rn);var Mn=function(t,e){return Ln(kn(t,e,Tn),t+"")};var zn=function(t,e,n){if(!yt(n))return!1;var r=typeof e;return!!("number"==r?Xe(n)&&bn(e,n.length):"string"==r&&e in n)&&Et(n[e],t)};var Bn=function(t){return Mn((function(e,n){var r=-1,o=n.length,i=o>1?n[o-1]:void 0,a=o>2?n[2]:void 0;for(i=t.length>3&&"function"==typeof i?(o--,i):void 0,a&&zn(n[0],n[1],a)&&(i=o<3?void 0:i,o=1),e=Object(e);++r<o;){var u=n[r];u&&t(e,u,r,i)}return e}))}((function(t,e,n){xn(t,e,n)}));var Fn=function(t){return void 0===t};var Hn=function(t){return"string"==typeof t||!S(t)&&C(t)&&"[object String]"==k(t)},Gn=function(){return _.Date.now()},Nn=Math.max,Un=Math.min;var $n=function(t,e,n){var r,o,i,a,u,c,s=0,f=!1,l=!1,p=!0;if("function"!=typeof t)throw new TypeError("Expected a function");function d(e){var n=r,i=o;return r=o=void 0,s=e,a=t.apply(i,n)}function v(t){return s=t,u=setTimeout(g,e),f?d(t):a}function h(t){var n=t-c;return void 0===c||n>=e||n<0||l&&t-s>=i}function g(){var t=Gn();if(h(t))return y(t);u=setTimeout(g,function(t){var n=e-(t-c);return l?Un(n,i-(t-s)):n}(t))}function y(t){return u=void 0,p&&r?d(t):(r=o=void 0,a)}function b(){var t=Gn(),n=h(t);if(r=arguments,o=this,c=t,n){if(void 0===u)return v(c);if(l)return clearTimeout(u),u=setTimeout(g,e),d(c)}return void 0===u&&(u=setTimeout(g,e)),a}return e=jt(e)||0,yt(n)&&(f=!!n.leading,i=(l="maxWait"in n)?Nn(jt(n.maxWait)||0,e):i,p="trailing"in n?!!n.trailing:p),b.cancel=function(){void 0!==u&&clearTimeout(u),s=0,r=c=o=u=void 0},b.flush=function(){return void 0===u?a:y(Gn())},b};var Wn=function(t,e,n){var r=!0,o=!0;if("function"!=typeof t)throw new TypeError("Expected a function");return yt(n)&&(r="leading"in n?!!n.leading:r,o="trailing"in n?!!n.trailing:o),$n(t,e,{leading:r,maxWait:e,trailing:o})},qn=p.__importDefault(Tt),Yn=p.__importDefault(Bn),Vn=p.__importDefault(Fn),Xn=p.__importDefault(Hn),Jn=p.__importDefault(yt),Kn=p.__importDefault(S),Qn=p.__importDefault(Wn),Zn={isUndefined:Vn.default,padStart:qn.default,merge:Yn.default,isString:Xn.default,isObject:Jn.default,isArray:Kn.default,throttle:Qn.default},tr=Object.defineProperty({default:Zn},"__esModule",{value:!0}),er=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.css=e.create=void 0;var n=p.__importDefault(tr);e.create=function(t){return document.createElement(t)};e.css=function(t,e,r){if(n.default.isString(e)){if(!r)return t.style[e];!function(t,e,n){t.style[e]=n}(t,e,r)}else n.default.isObject(e)&&function(t,e){n.default.merge(t.style,e)}(t,e)}})),nr=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.IDG=e.IDGenerator=void 0;var n=p.__importDefault(tr),r=0,o=function(){function t(t){var e=t||{},n=e.len,o=void 0===n?8:n,i=e.start;r=void 0===i?1:i,this.len=o}return t.prototype.getID=function(){var t=n.default.padStart(String(r),this.len,"0");return r++,t},t}();e.IDGenerator=o,e.IDG=new o})),rr=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Shape=e.disabled=e.active=e.normal=e.ShapeType=void 0;var n,r,o=p.__importDefault(tr);!function(t){t.Polygon="Polygon",t.Rect="Rect"}(n=e.ShapeType||(e.ShapeType={})),function(t){t.normal="normal",t.active="active",t.disabled="disabled"}(r||(r={})),e.normal={dotColor:"red",dotRadius:3,lineColor:"#c30",lineWidth:2,fillColor:"pink"},e.active={dotColor:"red",dotRadius:3,lineColor:"transparent",lineWidth:0,fillColor:"#c30"},e.disabled={dotColor:"#666",dotRadius:0,lineColor:"transparent",lineWidth:0,fillColor:"#666"};var i={normal:e.normal,active:e.active,disabled:e.disabled},a=function(t){function e(e){var r=t.call(this)||this,a=e.id,c=void 0===a?nr.IDG.getID():a,s=e.type,f=e.registerID,l=e.name,p=e.positions,d=e.data,h=e.active,g=void 0!==h&&h,y=e.closed,b=void 0===y||y,_=e.disabled,m=void 0!==_&&_,w=e.insert,S=void 0!==w&&w,j=e.visible,O=void 0===j||j,P=e.showTag,I=void 0===P||P,x=e.max,T=e.tag,A=void 0===T?l:T,E=e.style,k=void 0===E?{}:E;r.id=c,r.type=s,r.name=l,r.registerID=f,r.status=m?"disabled":g?"active":"normal",r.positions=p,r.data=d||null,r.style=o.default.merge(i,k),r.closed=b,r.visible=O,r.insert=S,r.showTag=I,r.tag=A;var C=er.create("div"),R=er.create("div");return r.tagNode=function(){return C},r.tagBody=function(){return R},R.innerHTML=r.tag,er.css(C,{position:"absolute",display:"inline-block",width:"200px",transformOrigin:"left"}),u(r.tagBody(),r.getStyle().dotColor),C.appendChild(R),r.max=x,r.type===n.Rect&&(r.insert=!1,2===p.length&&b&&(r.positions=v.getRectPoints(p[0],p[1]))),r}return p.__extends(e,t),e.prototype.getPositions=function(){return this.positions||[]},e.prototype.isOnArc=function(t){var e=this.getPositions(),n=this.getStyle().dotRadius;return e.findIndex((function(e){return v.isInCircle(t,n,e)}))},e.prototype.isOnShape=function(t){return v.isInSide(t,this.getPositions())},e.prototype.isOnLine=function(t){var e=t[0],n=t[1],r=this.getPositions(),o=r[0];r.push(o);var i=null,a=[];r.forEach((function(t,e){var n={idx:e,position:t};i?(a.push([i,n]),i=n):i=n}));var u=a.filter((function(t){var r,o=t[0],i=t[1],a=o.position,u=a[0],c=a[1],s=i.position,f=s[0],l=s[1];return r=c===l?c-5<n&&n<c+5:c<l?c<n&&n<l:l<n&&n<c,(u===f?u-5<e&&e<u+5:u<f?u<e&&e<f:f<e&&e<u)&&r})).map((function(t){var r,o,i=t[0],a=t[1],u=i.position,c=u[0],s=u[1],f=a.position,l=f[0],p=f[1];if(p-s==0)r=e,o=s;else if(l-c==0)r=c,o=n;else{var d=(p-s)/(l-c),v=-d,h=n-v*e;o=v*(r=(h-(s-d*c))/(d-v))+h}return{idx:i.idx,position:[r,o]}})).map((function(e){var n=e.position;return{idx:e.idx,position:n,distance:v.getDistance(n,t)}})).sort((function(t,e){return t.distance-e.distance}))[0];return!!u&&(u.distance<5&&u)},e.prototype.getStyle=function(){return this.style[this.status]},e.prototype.setActive=function(t){return this.isDisabled()||(this.status=t?"active":"normal"),this},e.prototype.isActive=function(){return"active"===this.status},e.prototype.close=function(){return this.closed=!0,this},e.prototype.isClose=function(){return this.closed},e.prototype.disabled=function(){return this.status="disabled",u(this.tagBody(),this.getStyle().dotColor),this},e.prototype.isDisabled=function(){return"disabled"===this.status},e.prototype.normal=function(){return this.status="normal",u(this.tagBody(),this.getStyle().dotColor),this},e.prototype.hidden=function(){return this.visible=!1,this},e.prototype.show=function(){return this.visible=!0,this},e.prototype.isHidden=function(){return!this.visible},e.prototype.isInsert=function(){return this.insert},e.prototype.isShowTag=function(){return this.showTag&&!!this.tag&&this.isClose()},e.prototype.tagShow=function(t){this.showTag=void 0===t?!this.showTag:!!t,u(this.tagBody(),this.getStyle().dotColor)},e.prototype.setTag=function(t){this.tag=t},e.prototype.updatePositions=function(t){return this.positions=t,this},e}(l.EventReceiver);function u(t,e){er.css(t,{background:e,position:"absolute",bottom:"5px",display:"inline-block",color:"#fff",padding:"0 4px"})}e.Shape=a})),or=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.ShapeRegister=void 0;var n=function(){function t(){this.shapeMap={}}return t.prototype.add=function(t,e){this.shapeMap[t]||(e.registerID=t,this.shapeMap[t]=e)},t.prototype.get=function(t){if(this.shapeMap[t])return Object.assign({},this.shapeMap[t]);throw"图形未注册"},t.prototype.is=function(t){return!!this.shapeMap[t]},t}();e.ShapeRegister=n})),ir=f((function(t,e){var n,r;Object.defineProperty(e,"__esModule",{value:!0}),e.EventHook=void 0,function(t){t.select="select",t.create="create",t.update="update",t.labelType="labelType"}(n||(n={})),function(t){t.on="on",t.once="once"}(r||(r={}));var o={},i=function(){function t(){}return t.prototype.trigger=function(t,e){var n=o[t];n&&n.forEach((function(t,r){var o=t.fn,i=t.type;o(e),"once"===i&&n.splice(r,1)}))},t.prototype.on=function(t,e){return o[t]||(o[t]=[]),o[t].push({fn:e,type:"on"}),function(){var n,r=null===(n=o[t])||void 0===n?void 0:n.findIndex((function(t){return t.fn===e}));r&&o[t]&&o[t].splice(r,1)}},t.prototype.once=function(t,e){o[t]||(o[t]=[]),o[t].push({fn:e,type:"once"})},t.prototype.config=function(t){Object.assign(o,t)},t}();e.EventHook=i})),ar=f((function(t,e){Object.defineProperty(e,"__esModule",{value:!0}),e.Platform=void 0;var n,r=p.__importDefault(tr),o={width:800,height:600,bgColor:"#000",tagShow:!0,guideLine:!1},i=Object.assign({},o);!function(t){t.draggable="grab",t.default="",t.point="crosshair",t.drag="grabbing",t.pointer="pointer",t.disabled="disabled"}(n||(n={}));var a=!1,u=!1,c=!1,s=!1,f=function(){u=!1,c=!1},h=function(t){function e(e,h){var g=t.call(this)||this;g.reset=function(){g.scale=1,g.offset=[0,0],g.cache=null,g.activeShape=null,g.drawing=null,g.shapeList=[],g.tagContainer.innerHTML=""},g.resize=function(){g.Image&&g.Image.el&&(g.scale=v.getAdaptImgScale(g.Image.el,i),g.Image.setOrigin([0,0]),g.render())},g._init=function(){if(!a){a=!0;var t,e;l.antMouseEvents.forEach((function(t){var e=g.Image;g.canvas.addEventListener(t,(function(n){n.preventDefault();var r=[n.offsetX,n.offsetY];s=v.isInSide(r,e.getPosition(g.scale));var o=function(){var t=null,n=-1,o=e.toImagePoint(r,g.scale);if(g.activeShape&&(-1!==(n=(a=g.activeShape).isOnArc(o))&&(t=a),a.isOnShape(o)&&(t=a)),!t)for(var i=g.shapeList.length;i>0;){var a;if(-1!==(n=(a=g.shapeList[i-1]).isOnArc(o))){t=a;break}if(a.isOnShape(o)){t=a;break}i--}return t&&t.isHidden()&&(t=null,n=-1),[t,n]},i=o()[0];c=u?c:!!i;var a={offset:r,isPropagation:!0,stopPropagation:function(){a.isPropagation=!1},getTargetShape:o,currentTarget:i};switch(t){case"mousedown":u=!0;break;case"mouseup":case"mouseout":case"mouseleave":f()}var d=n;d.ante=a,l.antLvs.forEach((function(n){g.shapeList.forEach((function(e){for(var r=e.getEventsByType(t,n),o=r.length;o;){if(!d.ante.isPropagation){o=0;break}var a=r[o-1],u=a.callback,c=p.__rest(a,["callback"]);i===e&&u(d,c),o--}})),d.ante.isPropagation=!0;for(var r=e.getEventsByType(t,n),o=r.length;o;){if(!d.ante.isPropagation){o=0;break}var a=r[o-1],u=a.callback,c=p.__rest(a,["callback"]);u(d,c),o--}d.ante.isPropagation=!0;for(var s=g.getEventsByType(t,n),f=s.length;f;){if(!d.ante.isPropagation){f=0;break}var l=s[f-1];u=l.callback,c=p.__rest(l,["callback"]),u(d,c),f--}}))}))})),g.on("mousemove",(function(t){var e=t.ante;if(g.Image&&!u){var n=e.currentTarget,r=e.offset;if(n){var o=g.Image.toImagePoint(r,g.scale);-1!==n.isOnArc(o)?g.cursor("point"):n.isOnShape(o)&&g.cursor("pointer")}else g.drawing?g.cursor("point"):g.cursor("default")}})),g.on("mousemove.top",(function(t){g.offset=t.ante.offset,g.render()})),t=[0,0],e=g.Image,g.on("mousedown.top",(function(n){if(g.drawing&&e.el){var r=n.ante.offset;if(s){var o=e.toImagePoint(r,g.scale);t=o;var i=g.cache;if(i){if(g.drawing.type===rr.ShapeType.Polygon){var a=!1;if(i.positions.length>2){var u=i.positions[0],c=i.getStyle();a=v.isInCircle(o,c.dotRadius,u)}i.max&&i.positions.length+1>=i.max&&(i.positions.push(o),a=!0),a?((l=g.createShape(g.drawing.registerID,{positions:i.positions,closed:!1})).updatePositions(i.positions).close(),g.shapeList.push(l),g.cache=null,g.eventHook.trigger("create",l),g.continuity||g.cancel()):i.positions.push(o)}}else{var f=[];g.drawing.type===rr.ShapeType.Polygon?f=[o]:g.drawing.type===rr.ShapeType.Rect&&(f=[o,o,o,o]);var l=g.createShape(g.drawing.registerID,{positions:f,closed:!1,id:"cache"});g.cache=l}g.render()}}})),g.on("mousemove.top",(function(e){var n=g.cache,r=g.Image;if(g.drawing&&r.complate&&n&&g.drawing.type===rr.ShapeType.Rect){var o=e.ante.offset,i=r.toImagePoint(o,g.scale),a=v.getRectPoints(t,i);n.updatePositions(a),g.render()}})),g.on("mouseup.top",(function(){var e,n=g.cache,r=null===(e=g.drawing)||void 0===e?void 0:e.type;if(t=[0,0],r===rr.ShapeType.Rect&&n&&g.drawing){var o=n.getPositions(),i=g.createShape(g.drawing.registerID,{positions:o});i.close(),g.shapeList.push(i),g.eventHook.trigger("create",i),g.cache=null,g.continuity||g.cancel(),g.render()}})),g.on("mouseout.top",(function(){})),function(){var t=[0,0],e=[],n=-1;g.on("mousedown.top",(function(r){var o=r.ante,i=o.getTargetShape,a=o.offset;t=a;var u=i(),c=u[0],s=u[1];g.drawing||c&&(c.isDisabled()?g.activeShape=null:(r.ante.stopPropagation(),n=s,e=c.getPositions(),g.activeShape!==c&&function(t){g.loseActive(),t.setActive(!0),g.activeShape=t,g.eventHook.trigger("select",t),g.render()}(c)))})),g.on("mousemove.top",(function(r){if(c&&g.activeShape&&!g.drawing&&u){var o=r.offsetX,i=r.offsetY,a=[o-t[0],i-t[1]],s=[];if(-1===n)s=e.map((function(t){var e=t[0],n=t[1];return[e+a[0]/g.scale,n+a[1]/g.scale]})),g.cursor("drag");else{var f=(s=e.slice())[n];if("Rect"===g.activeShape.type){switch(n){case 1:s[0]=[s[0][0],s[0][1]+a[1]/g.scale],s[2]=[s[2][0]+a[0]/g.scale,s[2][1]];break;case 3:s[0]=[s[0][0]+a[0]/g.scale,s[0][1]],s[2]=[s[2][0],s[2][1]+a[1]/g.scale];break;default:s[n]=[f[0]+a[0]/g.scale,f[1]+a[1]/g.scale]}s=v.getRectPoints(s[0],s[2])}else s[n]=[f[0]+a[0]/g.scale,f[1]+a[1]/g.scale]}g.activeShape.updatePositions(s),g.render()}})),g.on("mouseup.top",(function(e){t=[0,0],n=-1}))}(),function(){var t=[0,0],e=g.Image;e.on("mousedown.bot",(function(n){if(!c&&e.complate){var r=n.ante.offset,o=r[0],i=r[1],a=e.getOrigin(),u=a[0],s=a[1];t=[o-u,i-s]}})),e.on("mousemove.bot",(function(n){if(s&&u&&!c&&!g.drawing){var r=n.ante.offset,o=r[0],i=r[1],a=[o-t[0],i-t[1]];e.setOrigin(a),g.render()}}));var n=function(){f(),t=[0,0]};e.on("mouseup.bot",n),e.on("mouseout.bot",n),e.on("wheel",(function(t){var e=g.Image;if(e.el){var n=t.ante.offset,r=n[0],o=n[1],i=t.deltaY<0?1:-1,a=Number((.05*i+g.scale).toFixed(2));a<.01&&(a=.01);var u=e.getSize(),c=u[0],s=u[1],f=e.getOrigin(),l=f[0],p=f[1],d=c*g.scale,v=c*a,h=Math.abs(r-l),y=(r-l>0?-1:1)*(h*v/d-h)+l,b=s*g.scale,_=s*a,m=Math.abs(o-p),w=(o-p>0?-1:1)*(m*_/b-m)+p;e.setOrigin([y,w]),g.scale=a,g.render()}}))}()}},g.load=function(t){return g.reset(),new Promise((function(e,n){g.Image.load(t).then((function(t){g.scale=v.getAdaptImgScale(t,i),g.render(),e(t)}),(function(t){n(t)}))}))},g.register=function(t,e){g.shapeRegister.add(t,e)},g.createShape=function(t,e){var n=g.shapeRegister.get(t);return new rr.Shape(Object.assign(n,e))},g.isRegister=function(t){return g.shapeRegister.is(t)},g.label=function(t,e){var n=g.shapeRegister.get(t);(g.drawing&&n&&t!==g.drawing.id||!g.drawing&&n)&&(g.drawing=n,g.eventHook.trigger("labelType")),r.default.isUndefined(e)||(g.continuity=!!e)},g.getDrawing=function(){return g.drawing},g.addShape=function(t,e){"number"==typeof e?g.shapeList.splice(e,0,t):g.shapeList.push(t),g.render()},g.remove=function(t){var e=g.findShapeIndex(t),n=e[0],r=e[1];if(null!==n){var o=r.tagNode();g.tagContainer.contains(o)&&g.tagContainer.removeChild(o),g.shapeList.splice(n,1),g.render(),g.eventHook.trigger("update")}},g.setActive=function(t){g.loseActive(),t.setActive(!0),g.render()},g.cancel=function(){g.drawing=null,g.continuity=!1,g.eventHook.trigger("labelType"),g.cache&&(g.cache=null,g.render())},g.orderShape=function(t,e){var n=g.findShapeIndex(t),r=n[0],o=n[1];null!==r&&(g.shapeList.splice(r,1),e?g.shapeList.unshift(o):g.shapeList.push(o))},g.findShapeIndex=function(t){var e=null;if(t instanceof rr.Shape){var n=t;e=g.shapeList.findIndex((function(t){return t===n}))}else if("string"==typeof t){var r=t;e=g.shapeList.findIndex((function(t){return t.id===r}))}return[e,null===e?null:g.shapeList[e]]},g.getShapeList=function(){return g.shapeList},g.getShapeByName=function(t){return g.shapeList.filter((function(e){return e.name===t}))},g.loseActive=function(){g.shapeList.forEach((function(t){t.setActive(!1)}))},g.setGuideLine=function(t){i.guideLine=r.default.isUndefined(t)?!i.guideLine:!!t,g.render()},g.isTagShow=function(){return i.tagShow},g.setTagShow=function(t){i.tagShow=r.default.isUndefined(t)?!g.isTagShow:!!t,g.render()},g.setContinuity=function(t){g.continuity=!!t},g.cursor=r.default.throttle((function(t){g.canvas.style.cursor=function(t){return n[t]}(t)}),100),g._clearCanvas=function(){var t=g.ctx,e=i.width,n=i.height;t.clearRect(0,0,e,n)},g._renderBackground=function(){var t=g.ctx,e=i.bgColor,n=i.width,r=i.height;t.fillStyle=e,t.fillRect(0,0,n,r)},g._renderImage=function(){var t=g.ctx,e=g.Image;if(e&&e.complate){var n=e.getEl(),r=e.getSize(),o=r[0],i=r[1],a=o*g.scale,u=i*g.scale,c=e.getOrigin(),s=c[0],f=c[1];t.drawImage(n,s,f,a,u)}},g._renderGuideLine=function(){var t=g.ctx,e=g.offset,n=e[0],r=e[1];t.beginPath(),t.strokeStyle="red",t.moveTo(0,r),t.lineTo(i.width,r),t.moveTo(n,0),t.lineTo(n,i.height),t.setLineDash([5]),t.stroke(),t.closePath(),t.setLineDash([0])},g._renderShape=function(t){var e=g.Image;if(t.isHidden()){var n=t.tagNode();g.tagContainer.contains(n)&&g.tagContainer.removeChild(n)}else{var r=g.ctx,o=g.scale,i=t.positions,a=t.getStyle(),u=a.dotColor,c=a.dotRadius,s=a.lineColor,f=a.lineWidth,l=a.fillColor,p=e.getShape2CanvasPoints(i,o),d=null;if(r.beginPath(),r.strokeStyle=s,r.lineWidth=f*o,p.forEach((function(e,n){var o=e[0],i=e[1];if(d&&(r.moveTo(d[0],d[1]),r.lineTo(o,i),p.length-1===n&&(t.isClose()||t.type===rr.ShapeType.Rect))){var a=p[0],u=a[0],c=a[1];r.lineTo(u,c)}d=[o,i]})),r.stroke(),r.closePath(),r.beginPath(),p.forEach((function(t,e){var n=t[0],o=t[1];0===e?r.moveTo(t[0],t[1]):r.lineTo(n,o)})),r.globalAlpha=.7,r.fillStyle=l,r.fill(),r.closePath(),r.globalAlpha=1,p.forEach((function(t){var e=t[0],n=t[1];r.beginPath(),r.fillStyle=u,r.arc(e,n,c*g.scale,0,2*Math.PI),r.fill(),r.closePath()})),g.isTagShow()&&t.isShowTag()){var v=p[0],h=v[0],y=v[1],b=g.scale;n=t.tagNode();er.css(n,{left:h+"px",top:y+"px",transform:"scale("+b+")"}),g.tagContainer.contains(n)||g.tagContainer.appendChild(n)}else{n=t.tagNode();g.tagContainer.contains(n)&&g.tagContainer.removeChild(n)}}},g._renderCache=function(){g.cache&&g._renderShape(g.cache)},g._renderShapeList=function(){var t=g.Image;if(t&&t.complate){var e=g.shapeList;if(e.length){var n=null;e.forEach((function(t){t.isActive()?n=t:g._renderShape(t)})),n&&g._renderShape(n)}}},g.forceRender=function(){g._clearCanvas(),g._renderBackground(),g._renderImage(),g._renderShapeList(),g._renderCache(),i.guideLine&&g._renderGuideLine()},g.render=r.default.throttle((function(){g.forceRender()}),17),g.container=e,er.css(g.container,{position:"relative",overflow:"hidden"}),i=Object.assign({},h,o),g.eventHook=new ir.EventHook;var y=er.create("canvas"),b=y.getContext("2d");y.width=i.width,y.height=i.height,g.container.append(y);var _=er.create("div");return g.tagContainer=_,g.container.appendChild(g.tagContainer),g.canvas=y,g.ctx=b,g.scale=1,g.continuity=!1,g.offset=[0,0],g.cache=null,g.activeShape=null,g.Image=new d.Image,g.shapeRegister=new or.ShapeRegister,g.drawing=null,g.shapeList=[],g.render(),g._init(),g}return p.__extends(e,t),e}(l.EventReceiver);e.Platform=h})),ur=p.__importStar(v);return function(t){function e(e,n){return t.call(this,e,n)||this}return p.__extends(e,t),e.Shape=rr.Shape,e.IDGenerator=nr.IDGenerator,e.utils=ur,e}(ar.Platform)}));
