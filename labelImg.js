/**!
 * label-img - v0.0.72
 * image annotation tool with javascript
 *
 * 2021-10-28 01:46:53
 * MIT (c) hold-baby
*/
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).LabelImg=t()}(this,(function(){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};var t=function(){return(t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};var n=Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]};function r(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function i(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,i,o=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(e){i={error:e}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function o(e){return this instanceof o?(this.v=e,this):new o(e)}var a=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};var u=Object.freeze({__proto__:null,__extends:function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)},get __assign(){return t},__rest:function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},__decorate:function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var u=e.length-1;u>=0;u--)(i=e[u])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},__param:function(e,t){return function(n,r){t(n,r,e)}},__metadata:function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},__awaiter:function(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{s(r.next(e))}catch(e){o(e)}}function u(e){try{s(r.throw(e))}catch(e){o(e)}}function s(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,u)}s((r=r.apply(e,t||[])).next())}))},__generator:function(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(o){return function(u){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=a.trys,(i=i.length>0&&i[i.length-1])||6!==o[0]&&2!==o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(e){o=[6,e],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,u])}}},__createBinding:n,__exportStar:function(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||n(t,e,r)},__values:r,__read:i,__spread:function(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(i(arguments[t]));return e},__spreadArrays:function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,u=o.length;a<u;a++,i++)r[i]=o[a];return r},__await:o,__asyncGenerator:function(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(e,t||[]),a=[];return r={},u("next"),u("throw"),u("return"),r[Symbol.asyncIterator]=function(){return this},r;function u(e){i[e]&&(r[e]=function(t){return new Promise((function(n,r){a.push([e,t,n,r])>1||s(e,t)}))})}function s(e,t){try{(n=i[e](t)).value instanceof o?Promise.resolve(n.value.v).then(c,f):l(a[0][2],n)}catch(e){l(a[0][3],e)}var n}function c(e){s("next",e)}function f(e){s("throw",e)}function l(e,t){e(t),a.shift(),a.length&&s(a[0][0],a[0][1])}},__asyncDelegator:function(e){var t,n;return t={},r("next"),r("throw",(function(e){throw e})),r("return"),t[Symbol.iterator]=function(){return this},t;function r(r,i){t[r]=e[r]?function(t){return(n=!n)?{value:o(e[r](t)),done:"return"===r}:i?i(t):t}:i}},__asyncValues:function(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,n=e[Symbol.asyncIterator];return n?n.call(e):(e=r(e),t={},i("next"),i("throw"),i("return"),t[Symbol.asyncIterator]=function(){return this},t);function i(n){t[n]=e[n]&&function(t){return new Promise((function(r,i){(function(e,t,n,r){Promise.resolve(r).then((function(t){e({value:t,done:n})}),t)})(r,i,(t=e[n](t)).done,t.value)}))}}},__makeTemplateObject:function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},__importStar:function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&n(t,e,r);return a(t,e),t},__importDefault:function(e){return e&&e.__esModule?e:{default:e}},__classPrivateFieldGet:function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet:function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n}}),s="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function c(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}function f(e){var t={exports:{}};return e(t,t.exports),t.exports}var l=Math.floor;var d=function(e,t){var n="";if(!e||t<1||t>9007199254740991)return n;do{t%2&&(n+=e),(t=l(t/2))&&(e+=e)}while(t);return n},p="object"==typeof s&&s&&s.Object===Object&&s,v="object"==typeof self&&self&&self.Object===Object&&self,h=p||v||Function("return this")(),g=h.Symbol;var y=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i},m=Array.isArray,_=Object.prototype,b=_.hasOwnProperty,w=_.toString,S=g?g.toStringTag:void 0;var O=function(e){var t=b.call(e,S),n=e[S];try{e[S]=void 0;var r=!0}catch(e){}var i=w.call(e);return r&&(t?e[S]=n:delete e[S]),i},j=Object.prototype.toString;var P=function(e){return j.call(e)},I=g?g.toStringTag:void 0;var x=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":I&&I in Object(e)?O(e):P(e)};var T=function(e){return null!=e&&"object"==typeof e};var C=function(e){return"symbol"==typeof e||T(e)&&"[object Symbol]"==x(e)},E=g?g.prototype:void 0,R=E?E.toString:void 0;var D=function e(t){if("string"==typeof t)return t;if(m(t))return y(t,e)+"";if(C(t))return R?R.call(t):"";var n=t+"";return"0"==n&&1/t==-Infinity?"-0":n};var M=function(e,t,n){var r=-1,i=e.length;t<0&&(t=-t>i?0:i+t),(n=n>i?i:n)<0&&(n+=i),i=t>n?0:n-t>>>0,t>>>=0;for(var o=Array(i);++r<i;)o[r]=e[r+t];return o};var A=function(e,t,n){var r=e.length;return n=void 0===n?r:n,!t&&n>=r?e:M(e,t,n)},L=RegExp("[\\u200d\\ud800-\\udfff\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff\\ufe0e\\ufe0f]");var k=function(e){return L.test(e)};var z=function(e){return function(t){return null==t?void 0:t[e]}}("length"),F="[\\ud800-\\udfff]",B="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",U="\\ud83c[\\udffb-\\udfff]",W="[^\\ud800-\\udfff]",G="(?:\\ud83c[\\udde6-\\uddff]){2}",N="[\\ud800-\\udbff][\\udc00-\\udfff]",K="(?:"+B+"|"+U+")"+"?",$="[\\ufe0e\\ufe0f]?",H=$+K+("(?:\\u200d(?:"+[W,G,N].join("|")+")"+$+K+")*"),q="(?:"+[W+B+"?",B,G,N,F].join("|")+")",Y=RegExp(U+"(?="+U+")|"+q+H,"g");var V=function(e){for(var t=Y.lastIndex=0;Y.test(e);)++t;return t};var X=function(e){return k(e)?V(e):z(e)};var Q=function(e){return e.split("")},J="[\\ud800-\\udfff]",Z="[\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff]",ee="\\ud83c[\\udffb-\\udfff]",te="[^\\ud800-\\udfff]",ne="(?:\\ud83c[\\udde6-\\uddff]){2}",re="[\\ud800-\\udbff][\\udc00-\\udfff]",ie="(?:"+Z+"|"+ee+")"+"?",oe="[\\ufe0e\\ufe0f]?",ae=oe+ie+("(?:\\u200d(?:"+[te,ne,re].join("|")+")"+oe+ie+")*"),ue="(?:"+[te+Z+"?",Z,ne,re,J].join("|")+")",se=RegExp(ee+"(?="+ee+")|"+ue+ae,"g");var ce=function(e){return e.match(se)||[]};var fe=function(e){return k(e)?ce(e):Q(e)},le=Math.ceil;var de=function(e,t){var n=(t=void 0===t?" ":D(t)).length;if(n<2)return n?d(t,e):t;var r=d(t,le(e/X(t)));return k(t)?A(fe(r),0,e).join(""):r.slice(0,e)},pe=/\s/;var ve=function(e){for(var t=e.length;t--&&pe.test(e.charAt(t)););return t},he=/^\s+/;var ge=function(e){return e?e.slice(0,ve(e)+1).replace(he,""):e};var ye=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},me=/^[-+]0x[0-9a-f]+$/i,_e=/^0b[01]+$/i,be=/^0o[0-7]+$/i,we=parseInt;var Se=function(e){if("number"==typeof e)return e;if(C(e))return NaN;if(ye(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=ye(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=ge(e);var n=_e.test(e);return n||be.test(e)?we(e.slice(2),n?2:8):me.test(e)?NaN:+e},Oe=1/0;var je=function(e){return e?(e=Se(e))===Oe||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0};var Pe=function(e){var t=je(e),n=t%1;return t==t?n?t-n:t:0};var Ie=function(e){return null==e?"":D(e)};var xe=function(e,t,n){e=Ie(e);var r=(t=Pe(t))?X(e):0;return t&&r<t?de(t-r,n)+e:e};var Te=function(){this.__data__=[],this.size=0};var Ce=function(e,t){return e===t||e!=e&&t!=t};var Ee=function(e,t){for(var n=e.length;n--;)if(Ce(e[n][0],t))return n;return-1},Re=Array.prototype.splice;var De=function(e){var t=this.__data__,n=Ee(t,e);return!(n<0)&&(n==t.length-1?t.pop():Re.call(t,n,1),--this.size,!0)};var Me=function(e){var t=this.__data__,n=Ee(t,e);return n<0?void 0:t[n][1]};var Ae=function(e){return Ee(this.__data__,e)>-1};var Le=function(e,t){var n=this.__data__,r=Ee(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};function ke(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}ke.prototype.clear=Te,ke.prototype.delete=De,ke.prototype.get=Me,ke.prototype.has=Ae,ke.prototype.set=Le;var ze=ke;var Fe=function(){this.__data__=new ze,this.size=0};var Be=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n};var Ue=function(e){return this.__data__.get(e)};var We=function(e){return this.__data__.has(e)};var Ge,Ne=function(e){if(!ye(e))return!1;var t=x(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t},Ke=h["__core-js_shared__"],$e=(Ge=/[^.]+$/.exec(Ke&&Ke.keys&&Ke.keys.IE_PROTO||""))?"Symbol(src)_1."+Ge:"";var He=function(e){return!!$e&&$e in e},qe=Function.prototype.toString;var Ye=function(e){if(null!=e){try{return qe.call(e)}catch(e){}try{return e+""}catch(e){}}return""},Ve=/^\[object .+?Constructor\]$/,Xe=Function.prototype,Qe=Object.prototype,Je=Xe.toString,Ze=Qe.hasOwnProperty,et=RegExp("^"+Je.call(Ze).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");var tt=function(e){return!(!ye(e)||He(e))&&(Ne(e)?et:Ve).test(Ye(e))};var nt=function(e,t){return null==e?void 0:e[t]};var rt=function(e,t){var n=nt(e,t);return tt(n)?n:void 0},it=rt(h,"Map"),ot=rt(Object,"create");var at=function(){this.__data__=ot?ot(null):{},this.size=0};var ut=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t},st=Object.prototype.hasOwnProperty;var ct=function(e){var t=this.__data__;if(ot){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return st.call(t,e)?t[e]:void 0},ft=Object.prototype.hasOwnProperty;var lt=function(e){var t=this.__data__;return ot?void 0!==t[e]:ft.call(t,e)};var dt=function(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=ot&&void 0===t?"__lodash_hash_undefined__":t,this};function pt(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}pt.prototype.clear=at,pt.prototype.delete=ut,pt.prototype.get=ct,pt.prototype.has=lt,pt.prototype.set=dt;var vt=pt;var ht=function(){this.size=0,this.__data__={hash:new vt,map:new(it||ze),string:new vt}};var gt=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e};var yt=function(e,t){var n=e.__data__;return gt(t)?n["string"==typeof t?"string":"hash"]:n.map};var mt=function(e){var t=yt(this,e).delete(e);return this.size-=t?1:0,t};var _t=function(e){return yt(this,e).get(e)};var bt=function(e){return yt(this,e).has(e)};var wt=function(e,t){var n=yt(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this};function St(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}St.prototype.clear=ht,St.prototype.delete=mt,St.prototype.get=_t,St.prototype.has=bt,St.prototype.set=wt;var Ot=St;var jt=function(e,t){var n=this.__data__;if(n instanceof ze){var r=n.__data__;if(!it||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new Ot(r)}return n.set(e,t),this.size=n.size,this};function Pt(e){var t=this.__data__=new ze(e);this.size=t.size}Pt.prototype.clear=Fe,Pt.prototype.delete=Be,Pt.prototype.get=Ue,Pt.prototype.has=We,Pt.prototype.set=jt;var It=Pt,xt=function(){try{var e=rt(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();var Tt=function(e,t,n){"__proto__"==t&&xt?xt(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n};var Ct=function(e,t,n){(void 0!==n&&!Ce(e[t],n)||void 0===n&&!(t in e))&&Tt(e,t,n)};var Et=function(e){return function(t,n,r){for(var i=-1,o=Object(t),a=r(t),u=a.length;u--;){var s=a[e?u:++i];if(!1===n(o[s],s,o))break}return t}}(),Rt=f((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?h.Buffer:void 0,o=i?i.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var n=e.length,r=o?o(n):new e.constructor(n);return e.copy(r),r}})),Dt=h.Uint8Array;var Mt=function(e){var t=new e.constructor(e.byteLength);return new Dt(t).set(new Dt(e)),t};var At=function(e,t){var n=t?Mt(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)};var Lt=function(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t},kt=Object.create,zt=function(){function e(){}return function(t){if(!ye(t))return{};if(kt)return kt(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();var Ft=function(e,t){return function(n){return e(t(n))}}(Object.getPrototypeOf,Object),Bt=Object.prototype;var Ut=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||Bt)};var Wt=function(e){return"function"!=typeof e.constructor||Ut(e)?{}:zt(Ft(e))};var Gt=function(e){return T(e)&&"[object Arguments]"==x(e)},Nt=Object.prototype,Kt=Nt.hasOwnProperty,$t=Nt.propertyIsEnumerable,Ht=Gt(function(){return arguments}())?Gt:function(e){return T(e)&&Kt.call(e,"callee")&&!$t.call(e,"callee")};var qt=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991};var Yt=function(e){return null!=e&&qt(e.length)&&!Ne(e)};var Vt=function(e){return T(e)&&Yt(e)};var Xt=function(){return!1},Qt=f((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n?h.Buffer:void 0,o=(i?i.isBuffer:void 0)||Xt;e.exports=o})),Jt=Function.prototype,Zt=Object.prototype,en=Jt.toString,tn=Zt.hasOwnProperty,nn=en.call(Object);var rn=function(e){if(!T(e)||"[object Object]"!=x(e))return!1;var t=Ft(e);if(null===t)return!0;var n=tn.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&en.call(n)==nn},on={};on["[object Float32Array]"]=on["[object Float64Array]"]=on["[object Int8Array]"]=on["[object Int16Array]"]=on["[object Int32Array]"]=on["[object Uint8Array]"]=on["[object Uint8ClampedArray]"]=on["[object Uint16Array]"]=on["[object Uint32Array]"]=!0,on["[object Arguments]"]=on["[object Array]"]=on["[object ArrayBuffer]"]=on["[object Boolean]"]=on["[object DataView]"]=on["[object Date]"]=on["[object Error]"]=on["[object Function]"]=on["[object Map]"]=on["[object Number]"]=on["[object Object]"]=on["[object RegExp]"]=on["[object Set]"]=on["[object String]"]=on["[object WeakMap]"]=!1;var an=function(e){return T(e)&&qt(e.length)&&!!on[x(e)]};var un=function(e){return function(t){return e(t)}},sn=f((function(e,t){var n=t&&!t.nodeType&&t,r=n&&e&&!e.nodeType&&e,i=r&&r.exports===n&&p.process,o=function(){try{var e=r&&r.require&&r.require("util").types;return e||i&&i.binding&&i.binding("util")}catch(e){}}();e.exports=o})),cn=sn&&sn.isTypedArray,fn=cn?un(cn):an;var ln=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]},dn=Object.prototype.hasOwnProperty;var pn=function(e,t,n){var r=e[t];dn.call(e,t)&&Ce(r,n)&&(void 0!==n||t in e)||Tt(e,t,n)};var vn=function(e,t,n,r){var i=!n;n||(n={});for(var o=-1,a=t.length;++o<a;){var u=t[o],s=r?r(n[u],e[u],u,n,e):void 0;void 0===s&&(s=e[u]),i?Tt(n,u,s):pn(n,u,s)}return n};var hn=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},gn=/^(?:0|[1-9]\d*)$/;var yn=function(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&gn.test(e))&&e>-1&&e%1==0&&e<t},mn=Object.prototype.hasOwnProperty;var _n=function(e,t){var n=m(e),r=!n&&Ht(e),i=!n&&!r&&Qt(e),o=!n&&!r&&!i&&fn(e),a=n||r||i||o,u=a?hn(e.length,String):[],s=u.length;for(var c in e)!t&&!mn.call(e,c)||a&&("length"==c||i&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||yn(c,s))||u.push(c);return u};var bn=function(e){var t=[];if(null!=e)for(var n in Object(e))t.push(n);return t},wn=Object.prototype.hasOwnProperty;var Sn=function(e){if(!ye(e))return bn(e);var t=Ut(e),n=[];for(var r in e)("constructor"!=r||!t&&wn.call(e,r))&&n.push(r);return n};var On=function(e){return Yt(e)?_n(e,!0):Sn(e)};var jn=function(e){return vn(e,On(e))};var Pn=function(e,t,n,r,i,o,a){var u=ln(e,n),s=ln(t,n),c=a.get(s);if(c)Ct(e,n,c);else{var f=o?o(u,s,n+"",e,t,a):void 0,l=void 0===f;if(l){var d=m(s),p=!d&&Qt(s),v=!d&&!p&&fn(s);f=s,d||p||v?m(u)?f=u:Vt(u)?f=Lt(u):p?(l=!1,f=Rt(s,!0)):v?(l=!1,f=At(s,!0)):f=[]:rn(s)||Ht(s)?(f=u,Ht(u)?f=jn(u):ye(u)&&!Ne(u)||(f=Wt(s))):l=!1}l&&(a.set(s,f),i(f,s,r,o,a),a.delete(s)),Ct(e,n,f)}};var In=function e(t,n,r,i,o){t!==n&&Et(n,(function(a,u){if(o||(o=new It),ye(a))Pn(t,n,u,r,e,i,o);else{var s=i?i(ln(t,u),a,u+"",t,n,o):void 0;void 0===s&&(s=a),Ct(t,u,s)}}),On)};var xn=function(e){return e};var Tn=function(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)},Cn=Math.max;var En=function(e,t,n){return t=Cn(void 0===t?e.length-1:t,0),function(){for(var r=arguments,i=-1,o=Cn(r.length-t,0),a=Array(o);++i<o;)a[i]=r[t+i];i=-1;for(var u=Array(t+1);++i<t;)u[i]=r[i];return u[t]=n(a),Tn(e,this,u)}};var Rn=function(e){return function(){return e}},Dn=xt?function(e,t){return xt(e,"toString",{configurable:!0,enumerable:!1,value:Rn(t),writable:!0})}:xn,Mn=Date.now;var An=function(e){var t=0,n=0;return function(){var r=Mn(),i=16-(r-n);if(n=r,i>0){if(++t>=800)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}(Dn);var Ln=function(e,t){return An(En(e,t,xn),e+"")};var kn=function(e,t,n){if(!ye(n))return!1;var r=typeof t;return!!("number"==r?Yt(n)&&yn(t,n.length):"string"==r&&t in n)&&Ce(n[t],e)};var zn=function(e){return Ln((function(t,n){var r=-1,i=n.length,o=i>1?n[i-1]:void 0,a=i>2?n[2]:void 0;for(o=e.length>3&&"function"==typeof o?(i--,o):void 0,a&&kn(n[0],n[1],a)&&(o=i<3?void 0:o,i=1),t=Object(t);++r<i;){var u=n[r];u&&e(t,u,r,o)}return t}))}((function(e,t,n){In(e,t,n)}));var Fn=function(e){return void 0===e};var Bn=function(e){return"string"==typeof e||!m(e)&&T(e)&&"[object String]"==x(e)},Un=function(){return h.Date.now()},Wn=Math.max,Gn=Math.min;var Nn=function(e,t,n){var r,i,o,a,u,s,c=0,f=!1,l=!1,d=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var n=r,o=i;return r=i=void 0,c=t,a=e.apply(o,n)}function v(e){return c=e,u=setTimeout(g,t),f?p(e):a}function h(e){var n=e-s;return void 0===s||n>=t||n<0||l&&e-c>=o}function g(){var e=Un();if(h(e))return y(e);u=setTimeout(g,function(e){var n=t-(e-s);return l?Gn(n,o-(e-c)):n}(e))}function y(e){return u=void 0,d&&r?p(e):(r=i=void 0,a)}function m(){var e=Un(),n=h(e);if(r=arguments,i=this,s=e,n){if(void 0===u)return v(s);if(l)return clearTimeout(u),u=setTimeout(g,t),p(s)}return void 0===u&&(u=setTimeout(g,t)),a}return t=Se(t)||0,ye(n)&&(f=!!n.leading,o=(l="maxWait"in n)?Wn(Se(n.maxWait)||0,t):o,d="trailing"in n?!!n.trailing:d),m.cancel=function(){void 0!==u&&clearTimeout(u),c=0,r=s=i=u=void 0},m.flush=function(){return void 0===u?a:y(Un())},m};var Kn=function(e,t,n){var r=!0,i=!0;if("function"!=typeof e)throw new TypeError("Expected a function");return ye(n)&&(r="leading"in n?!!n.leading:r,i="trailing"in n?!!n.trailing:i),Nn(e,t,{leading:r,maxWait:t,trailing:i})},$n=c(u),Hn=$n.__importDefault(xe),qn=$n.__importDefault(zn),Yn=$n.__importDefault(Fn),Vn=$n.__importDefault(Bn),Xn=$n.__importDefault(ye),Qn=$n.__importDefault(m),Jn=$n.__importDefault(Ne),Zn=$n.__importDefault(Kn),er=$n.__importDefault(Nn),tr={isUndefined:Yn.default,padStart:Hn.default,merge:qn.default,isString:Vn.default,isObject:Xn.default,isArray:Qn.default,isFunction:Jn.default,debounce:er.default,throttle:Zn.default},nr=Object.defineProperty({default:tr},"__esModule",{value:!0}),rr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventReceiver=t.antLvs=t.AntLv=t.antMouseEvents=t.EAntMouseEvents=void 0;var n,r,i=$n.__importDefault(nr);!function(e){e.mousedown="mousedown",e.mouseenter="mouseenter",e.mouseleave="mouseleave",e.mousemove="mousemove",e.mouseout="mouseout",e.mouseover="mouseover",e.mouseup="mouseup",e.dblclick="dblclick",e.click="click",e.auxclick="auxclick",e.contextmenu="contextmenu",e.wheel="wheel"}(n=t.EAntMouseEvents||(t.EAntMouseEvents={})),t.antMouseEvents=Object.keys(n),function(e){e.top="top",e.mid="mid",e.bot=" bot"}(r=t.AntLv||(t.AntLv={})),t.antLvs=Object.keys(r);var o=function(){function e(){var e=this;this.getEventsByType=function(t,n){var r=n||"mid";return e.getEventList(t+"."+r)};var t={};this.getEventList=function(e){return t[e]||[]},this.addEvent=function(e,n){t[e]?t[e].push(n):t[e]=[n]}}return e.prototype.on=function(e,t,n){var r=i.default.isFunction(t)?t:n,o=i.default.isFunction(t)?"mid":t,a=e+"."+o,u={lv:o,type:e,callback:r,target:this};this.addEvent(a,u)},e}();t.EventReceiver=o})),ir=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Image=t.ImagePlacement=void 0,function(e){e.default="default",e.center="center"}(t.ImagePlacement||(t.ImagePlacement={}));var n=[0,0],r=function(e){function t(t){var r=e.call(this)||this;return r.origin=t||n,r.complate=!1,r.el=null,r}return $n.__extends(t,e),t.prototype.load=function(e){var t=this;return this.origin=n,new Promise((function(n,r){t.complate=!1;var i=document.createElement("img");new Promise((function(t,n){var r=e;if(e instanceof File){var i=new FileReader;i.readAsDataURL(e),i.onload=function(e){var n;r=null===(n=e.target)||void 0===n?void 0:n.result,t(r)},i.onerror=function(){throw n(),"图片加载错误"}}else"string"==typeof e&&t(r)})).then((function(e){i.src=e,i.onload=function(){t.complate=!0,t.el=i,n(i)},i.onerror=function(){throw r(),"图片加载错误"}}))}))},t.prototype.loadFromImg=function(e){this.origin=n,this.complate=!0,this.el=e},t.prototype.getEl=function(){return this.el},t.prototype.getSize=function(e){if(this.el){var t=this.el;return[t.width*(e||1),t.height*(e||1)]}return n},t.prototype.getOrigin=function(){return this.origin.slice()},t.prototype.getCenter=function(e){if(void 0===e&&(e=1),this.el){var t=this.origin.slice(),r=t[0],i=t[1],o=this.el,a=[o.width*e/2,o.height*e/2];return[r+a[0],i+a[1]]}return n},t.prototype.getPosition=function(e){void 0===e&&(e=1);var t=this.getSize(),n=t[0]*e,r=t[1]*e,i=this.origin,o=i[0],a=i[1];return[this.origin,[o+n,a],[o+n,a+r],[o,a+r]]},t.prototype.toImagePoint=function(e,t){var n=e[0],r=e[1],i=this.origin;return[(n-i[0])/t,(r-i[1])/t]},t.prototype.getShape2CanvasPoints=function(e,t){var n=this;return e.map((function(e){return n.getShape2CanvasPoint(e,t)}))},t.prototype.getShape2CanvasPoint=function(e,t){var n=this.getOrigin(),r=n[0],i=n[1];return[r+e[0]*t,i+e[1]*t]},t.prototype.moveTo=function(e){this.origin=e},t}(rr.EventReceiver);t.Image=r})),or=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.hexToRgba=t.getAdaptImgScale=t.isInCircle=t.getDistance=t.getRectPoints=t.isInSide=void 0;t.isInSide=function(e,t){for(var n=e[0],r=e[1],i=!1,o=0,a=t.length-1;o<t.length;a=o++){var u=t[o][0],s=t[o][1],c=t[a][0],f=t[a][1];s>r!=f>r&&n<(c-u)*(r-s)/(f-s)+u&&(i=!i)}return i};t.getRectPoints=function(e,t){return[e,[t[0],e[1]],t,[e[0],t[1]]]};t.getDistance=function(e,t){var n=t[0]-e[0],r=t[1]-e[1],i=Math.pow(n,2),o=Math.pow(r,2);return Math.abs(Math.sqrt(i+o))};t.isInCircle=function(e,n,r){return t.getDistance(e,r)<n};t.getAdaptImgScale=function(e,t){var n=e.width,r=e.height,i=1;return(t.width<n||t.height<r)&&(i=n>r?t.width/n:t.height/r),i};t.hexToRgba=function(e,t){if(void 0===t&&(t=1),"#"===e.slice(0,1)){var n=e.slice(1).split("");if(3===n.length)n=n.map((function(e){return e+e}));else{if(6!==n.length)throw"请输入正确的16进制颜色";n=n.reduce((function(e,t,n){return n%2==0?e.unshift(t):e[0]=e[0]+t,e}),[]).reverse()}return"rgba("+n.map((function(e){return Number.parseInt(e,16)})).join(",")+", "+t+")"}return e}})),ar=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.IDG=t.IDGenerator=void 0;var n=$n.__importDefault(nr),r=function(){function e(e){var t=e||{},n=t.len,r=void 0===n?8:n,i=t.start,o=void 0===i?1:i;this.count=o,this.len=r}return e.prototype.getID=function(){var e=n.default.padStart(String(this.count),this.len,"0");return this.count++,e},e}();t.IDGenerator=r,t.IDG=new r})),ur=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.css=t.create=void 0;var n=$n.__importDefault(nr);t.create=function(e){return document.createElement(e)};t.css=function(e,t,r){if(n.default.isString(t)){if(!r)return e.style[t];!function(e,t,n){e.style[t]=n}(e,t,r)}else n.default.isObject(t)&&function(e,t){n.default.merge(e.style,t)}(e,t)}})),sr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Popover=void 0;var n=$n.__importDefault(nr),r={width:200,offset:5,padding:"0 4px",color:"#000",bgColor:"#fff",scale:1},i=function(){function e(e){var t=e.center,n=e.content,i=e.style;this.center=t||[0,0],this.content=n||"",this.style=Object.assign({},r,i);var o=ur.create("div"),a=ur.create("div");o.appendChild(a),this.container=o,this.body=a,this.parent=null}return e.prototype.move=function(e,t){this.center=e,this.style.scale=t,this.render()},e.prototype.css=function(e){Object.assign(this.style,e),this.render()},e.prototype.render=function(){var e=this.center,t=e[0],r=e[1],i=this.style,o=i.width,a=i.bgColor,u=i.offset,s=i.color,c=i.padding,f=i.scale;ur.css(this.container,{position:"absolute",display:"inline-block",width:o+"px",transformOrigin:"left",left:t+"px",top:r+"px",transform:"scale("+f+")"}),ur.css(this.body,{background:""+a,position:"absolute",bottom:u+"px",display:"inline-block",color:s,padding:c}),n.default.isString(this.content)?this.body.innerHTML=this.content:this.body.contains(this.content)||this.body.appendChild(this.content)},e.prototype.addTo=function(e){var t=e||this.parent;t&&!t.contains(this.container)&&(this.parent=t,t.appendChild(this.container))},e.prototype.remove=function(){this.parent&&this.parent.contains(this.container)&&this.parent.removeChild(this.container)},e}();t.Popover=i})),cr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Shape=t.disabled=t.active=t.normal=t.ShapeType=void 0;var n,r,i=$n.__importDefault(nr);!function(e){e.Polygon="Polygon",e.Rect="Rect"}(n=t.ShapeType||(t.ShapeType={})),function(e){e.normal="normal",e.active="active",e.disabled="disabled"}(r||(r={})),t.normal={dotColor:"red",dotRadius:2,lineColor:"#c30",lineWidth:2,fillColor:"pink"},t.active={dotColor:"red",dotRadius:2,lineColor:"transparent",lineWidth:0,fillColor:"#c30"},t.disabled={dotColor:"#666",dotRadius:0,lineColor:"transparent",lineWidth:0,fillColor:"#666"};var o={normal:t.normal,active:t.active,disabled:t.disabled},a=function(e){function t(t){var r=e.call(this)||this;r.hidden=function(){return r.visible=!1,r},r.addPoint=i.default.throttle((function(e){r.positions[r.positions.length-1].toString()!==e.toString()&&r.positions.push(e)}),100),r.rmDot=function(e){"Rect"!==r.type&&(r.positions.length<=3||r.positions.splice(e,1))};var a=t.id,u=void 0===a?ar.IDG.getID():a,s=t.type,c=t.registerID,f=t.name,l=t.positions,d=t.data,p=t.active,v=void 0!==p&&p,h=t.closed,g=void 0===h||h,y=t.disabled,m=void 0!==y&&y,_=t.insert,b=void 0!==_&&_,w=t.visible,S=void 0===w||w,O=t.showTag,j=void 0===O||O,P=t.max,I=t.tag,x=void 0===I?f:I,T=t.style,C=void 0===T?{}:T;return r.id=u,r.type=s,r.name=f,r.registerID=c,r.status=m?"disabled":v?"active":"normal",r.positions=l,r.data=d||null,r.style=i.default.merge({},o,C),r.closed=g,r.visible=S,r.insert=b,r.showTag=j,r.tagContent=x?x.toString():"",r.tagger=new sr.Popover({content:x,style:{color:"#fff",bgColor:r.getStyle().dotColor}}),r.max=P,r.type===n.Rect&&(r.insert=!1,2===l.length&&g&&(r.positions=or.getRectPoints(l[0],l[1]))),r}return $n.__extends(t,e),t.prototype.getPositions=function(){return this.positions||[]},t.prototype.isOnArc=function(e,t){void 0===t&&(t=1);var n=this.getPositions(),r=this.getStyle().dotRadius;return n.findIndex((function(n){return or.isInCircle(e,r*t,n)}))},t.prototype.isOnShape=function(e){return or.isInSide(e,this.getPositions())},t.prototype.isOnLine=function(e){var t=e[0],n=e[1],r=this.getPositions(),i=r[0];r.push(i);var o=null,a=[];r.forEach((function(e,t){var n={idx:t,position:e};o?(a.push([o,n]),o=n):o=n}));var u=a.filter((function(e){var r,i=e[0],o=e[1],a=i.position,u=a[0],s=a[1],c=o.position,f=c[0],l=c[1];return r=s===l?s-5<n&&n<s+5:s<l?s<n&&n<l:l<n&&n<s,(u===f?u-5<t&&t<u+5:u<f?u<t&&t<f:f<t&&t<u)&&r})).map((function(e){var r,i,o=e[0],a=e[1],u=o.position,s=u[0],c=u[1],f=a.position,l=f[0],d=f[1];if(d-c==0)r=t,i=c;else if(l-s==0)r=s,i=n;else{var p=(d-c)/(l-s),v=-p,h=n-v*t;i=v*(r=(h-(c-p*s))/(p-v))+h}return{idx:o.idx,position:[r,i]}})).map((function(t){var n=t.position;return{idx:t.idx,position:n,distance:or.getDistance(n,e)}})).sort((function(e,t){return e.distance-t.distance}))[0];return!!u&&(u.distance<5&&u)},t.prototype.getStyle=function(){return this.style[this.status]},t.prototype.setActive=function(e){return this.isDisabled()||(this.status=e?"active":"normal"),this},t.prototype.isActive=function(){return"active"===this.status},t.prototype.close=function(){return this.closed=!0,this},t.prototype.isClose=function(){return this.closed},t.prototype.disabled=function(){return this.status="disabled",this.tagger.css({bgColor:this.getStyle().dotColor}),this},t.prototype.isDisabled=function(){return"disabled"===this.status},t.prototype.normal=function(){return this.status="normal",this.tagger.css({bgColor:this.getStyle().dotColor}),this},t.prototype.show=function(){return this.visible=!0,this},t.prototype.isHidden=function(){return!this.visible},t.prototype.isInsert=function(){return this.insert},t.prototype.isEnable=function(){return!this.isDisabled()&&!this.isHidden()},t.prototype.isShowTag=function(){return this.showTag&&!!this.tagger.content&&this.isClose()},t.prototype.tagShow=function(e){this.showTag=i.default.isUndefined(e)?!this.showTag:!!e,this.tagger.css({bgColor:this.getStyle().dotColor})},t.prototype.setTag=function(e){this.tagger.content=e},t.prototype.updatePositions=function(e){return this.positions=e,this},t}(rr.EventReceiver);t.Shape=a})),fr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.ShapeRegister=void 0;var n=function(){var e={};this.add=function(t,n){e[t]||(n.registerID=t,e[t]=n)},this.get=function(t){if(e[t])return Object.assign({},e[t]);throw"图形未注册"},this.is=function(t){return!!e[t]},this.getMap=function(){return Object.assign({},e)}};t.ShapeRegister=n})),lr=f((function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.EventEmitter=void 0,function(e){e.on="on",e.once="once"}(n||(n={}));var r=function(){function e(){var e={};this.getEvents=function(t){return e[t]||[]},this.createEvent=function(t,n){e[t]||(e[t]=[]),e[t].push(n)}}return e.prototype.emit=function(e,t){var n=this.getEvents(e);n.length&&n.forEach((function(e,r){var i=e.fn,o=e.type;i(t),"once"===o&&n.splice(r,1)}))},e.prototype.on=function(e,t){var n=this;return this.createEvent(e,{fn:t,type:"on"}),function(){var r=n.getEvents(e),i=r.findIndex((function(e){return e.fn===t}));i&&r&&r.splice(i,1)}},e.prototype.once=function(e,t){this.createEvent(e,{fn:t,type:"once"})},e}();t.EventEmitter=r})),dr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Canvas=void 0;var n=function(){var e=this;this.setPoints=function(t){var n=e.ctx();t.forEach((function(e,t){var r=e[0],i=e[1];t?n.lineTo(r,i):n.moveTo(r,i)}))},this.line=function(t,n){if(t.length>1){var r=e.ctx(),i=null,o=n.lineColor,a=void 0===o?"":o,u=n.lineWidth,s=void 0===u?1:u,c=n.lineDash,f=void 0===c?[0]:c,l=r.getLineDash();r.beginPath(),r.strokeStyle=a,r.lineWidth=s,r.setLineDash(f),t.forEach((function(e){var t=e[0],n=e[1];i&&(r.moveTo(i[0],i[1]),r.lineTo(t,n)),i=[t,n]})),r.stroke(),r.setLineDash(l),r.closePath()}return e},this.fill=function(t,n){if(t.length>2){var r=e.ctx(),i=n.fillColor,o=void 0===i?"":i,a=n.opacity;r.beginPath();var u=e.el().style.opacity||1;e.setPoints(t),r.fillStyle=o,a&&e.opacity(a),r.fill(),r.closePath(),e.opacity(Number(u))}},this.fillReact=function(t,n,r){var i=e.ctx(),o=r.fillColor,a=void 0===o?"":o,u=r.opacity,s=void 0===u?1:u;i.beginPath();var c=e.el().style.opacity||1;return i.fillStyle=or.hexToRgba(a.toString(),s),s&&e.opacity(s),i.fillRect.apply(i,$n.__spreadArrays(t,n)),i.closePath(),e.opacity(Number(c)),e},this.polygon=function(t,n){return e.fill(t,n),e.line(t,n),e.dots(t,n),e},this.dot=function(t,n){var r=e.ctx(),i=n.dotColor,o=void 0===i?"":i,a=n.dotRadius,u=void 0===a?1:a;if(u<=0)return e;var s=t[0],c=t[1];return r.beginPath(),r.fillStyle=o,r.arc(s,c,u,0,2*Math.PI),r.fill(),r.closePath(),e},this.dots=function(t,n){var r=n.dotRadius;return(void 0===r?1:r)<=0||t.forEach((function(t){e.dot(t,n)})),e},this.text=function(t,n,r){var i=r||{},o=i.fontSize,a=void 0===o?16:o,u=i.color,s=i.bgColor,c=i.offset,f=void 0===c?[]:c,l=i.padding,d=void 0===l?[]:l,p=e.ctx(),v=n[0],h=n[1],g=d[0],y=void 0===g?4:g,m=d[1],_=void 0===m?0:m,b=f[0],w=void 0===b?0:b,S=f[1],O=void 0===S?5:S;p.font=a+"px";var j=p.measureText(t).width+2*y,P=a+2*_,I=[v+w,h-P-O],x=I[0],T=I[1];return p.beginPath(),p.rect(x,T,j,P),s&&(p.fillStyle=s),p.fill(),p.closePath(),p.beginPath(),u&&(p.fillStyle=u),p.textBaseline="middle",p.fillText(t,x+y,T+.5*P),p.closePath(),e},this.opacity=function(t){e.ctx().globalAlpha=t},this.size=function(t,n){var r=e.el();r.width=t,r.height=n},this.getSize=function(){var t=e.el(),n=t.width,r=void 0===n?0:n,i=t.height;return[r,void 0===i?0:i]},this.cursor=function(t){return e.el().style.cursor=t,e},this.clear=function(){var t=e.el(),n=t.width,r=t.height;return e.ctx().clearRect(0,0,n,r),e};var t=ur.create("canvas"),n=t.getContext("2d");t.tabIndex=-1,t.focus(),this.el=function(){return t},this.ctx=function(){return n}};t.Canvas=n})),pr=f((function(e,t){var n;Object.defineProperty(t,"__esModule",{value:!0}),t.displayCursor=void 0,function(e){e.draggable="grab",e.default="",e.label="copy",e.drag="grabbing",e.pointer="pointer",e.disabled="disabled"}(n||(n={}));t.displayCursor=function(e){return n[e]}})),vr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.FuncKeyCode=t.MoveKeyCode=void 0,t.MoveKeyCode={W:87,S:83,A:65,D:68},t.FuncKeyCode={Q:81,E:69,F:70,DELETE:8}})),hr=f((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Platform=void 0;var n=$n.__importDefault(nr),r={width:800,height:600,bgColor:"#000",tagShow:!0,guideLine:!1,shouldShapeStyleScale:!0,shouldTagScale:!1,imagePlacement:ir.ImagePlacement.default},i=function(e){function t(i,o){var a=e.call(this)||this;a.options=function(){return Object.assign({},a._options)},a.setOptions=function(e){a._options=n.default.merge(a._options,e),a.render()},a.reset=function(){a._scale=1,a.cache=null,a.activeShape=null,a.drawing=null,a.shapeList=[],a.tagContainer.innerHTML=""},a.resize=function(){if(a.Image&&a.Image.el){if(a._scale=or.getAdaptImgScale(a.Image.el,a.options()),a.options().imagePlacement===ir.ImagePlacement.center){var e=a.canvas.el(),t=e.width,n=e.height,r=a.Image.el,i=r.width,o=r.height;a.Image.moveTo([(t-i)/2,(n-o)/2])}else a.Image.moveTo([0,0]);a.render()}},a._init=function(){if(!a._isInit){a._isInit=!0;var e,t,n,r,i=a.canvas.el(),o=a.Image,u=null,s=null,c=function(){var e=a._isShapeMoving;a._isMouseDown=!1,a._isShapeMoving=!1,s=null,e&&a.render()};rr.antMouseEvents.forEach((function(e){i.addEventListener(e,(function(t){t.preventDefault();var n=[t.offsetX,t.offsetY],r=a._scale,u=or.isInSide(n,o.getPosition(r)),f=a.getTargetShape(n),l=f[0],d=f[1],p=a._isShapeMoving||!!l,v=a._isMouseDown||-1!==d;s=n;var h={offset:n,isOnImage:u,isOnShape:p,isOnArc:v,isPropagation:!0,stopPropagation:function(){h.isPropagation=!1},currentTarget:p?l:u?o:null,currentDotIndex:d};switch(e){case"mousedown":a._isMouseDown=!0;break;case"mouseup":case"mouseout":case"mouseleave":c();break;case"mouseenter":i.focus()}var g=function(e,t,n){for(var r=e.length,i=t.isPropagation,o=t.currentTarget;r;){if(!i){r=0;break}var a=e[r-1],u=a.callback,s=$n.__rest(a,["callback"]);n?o===l&&u(y,s):u(y,s),r--}},y=t;y.ante=h,rr.antLvs.forEach((function(t){p&&a.shapeList.forEach((function(n){g(n.getEventsByType(e,t),h,!0)})),u&&(y.ante.isPropagation=!0,g(o.getEventsByType(e,t),h)),o.complate&&(y.ante.isPropagation=!0,g(a.getEventsByType(e,t),h))}))}))})),a.on("mousemove",(function(e){var t=e.ante;if(s=t.offset,a.Image&&!a._isMouseDown){t.isOnShape;var n=t.isOnArc;a.drawing?a.cursor("label"):n?a.cursor("pointer"):a.cursor("default")}})),a.on("mousemove","top",(function(e){a.options().guideLine&&(a._guideLineOrigin=e.ante.offset,a.render())})),function(){var e="top",t=[0,0],n=a.Image;a.on("mousedown",e,(function(e){var r=e.ante,i=r.offset,o=r.isOnImage;if(a.drawing&&n.el&&o){var u=n.toImagePoint(i,a._scale);t=u;var s=a.cache;if(s){if(a.drawing.type===cr.ShapeType.Polygon){var c=!1;if(s.positions.length>2){var f=s.positions[0],l=s.getStyle();c=or.isInCircle(u,l.dotRadius,f)}if(s.max&&s.positions.length+1>=s.max&&(s.positions.push(u),c=!0),c)(p=a.createShape(a.drawing.registerID,{positions:s.positions,closed:!1})).updatePositions(s.positions).close(),a.shapeList.push(p),a.cache=null,a.emitter.emit("create",p),a.continuity||a.labelOff();else s.addPoint(u)}}else{var d=[];a.drawing.type===cr.ShapeType.Polygon?d=[u]:a.drawing.type===cr.ShapeType.Rect&&(d=[u,u,u,u]);var p=a.createShape(a.drawing.registerID,{positions:d,closed:!1,id:"cache"});a.cache=p}a.render()}})),a.on("mousemove",e,(function(e){var r=a.cache;if(a.drawing&&n.complate&&r){var i=e.ante.offset;if(a._isShapeMoving=!0,a.drawing.type===cr.ShapeType.Rect){var o=e.ante.offset,s=n.toImagePoint(o,a._scale),c=or.getRectPoints(t,s);r.updatePositions(c),a.render()}else if(u===vr.FuncKeyCode.E){var f=n.toImagePoint(i,a._scale),l=r.positions.length;r.addPoint(f),r.positions.length>l&&a.render()}}})),a.on("mouseup",e,(function(){var e,n=a.cache,r=null===(e=a.drawing)||void 0===e?void 0:e.type;if(t=[0,0],r===cr.ShapeType.Rect&&n&&a.drawing){var i=n.getPositions(),o=a.createShape(a.drawing.registerID,{positions:i});o.close(),a.shapeList.push(o),a.emitter.emit("create",o),a.cache=null,a.continuity||a.labelOff(),a.render()}})),a.on("mouseout",e,(function(){}))}(),e="top",t=[0,0],n=[],r=-1,a.on("mousedown",e,(function(e){var i=e.ante,o=i.offset,u=i.currentTarget,s=i.currentDotIndex,c=i.isOnShape;t=o,a.drawing||c&&u&&(u.isDisabled()?a.activeShape=null:(e.ante.stopPropagation(),r=s,n=u.getPositions(),a.activeShape!==u&&function(e){a.loseActive(),e.setActive(!0),a.activeShape=e,a.emitter.emit("select",e),a.render()}(u),a._isShapeMoving=!0))})),a.on("mousemove",e,(function(e){var i=e.offsetX,o=e.offsetY;if(e.ante.isOnShape&&a.activeShape&&!a.drawing&&a._isMouseDown){a._isShapeMoving=!0;var u=[i-t[0],o-t[1]],s=[];if(-1===r)s=n.map((function(e){var t=e[0],n=e[1];return[t+u[0]/a._scale,n+u[1]/a._scale]})),a.cursor("drag");else{var c=(s=n.slice())[r],f=a._scale;if("Rect"===a.activeShape.type){switch(r){case 1:s[0]=[s[0][0],s[0][1]+u[1]/f],s[2]=[s[2][0]+u[0]/f,s[2][1]];break;case 3:s[0]=[s[0][0]+u[0]/f,s[0][1]],s[2]=[s[2][0],s[2][1]+u[1]/f];break;default:s[r]=[c[0]+u[0]/f,c[1]+u[1]/f]}s=or.getRectPoints(s[0],s[2])}else s[r]=[c[0]+u[0]/f,c[1]+u[1]/f]}a.activeShape.updatePositions(s),a._isMouseDown&&a.render()}})),a.on("mouseup",e,(function(e){t=[0,0],r=-1})),function(){var e="bot",t=[0,0],n=a.Image;a.on("mousedown",e,(function(e){var r=e.ante,i=r.offset;if(!r.isOnShape&&n.complate){var o=i[0],a=i[1],u=n.getOrigin(),s=u[0],c=u[1];t=[o-s,a-c]}})),a.on("mousemove",e,(function(e){var r=e.ante,i=r.offset,o=r.isOnShape;if(a._isMouseDown&&!a._isShapeMoving&&!o&&!a.drawing){var u=i[0],s=i[1],c=[u-t[0],s-t[1]];n.moveTo(c),a._isMouseDown&&a.render()}}));var r=function(){c(),t=[0,0]};a.on("mouseup",e,r),a.on("mouseout",e,r)}(),a.Image.on("wheel",(function(e){if(a.Image.el){var t=e.ante.offset,n=e.deltaY<0?1:-1;a.scale(n,t)}})),i.addEventListener("keydown",(function(e){var t=e.keyCode;if(Object.values(vr.MoveKeyCode).some((function(e){return t===e}))){var n=o.getOrigin(),r=n[0],i=n[1];switch(t){case vr.MoveKeyCode.W:o.moveTo([r,i+10]);break;case vr.MoveKeyCode.S:o.moveTo([r,i-10]);break;case vr.MoveKeyCode.A:o.moveTo([r+10,i]);break;case vr.MoveKeyCode.D:o.moveTo([r-10,i])}a.render()}if(Object.values(vr.FuncKeyCode).some((function(e){return t===e})))switch(t){case vr.FuncKeyCode.F:if(!s)break;var c=a.getTargetShape(s),f=c[0],l=c[1];f&&-1!==l&&f.rmDot(l),a.render()}u=t})),i.addEventListener("keyup",(function(){u=null}))}},a.load=function(e){return a.reset(),new Promise((function(t,n){a.Image.load(e).then((function(e){a.resize(),a.render(),a.emitter.emit("imageReady"),t(e)}),(function(e){n(e)}))}))},a.loadFormImg=function(e){a.reset(),a.Image.loadFromImg(e),a.resize(),a.render(),a.emitter.emit("imageReady")},a.register=function(e,t){a.isRegister(e)||(a.shapeRegister.add(e,t),a.emitter.emit("shapeRegister"))},a.getRegisterMap=function(){return a.shapeRegister.getMap()},a.createShape=function(e,t){var n=a.shapeRegister.get(e);return new cr.Shape(Object.assign(n,t))},a.isRegister=function(e){return a.shapeRegister.is(e)},a.label=function(e,t){var r=a.shapeRegister.get(e);(a.drawing&&r&&e!==a.drawing.id||!a.drawing&&r)&&(a.drawing=r,a.emitter.emit("labelType")),n.default.isUndefined(t)||(a.continuity=!!t)},a.getDrawing=function(){return a.drawing},a.addShape=function(e,t){"number"==typeof t?a.shapeList.splice(t,0,e):(a.shapeList.push(e),a.emitter.emit("create"),a.emitter.emit("update")),a.render()},a.remove=function(e){var t=a.findShapeIndex(e),n=t[0],r=t[1];null!==n&&(null==r||r.tagger.remove(),a.shapeList.splice(n,1),a.render(),a.emitter.emit("delete"),a.emitter.emit("update"))},a.getTargetShape=function(e){var t=a.Image,n=a._scale,r=a.getShapeStyleScale()/n,i=null,o=-1,u=t.toImagePoint(e,n);a.activeShape&&a.activeShape.isEnable()&&(-1!==(o=(f=a.activeShape).isOnArc(u,r))&&(i=f),f.isOnShape(u)&&(i=f));if(!i)for(var s=a.shapeList.filter((function(e){return e.isEnable()})),c=s.length;c>0;){var f;if(-1!==(o=(f=s[c-1]).isOnArc(u,r))){i=f;break}if(f.isOnShape(u)){i=f;break}c--}return[i,o]},a.setActive=function(e){a.loseActive(),e.setActive(!0),a.render()},a.labelOff=function(){a.drawing=null,a.continuity=!1,a.emitter.emit("labelType"),a.cache&&(a.cache=null,a.render())},a.orderShape=function(e,t){var n=a.findShapeIndex(e),r=n[0],i=n[1];null!==r&&(a.shapeList.splice(r,1),t?a.shapeList.unshift(i):a.shapeList.push(i))},a.findShapeIndex=function(e){var t=null;if(e instanceof cr.Shape){var n=e;t=a.shapeList.findIndex((function(e){return e===n}))}else if("string"==typeof e){var r=e;t=a.shapeList.findIndex((function(e){return e.id===r}))}return[t,null===t?null:a.shapeList[t]]},a.getShapeList=function(){return a.shapeList},a.getShapeByName=function(e){return a.shapeList.filter((function(t){return t.name===e}))},a.loseActive=function(){a.shapeList.forEach((function(e){e.setActive(!1)}))},a.setGuideLine=function(e){a.setOptions({guideLine:n.default.isUndefined(e)?!a.options().guideLine:!!e}),a.render()},a.isTagShow=function(){return a.options().tagShow},a.setTagShow=function(e){a.setOptions({tagShow:n.default.isUndefined(e)?!a.isTagShow:!!e}),a.render()},a.setContinuity=function(e){a.continuity=!!e},a.cursor=n.default.throttle((function(e){a.canvas.cursor(pr.displayCursor(e))}),100),a.scale=function(e,t){if(n.default.isUndefined(e))return a._scale;var r=a.canvas.getSize(),i=r[0],o=r[1],u=a.Image.getSize(a._scale),s=u[0],c=u[1],f=0;if(-1!==e||(.25*i>=s&&f++,.25*o>=c&&f++,2!==f)){var l=Number((.05*e+a._scale).toFixed(2));a.scaleTo(l,t)}},a.scaleTo=function(e,t){var n=Number(e.toFixed(2)),r=a.Image,i=t||r.getCenter(a._scale),o=i[0],u=i[1],s=r.getSize(),c=s[0],f=s[1],l=r.getOrigin(),d=l[0],p=l[1],v=c*a._scale,h=c*n,g=Math.abs(o-d),y=(o-d>0?-1:1)*(g*h/v-g)+d,m=f*a._scale,_=f*n,b=Math.abs(u-p),w=(u-p>0?-1:1)*(b*_/m-b)+p;r.moveTo([y,w]),a._scale=n,a.render()},a.getShapeStyleScale=function(){return a._options.shouldShapeStyleScale?a._scale:Number((1+a._scale).toFixed(2))},a.moveTo=function(e){a.Image.moveTo(e)},a.toDataURL=function(){var e=a.Image;if(e&&e.complate&&e.el){var n=e.getSize(),r=n[0],i=n[1],o=a.shapeList.slice(),u=new t(document.createElement("div"),{width:r,height:i});u.isExport=!0;var s=a.getRegisterMap();return Object.keys(s).forEach((function(e){u.register(e,s[e])})),u.loadFormImg(e.el),u.scaleTo(1),o.forEach((function(e){e.setActive(!1),u.addShape(e)})),u.forceRender(),u.canvas.el().toDataURL()}},a._clearCanvas=function(){a.emitter.emit("beforeClear"),a.canvas.clear(),a.emitter.emit("afterClear")},a._renderBackground=function(){var e=a.options(),t=e.bgColor,n=e.width,r=e.height;a.emitter.emit("beforeRenderBackground"),a.canvas.fillReact([0,0],[n,r],{fillColor:t}),a.emitter.emit("afterRenderBackground")},a._renderImage=function(){var e=a.canvas.ctx(),t=a.Image;if(t&&t.complate){var n=t.getEl(),r=t.getSize(),i=r[0],o=r[1],u=i*a._scale,s=o*a._scale,c=t.getOrigin(),f=c[0],l=c[1];a.emitter.emit("beforeRenderImage"),e.drawImage(n,f,l,u,s),a.emitter.emit("afterRenderImage")}},a._renderGuideLine=function(){var e=a._guideLineOrigin,t=e[0],n=e[1],r=a.options(),i=[5],o=[[0,n],[r.width,n]];a.canvas.line(o,{lineColor:"red",lineWidth:1,lineDash:i});var u=[[t,0],[t,r.height]];a.canvas.line(u,{lineColor:"red",lineWidth:1,lineDash:i})},a._renderShape=function(e){var t=a.Image;if(e.isHidden())e.tagger.remove();else{var n=a._scale,r=e.positions,i=e.getStyle(),o=i.dotColor,u=i.dotRadius,s=i.lineColor,c=i.lineWidth,f=i.fillColor,l=t.getShape2CanvasPoints(r,n);(e.isClose()||e.type===cr.ShapeType.Rect)&&l.push(l[0]);var d={lineColor:s,lineWidth:c*n,dotRadius:u*a.getShapeStyleScale(),dotColor:o,fillColor:f,opacity:.7};e.isClose()?a.canvas.polygon(l,d):(a.canvas.fill(l,d),a.canvas.line(l,d),a.canvas.dot(l[0],d));var p=a.isTagShow()&&e.isShowTag()&&!a._isShapeMoving&&!a.drawing,v=e.tagger;if(p)if(a.isExport)a.canvas.text(e.tagContent,l[0],{bgColor:o,color:"#fff"});else{var h=a._scale;v.addTo(a.tagContainer),v.move(l[0],a._options.shouldTagScale?h:1)}else v.remove()}},a._renderCache=function(){a.cache&&(a.emitter.emit("beforeRenderDrawing"),a._renderShape(a.cache),a.emitter.emit("afterRenderDrawing"))},a._renderShapeList=function(){var e=a.Image;if(e&&e.complate){var t=a.shapeList;if(t.length){a.emitter.emit("beforeRenderShape");var n=null;t.forEach((function(e){e.isActive()?n=e:a._renderShape(e)})),n&&a._renderShape(n),a.emitter.emit("afterRenderShape")}}},a.forceRender=function(){a.emitter.emit("beforeRender"),a._clearCanvas(),a._renderBackground(),a._renderImage(),a._renderShapeList(),a._renderCache(),a.options().guideLine&&a._renderGuideLine(),a.emitter.emit("afterRender")},a.render=n.default.throttle((function(){a.forceRender()}),17),a.container=i,ur.css(a.container,{position:"relative",overflow:"hidden"}),a._options=Object.assign({},r,o),a.emitter=new lr.EventEmitter,a.canvas=new dr.Canvas;var u=a.options();a.canvas.size(u.width,u.height),a.container.append(a.canvas.el());var s=ur.create("div");return a.tagContainer=s,a.container.appendChild(a.tagContainer),a._scale=1,a.continuity=!1,a._guideLineOrigin=[0,0],a.cache=null,a.activeShape=null,a.Image=new ir.Image,a.shapeRegister=new fr.ShapeRegister,a.drawing=null,a.shapeList=[],a._isInit=!1,a._isMouseDown=!1,a._isShapeMoving=!1,a.isExport=!1,a.render(),a._init(),a}return $n.__extends(t,e),t}(rr.EventReceiver);t.Platform=i})),gr=$n.__importStar(or);return function(e){function t(t,n){return e.call(this,t,n)||this}return $n.__extends(t,e),t.Shape=cr.Shape,t.IDGenerator=ar.IDGenerator,t.utils=gr,t}(hr.Platform)}));
